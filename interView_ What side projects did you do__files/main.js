webpackJsonp([8],{100:function(e,t,n){"use strict";function r(e){return!/[!$%^&*()_+|~={}\[\]:";<>?,.\/]/g.test(e)&&e.trim().length>0}function i(e){return new RegExp(["[a-z0-9!#$%&'*+=?^_`{|}~-]+(?:.[a-z0-9!#$%&'*+=?^_`{|}~-]+)*","@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?"].join("")).test(e)}function o(e){setTimeout(e,0)}function s(e){var t,n=!1;return{get value(){return n?t:(t=e(),n=!0,t)}}}function a(e){}function c(e,t){return e||t}function u(e,t){return e+t}function l(e){return e.length>0}function d(e){return function(t){return t[e]}}function h(e){var t;return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t||(t=e.apply(void 0,n).then(function(e){return t=null,e}).catch(function(e){throw t=null,e}))}}function p(e){for(var t,n,r=[],i=0,o=e.length;i<o;)t=e.charCodeAt(i++),55296==(63488&t)&&i<o?(n=e.charCodeAt(i++),56320==(64512&n)?r.push(((1023&t)<<10)+(1023&n)+65536):r.push(t,n)):r.push(t);return r}function f(e){return new(window.WebSocket||window.MozWebSocket)(e)}function g(e,t){var n=window;n.ddebug=n.ddebug||{},n.ddebug[e]=t}function m(e,t,n){return _.Option.map2(e,t,n).getOrElse(e.equals(t))}Object.defineProperty(t,"__esModule",{value:!0});var _=n(18);t.nameValidation=r,t.emailValidation=i,t.tick=o,t.lazy=s,t.noop=a,t.or=c,t.sum=u,t.notEmpty=l,t.pick=d,t.delay=function(e){return new Promise(function(t){return setTimeout(t,e)})},t.throttleByPromise=h,t.decode=p,t.getWebSocket=f,t.registerDebugHelper=g,t.isOptionsEq=m},119:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(206);t.BaseComponent=r.BaseComponent,t.withContext=r.withContext,t.BaseComponentContext=r.BaseComponentContext;var i=n(296);t.BasePage=i.BasePage;var o=n(1372);t.Link=o.Link;var s=n(149);t.Router=s.Router;var a=n(303);t.DocumentLoaderContextImpl=a.DocumentLoaderContextImpl},120:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(97);t.DoxErrors=r.DoxErrors;var i=n(548);t.DoxDocument=i.DoxDocument;var o=n(550);t.DoxRequest=o.DoxRequest;var s=n(293);t.DoxRemoteDocument=s.DoxRemoteDocument;var a=n(294);t.DoxDocumentSettings=a.DoxDocumentSettings;var c=n(1364);t.DoxClient=c.DoxClient},121:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=n(152),o=n(299),s=n(5),a=n(305),c=n(305);t.FeaturesModel=c.FeaturesModel,t.DenaliFeatures=c.DenaliFeatures,t.CardFeatures=c.CardFeatures,t.Feature=c.Feature,t.FeatureAtom=c.FeatureAtom,t.NavigationBarFeatures=c.NavigationBarFeatures,t.ToolbarFeatures=c.ToolbarFeatures,t.DenaliPageVMFeatures=c.DenaliPageVMFeatures;var u=n(551);t.UserProfile=u.UserProfile,t.UserInstitution=u.UserInstitution,t.UserAccount=u.UserAccount,t.UserAccountOperationsModel=u.UserAccountOperationsModel,t.UserType=u.UserType;var l=s.BrowserInfo.getBrowserInfo().browser;t.UserGroups={EXTENSION_INSTALLED:"extension-"+l,DESKTOP_EDITOR_INSTALLED:"desktop_editor_used",FREEBIE_USER:"freebie",PREMIUM_CONVERSION:"premium-conversion"};var d=function(){function e(e,t,n,s,c,u,l,d,h,p,f){this._state=e,this._authApi=t,this._irbisApi=n,this._dapi=s,this._subscribeUrl=c,this._upgradeBaseUrl=u,this._browserType=l,this._browser=d,this._telemetry=h,this._router=p,this._appConfig=f,this._log=r.Monitoring.Logging.getLogger("model.account"),this.profile=this._state.view("userProfile"),this.subscription=new o.SubscriptionModelImpl(this._state.lens("subscription"),this._irbisApi,this._subscribeUrl,this._upgradeBaseUrl,this._browserType,this._telemetry,this._appConfig,this.profile.get().id),this.settings=new i.SettingsModelImpl(this._state.lens("settings"),this._state.lens("customFields"),this._dapi,this._state.lens("userProfile").lens("id")),this.features=new a.FeaturesModel(this._state.view("experiments"),this.subscription.state,this.profile,this.settings,this._state.view("institution"),this._browser,this._router,this._appConfig)}return e.prototype.areValidCredentials=function(e,t){var n=this;return this._authApi.login(e,t).then(function(e){return e&&!e.err}).catch(function(e){if(401===e.code)return n._log.warn("authError: areValidCredentials",e),!1;throw n._log.error("authError: areValidCredentials",e),e})},e.prototype.changeName=function(e){var t=this;return this._authApi.changeName(e).then(function(){return t._state.lens("userProfile").lens("fullName").set(e)}).catch(this._log.handler("authError: changeName").error)},e.prototype.changeEmail=function(e,t){var n=this;return this._authApi.changeEmail(e,t).then(function(){return n._state.lens("userProfile").lens("newEmail").set(e)}).catch(this._log.handler("authError: changeEmail").warn)},e.prototype.changePassword=function(e,t,n){return this._authApi.changePassword(e,t,n).catch(this._log.handler("authError: changePassword").warn)},e.prototype.deleteAccount=function(){return this._irbisApi.deleteAccount().catch(this._log.handler("irbisError: deleteAccount failed").warn)},e}();t.UserAccountModelImpl=d},1351:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(23);!function(e){e.empty={hovered:void 0,disabled:void 0,active:void 0},e.withName=function(e,t){return r.__assign({},e,{name:t})},e.emptyWithName=function(t){return e.withName(e.empty,t)},e.GroupedContextTypes={name:i.string},e.HoveredContextTypes={hovered:i.object},e.DisabledContextTypes={disabled:i.object},e.ActiveContextTypes={active:i.object},e.contextTypes=Object.assign({},e.GroupedContextTypes,e.HoveredContextTypes,e.DisabledContextTypes,e.ActiveContextTypes)}(t.ElementState||(t.ElementState={}))},1352:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(8),o=n(14),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._el=null,t}return r.__extends(t,e),t.prototype.unsubscribe=function(){this.subscription&&this.subscription.unsubscribe(),this.props.onUnmount&&this.props.onUnmount()},t.prototype.componentDidMount=function(){this.props.onMount&&(this.subscription=this.props.onMount(this._el))},t.prototype.componentDidUpdate=function(){this.props.remountOnUpdate&&this.props.onMount&&(this.unsubscribe(),this.subscription=this.props.onMount(this._el))},t.prototype.componentWillUnmount=function(){this.unsubscribe()},t.prototype.render=function(){var e=this,t=this.props,n=t.children,r=t.className;return n&&n.length>1||r?o.createElement(i.F.div,{mount:function(t){return e._el=t},className:r},n):o.Children.only(this.props.children)},t}(o.Component);t.Lifecycle=s},1353:function(e,t,n){"use strict";function r(e){switch(e){case"webeditor":return n(542).textResources;case"desktopeditor":return n(1355).textResources;default:return o.assertNever(e)}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(1354);t.TextResources=i.TextResources;var o=n(5);t.getTextResources=r},1354:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(23);!function(e){e.ContextTypes={textResources:r.object}}(t.TextResources||(t.TextResources={}))},1355:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(203),i=n(542);t.textResources=r.merge(i.textResources,{base:{tooltipDownloadProofreadVersion:"Export proofread version",tooltipDownloadOriginalVersion:"Export original version",tooltipDownload:"Export document",uploadText:"Import",tooltipUploadElementInput:"Click here to import document",menuDownloadText:"Export",documentPlaceholderText:"Import a document to save original formatting.",modalUploadingDocumentText:"Importing document",notificationUploadFileText:"Import a file in one of the following formats"},denali:{uploadMenuItem:"Import document",uploadDropZone:"Drop a text file here to import",downloadMenuItem:"Export",uploadNotificationTitle:"The document imported successfully",placeholder:{upload:"Import a document to save original formatting."}}})},1356:function(e,t,n){"use strict";function r(e){if(e.enableTracking){var t=new h.CookieStorage(e.domains.cookie),n=[new h.LocalStorage,new h.MemoryStorage];return{gnarClient:o(e,g.RxFetch.request("gnar"),t,n),gaClient:new h.GoogleAnalyticsClient(e.gaTrackingId,new h.GAClientIdManager(t,n,d.Monitoring.Logging.root.getLogger("gnar.gaClientIdManager"),d.Monitoring.TimeSeries.root.getMetric("gnar.gaClientIdManager")))}}return{gnarClient:new h.LocalStorageGnarClient,gaClient:{ga:v.noop,setUserId:v.noop}}}function i(e,t){var n=c.Atom.create(f.defaultState);d.Monitoring.Logging.root.debug("Constructing model for "+e.env+" on the client");var i=r(e),o=i.gnarClient,a=i.gaClient,h=o.getContainerId();return h.then(function(e){return d.Monitoring.Logging.root.context.add({containerId:e})}).catch(function(e){return d.Monitoring.Logging.root.debug("cant get containerId",e)}),new f.AppModelImpl(n,new u.Auth(e.api.authUrl,g.RxFetch.request(u.Auth.targetTag),m.getClientType(),_.buildInfo.version,h),new u.Institution(e.api.institutionUrl,g.RxFetch.request(u.Institution.targetTag)),new u.Dapi(e.api.dapiUrl,g.RxFetch.request(u.Dapi.targetTag)),m.getBrowserInfo(),new u.Dictionary(e.api.capiApiUrl,g.RxFetch.request(u.Dictionary.targetTag)),new u.Irbis(e.api.irbisUrl,e.api.subscriptionUrl,g.RxFetch.request(u.Irbis.targetTag)),new l.DoxClient(e.api.doxUrl,g.RxFetch.request(l.DoxClient.targetTag)),new p.EditorTelemetry(o,e.app.name),new y.GnarSpec(s(o)),a,e,t)}function o(e,t,n,r){var i=e.api.gnarApi.url,o=new h.ContainerIdManager(n,r,d.Monitoring.Logging.root.getLogger("gnar.containerIdManager"),d.Monitoring.TimeSeries.root.getMetric("gnar.containerIdManager"));return new h.GnarClientImpl(i,e.app.name,_.buildInfo.version,t,o,d.Monitoring.Logging.root.getLogger("gnar"),d.Monitoring.TimeSeries.root.getMetric("gnar"))}function s(e){var t=d.Monitoring.Logging.root.getLogger("gnar.events");return a.__assign({},e,{track:function(n){var r=n.eventName,i=a.__rest(n,["eventName"]);return t.info(r,i),e.track(n)}})}Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),c=n(8),u=n(53),l=n(120),d=n(6),h=n(570),p=n(202),f=n(565),g=n(99),m=n(38),_=n(80),y=n(1401),v=n(5);t.defaultModel=i},1357:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1358:function(e,t,n){"use strict";function r(e,t){return i(i({},e),t)}function i(e,t){for(var n in t){var r=e[n]||{},o=t[n];null!=o&&null!=r&&o.constructor===Object&&r.constructor===Object?e[n]=i(r,o):e[n]=o}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.merge=r},1359:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(6),o=n(18),s=n(43),a=n(544),c=n(310),u={kind:"finish",revision:-1,score:o.None,dialect:"undefined"},l=function(){function e(e){var t=this;this._log=i.Monitoring.Logging.getLogger("coreclients.capi_test",i.Logging.LogLevel.TRACE),this._waitersList=new Map,this._closed=!1,this._idToRev=new Map,this._finishedRevs=new Map,this._onAccept=function(e){if(t._log.debug("accepted message",e),c.ChangesQueue.isChange(e)){var n=t._finishedRevs.get(e.rev);void 0!==n?t._successRevision(e.id,n):e.change.isEmpty?t._successRevision(e.id,u):t._idToRev.set(e.rev,e.id)}},this._onDrop=function(e,n){return e.forEach(function(e){return t._failRevision(e,n)})},this._onFinish=function(e){var n=t._idToRev.get(e.revision);void 0!==n?t._successRevision(n,e):t._finishedRevs.set(e.revision,e)},this._storeId=function(e){var n=t._waitersList.get(e);if(void 0!==n)return n.future();var r=o.FutureMaker.empty();return t._waitersList.set(e,r),r.future()},this._successRevision=function(e,n){var r=t._waitersList.get(e);s.invariant(void 0!==r,"onsuccess waiter should be defined for every queued message"),r.success(n),t._waitersList.delete(e),t._idToRev.delete(n.revision),t._finishedRevs.delete(n.revision)},this._failRevision=function(e,n){if(t._log.debug("dropped message",e),c.ChangesQueue.isChange(e)){var r=t._waitersList.get(e.id);s.invariant(void 0!==r,"onfail waiter should be defined for every queued message"),r.failure(new Error("message dropped because of "+(n||"unknown reason"))),t._waitersList.delete(e.id),t._idToRev.delete(e.rev)}};var n=function(n){t._closed||(t._onAccept(n.message),e.handler&&e.handler.onQueueMsgAccepted&&e.handler.onQueueMsgAccepted(n))},l=function(n){t._closed||(t._onDrop(n.messages,n.reason),e.handler&&e.handler.onQueueMsgDropped&&e.handler.onQueueMsgDropped(n))},d=function(n){t._closed||(t._onFinish(n),e.handler&&e.handler.onFinish&&e.handler.onFinish(n))},h={onQueueMsgAccepted:n,onQueueMsgDropped:l,onFinish:d};this.client=new a.CAPIClientImpl(r.__assign({},e,{handler:Object.assign({},e.handler,h)}))}return e.prototype.setText=function(e){this._clear();var t=this.client.setText(e);return this._storeId(t)},e.prototype.pushChanges=function(e){var t=this.client.pushChanges(e);return this._storeId(t)},e.prototype.close=function(){return this._clear(),this._closed=!0,this.client.close()},e.prototype.closeConnection=function(e,t){void 0===e&&(e=1001),s.invariant(!!this.client._conn,"DoxRemoteDocument should have _conn private field OR please, use propper field name for connection"),this.client._conn._ws.close(e,t)},e.prototype._clear=function(){this._waitersList.clear(),this._idToRev.clear(),this._finishedRevs.clear()},e}();t.TestCAPIClientImpl=l},1360:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1361:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(60),i=function(){function e(e,t){this._url=e,this._fetch=t,this._ajax=r.Ajax.factory(this._fetch,"omit")}return e.prototype.checkOrigin=function(){return this._ajax(r.RequestBuilder.get(this._url,"/origin").build()).then(function(e){return{isOkay:"origin okay"===e.message,url:e.origin}})},e.targetTag="diagnostics",e}();t.Diagnostics=i},1362:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(60),i=function(){function e(e,t,n){this._url=e,this._fetch=t,this._token=n,this._ajax=r.Ajax.factory(this._fetch)}return e.prototype._attachCookie=function(e){return this._token&&e.cookie("grauth",this._token),e.build()},e.prototype.get=function(){return this._ajax(this._attachCookie(r.RequestBuilder.get(this._url,"/dict")))},e.prototype.delete=function(e){return this._ajax(this._attachCookie(r.RequestBuilder.del(this._url,"/dict").pathParam(e)),r.Ajax.toVoid)},e.prototype.add=function(e){return this._ajax(this._attachCookie(r.RequestBuilder.post(this._url,"/dict").json({word:e})),r.Ajax.toVoid)},e.targetTag="capi",e}();t.Dictionary=i},1363:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(151),i=function(){function e(){}return e.diffAsChanges=function(e,t){var n=(new r.Delta).insert(e),i=(new r.Delta).insert(t);return r.Change.delta(n.diff(i),e.length)},e}();t.Diff=i},1364:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(60),i=n(97),o=n(550),s=n(1366),a=n(293),c=n(548),u=function(){function e(e,t,n){this._url=e,this._fetch=t,this._token=n,this._clientType="web",this._ajax=r.Ajax.factory(this._fetch,"include",i.DoxErrors.doxErrorMapper),this._wsBaseUrl=this._getWsBaseUrl(e)}return e.prototype._getWsBaseUrl=function(e){var t=new RegExp("http(s?)://([^/]+)/?.*$"),n=t.exec(e);if(null===n)throw new Error("Cannot parse ws url");return"ws"+n[1]+"://"+n[2]},e.prototype._getWsUrl=function(e){var t=null===e||void 0===e?"/documents/ws":"/documents/"+e+"/ws";return""+this._wsBaseUrl+t},Object.defineProperty(e.prototype,"clientType",{set:function(e){this._clientType=e},enumerable:!0,configurable:!0}),e.prototype.listDocuments=function(t,n,r){return void 0===t&&(t=e.unlimited),void 0===n&&(n=e.OrderBy.Any),void 0===r&&(r=!1),this.searchDocument(o.DoxRequest.Search.all(),t,n,r)},e.prototype.openDocumentsWS=function(e){return s.RemoteDocumentsList.create(this._getWsUrl(),e)},e.prototype.openDocumentById=function(e,t,n,r){return void 0===r&&(r=500),a.DoxRemoteDocument.create(this._getWsUrl(e),t,n,r)},e.prototype.searchDocument=function(t,n,i,o){void 0===n&&(n=e.unlimited),void 0===i&&(i=e.OrderBy.Any),void 0===o&&(o=!1);var s=r.RequestBuilder.get(this._url,"/documents").queryParam("search",t.toSearchString()).queryParam("limit",String(n)).queryParam("firstCall",String(o));return this._ajax(this._prepareRequest(s).build()).then(function(e){return e.map(function(e){return new c.DoxDocument(e)})})},e.prototype.createDocument=function(e){var t=e._getHttpRequestBuilder().url(this._url,"/documents").method("post");return this._ajax(this._prepareRequest(t).build()).then(function(e){return new c.DoxDocument(e)})},e.prototype.downloadOriginal=function(e,t){void 0===t&&(t=!0);var n=r.RequestBuilder.join(this._url,"/documents",encodeURIComponent(e),"download")+(t?"":"?no_tracking"),i=this._prepareRequest(r.RequestBuilder.get(n));return this._ajax(i.build(),r.Ajax.parseBlobResponse)},e.prototype.url=function(){return this._url},e.prototype.downloadProofread=function(e){var t=r.RequestBuilder.join(this._url,"/documents",encodeURIComponent(e),"proofread"),n=this._prepareRequest(r.RequestBuilder.get(t));return this._ajax(n.build(),r.Ajax.parseBlobResponse)},e.prototype.deleteDocumentById=function(e){var t=r.RequestBuilder.del(this._url,"/documents").pathParam(e);return this._ajax(this._prepareRequest(t).build(),r.Ajax.toVoid)},e.prototype.restoreDocumentById=function(e){var t=r.RequestBuilder.post(this._url,"/documents",encodeURIComponent(e),"restore");return this._ajax(this._prepareRequest(t).build(),r.Ajax.toVoid)},e.prototype.generateOldReport=function(e){var t=new FormData;return t.append("source_file",e),this._ajax(this._prepareRequest(r.RequestBuilder.post(r.RequestBuilder.join(this._url,"docproc/html2pdf")).body(t)).build(),r.Ajax.parseBlobResponse)},e.prototype.generateReport=function(e,t,n){var i=n.headerTemplate,o=n.footerTemplate,s=n.format,a=n.width,c=n.height,u=n.marginTop,l=n.marginRight,d=n.marginBottom,h=n.marginLeft,p=r.RequestBuilder.join(this._url,"/documents",encodeURIComponent(e),"report"),f=this._prepareRequest(r.RequestBuilder.post(p).json({html:t,header_template:i,footer_template:o,format:s,width:a,height:c,margin_top:u,margin_right:l,margin_bottom:d,margin_left:h}));return this._ajax(f.build(),r.Ajax.parseBlobResponse)},e.prototype._prepareRequest=function(e){return this._authorize(e).header("X-API-Version","1").header("X-Client-Type",this._clientType)},e.prototype._authorize=function(e){return this._token?e.cookie("grauth",this._token):e},e.targetTag="dox",e.unlimited=0,e}();t.DoxClient=u,function(e){!function(e){e[e.Updated=0]="Updated",e[e.Created=1]="Created",e[e.Any=2]="Any"}(e.OrderBy||(e.OrderBy={}))}(u=t.DoxClient||(t.DoxClient={})),t.DoxClient=u},1365:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);!function(e){var t=function(){function e(e){this.id=e}return e}();e.Base=t;var n=function(e){function t(t,n,r,i,o,s){var a=e.call(this,t)||this;return a.id=t,a.cl=n,a.rev=r,a.doc_len=i,a.deltas=o,a.revAfterApply=s,a.op="patch",a}return r.__extends(t,e),t}(t);e.PatchMessage=n;var i=function(e){function t(t,n){var r=e.call(this,t)||this;return r.id=t,r.vsn=n,r.op="vsn",r}return r.__extends(t,e),t}(t);e.VersionMessage=i;var o=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;return o.id=t,o.title=n,o.errors=r,o.extra_params=i,o.op="update_document_metadata",o}return r.__extends(t,e),t}(t);e.UpdateDocumentMetadata=o;var s=function(e){function t(t){var n=e.call(this,t)||this;return n.id=t,n.op="proofit_turnaround_options",n}return r.__extends(t,e),t}(t);e.ProofitOptionsMessage=s;var a=function(e){function t(t,n){var r=e.call(this,t)||this;return r.id=t,r.turnaround=n,r.op="proofit_create_job",r}return r.__extends(t,e),t}(t);e.ProofitPlaceOrderMessage=a}(t.Message||(t.Message={}))},1366:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(5),o=n(97),s=n(293),a=n(549),c=function(e){function t(n,r,s,c){var u=e.call(this,n)||this;return u._failHandler=s,u._handler=new t.DefaultHandler(c),u._disconnectHandler=u._handler.disconnectHandler,u._fsm.on(a.States.CLOSED,function(e){var t=e.args?e.args:o.DoxErrors.CLOSED_ERROR;u._failHandler&&u._failHandler(t)}),u._fsm.event(a.Events.CONNECT).then(function(){return r(u)}).catch(s),i.registerDebugHelper("closeDoxListSocket",function(e,t){void 0===e&&(e=1e3),u._conn._ws.close(e,t)}),u}return r.__extends(t,e),t.create=function(e,n){return new Promise(function(r,i){return new t(e,r,i,n)})},t.prototype._handleMessage=function(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(this._log.trace("<<< ",{message:e}),e.op){case"document_metadata_changed":this._handleMetaChangeMessage(e);break;case"mongodb_change":break;default:t=e,this._log.warn("Never",{message:t})}return[2]})})},t.prototype._handleMetaChangeMessage=function(e){var t=s.DoxRemoteDocument.Meta.parse(e);this._handler.metadataChangeHandler(String(e.id),t)},t}(a.Remote);t.RemoteDocumentsList=c,function(e){var t=function(){function t(t){this._handler=t,this.metadataChangeHandler=this._handler.metadataChangeHandler||i.noop,this.disconnectHandler=this._handler.disconnectHandler||e._defaultReconnect}return t}();e.DefaultHandler=t}(c=t.RemoteDocumentsList||(t.RemoteDocumentsList={})),t.RemoteDocumentsList=c},1367:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(877);!function(e){function t(e){r.saveAs(e.data,e.title)}e.saveToFS=t}(t.RawFile||(t.RawFile={}))},1368:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=n(249),o=n(175),s=n(60),a=function(){function e(e,t,n){this._url=e,this._fetch=t,this._token=n,this._ajax=s.Ajax.factory(this._fetch),this._log=r.Monitoring.Logging.getLogger("coreclients.institution")}return e.prototype._setToken=function(e){this._token=e},e.prototype.getInfo=function(){var e=s.RequestBuilder.get(this._url,"api/institution");return this._token&&e.cookie("grauth",this._token),this._ajax(e.build()).then(this._parseInstitutionInfo)},e.prototype._parseInstitutionInfo=function(t){var n=this;return void 0===t?(this._log.warn("failed to parse institution info: empty payload"),e.emptyInfo):o.validate(t,e.InfoType).mapLeft(i.failure).fold(function(t){return n._log.warn("failed to parse institution info: incorrect payload",t),e.emptyInfo},function(e){return e})},e.targetTag="institution",e.InfoType=o.interface({id:o.number,name:o.string,plagiarismDisabled:o.boolean,scoreDisabled:o.boolean,licenseDiscountinued:o.boolean,quickReplacement:o.boolean,fullCards:o.boolean,proofit:o.boolean,domainValidation:o.boolean,admin:o.boolean}),e.emptyInfo={id:-1,name:"",plagiarismDisabled:!1,scoreDisabled:!1,licenseDiscountinued:!1,quickReplacement:!1,fullCards:!1,proofit:!1,domainValidation:!1,admin:!1},e}();t.Institution=a},1369:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(60),o=n(43),s=function(){function e(e,t,n,r){this._url=e,this._subscriptionUrl=t,this._fetch=n,this._token=r,this._ajax=i.Ajax.factory(this._fetch)}return e.prototype.deleteAccount=function(){var e=i.RequestBuilder.del(this._url,"/api/user");return this._token&&e.cookie("grauth",this._token),this._ajax(e.build(),i.Ajax.toVoid)},e.prototype.getStatus=function(){var e=i.RequestBuilder.get(this._subscriptionUrl);return this._token&&e.cookie("grauth",this._token),this._ajax(e.build())},e.prototype.cancelSubscription=function(){var e=i.RequestBuilder.post(this._subscriptionUrl,"/cancel");return this._token&&e.cookie("grauth",this._token),this._ajax(e.build(),i.Ajax.toVoid)},e.prototype.renewSubscription=function(){var e=i.RequestBuilder.post(this._subscriptionUrl,"/renew");return this._token&&e.cookie("grauth",this._token),this._ajax(e.build(),i.Ajax.toVoid)},e.prototype.ackPremiumConversion=function(){var e=i.RequestBuilder.post(this._subscriptionUrl,"/ack-premium-conversion");return this._token&&e.cookie("grauth",this._token),this._ajax(e.build(),i.Ajax.toVoid)},e.prototype.generateTokenCreditCard=function(){var e=i.RequestBuilder.post(this._subscriptionUrl,"/token/card");return this._token&&e.cookie("grauth",this._token),this._ajax(e.build(),i.Ajax.parseJSON)},e.prototype.getTokenRequest=function(e){var t=this;return o.retryWithDelay(function(){return r.__awaiter(t,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return[4,this._tokenRequest(e)];case 1:if(!(t=r.sent()))throw new o.RetryError("empty response");if(n=JSON.parse(t),!n.token)throw new o.RetryError("empty token");return[2,n.token]}})})})},e.prototype.getPaypalRedirectPageRequest=function(e){var t=this;return o.retryWithDelay(function(){return r.__awaiter(t,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return[4,this._tokenRequest(e)];case 1:if(!(t=r.sent()))throw new o.RetryError("empty response");if(n=JSON.parse(t),!n.paypalRedirectPage)throw new o.RetryError("empty paypalRedirectPage");return[2,n.paypalRedirectPage]}})})})},e.prototype._tokenRequest=function(e){var t=i.RequestBuilder.get(this._subscriptionUrl,"/token/request").pathParam(e);return this._token&&t.cookie("grauth",this._token),this._ajax(t.build(),i.Ajax.parseText)},e.prototype.getAvailablePlans=function(){var e=i.RequestBuilder.get(this._subscriptionUrl,"/pricing");return this._token&&e.cookie("grauth",this._token),this._ajax(e.build())},e.prototype.changePlan=function(e){var t=i.RequestBuilder.post(this._subscriptionUrl,"/set-plan").pathParam(e);return this._token&&t.cookie("grauth",this._token),this._ajax(t.build(),i.Ajax.toVoid)},e.prototype.subscribeCard=function(e,t){var n=i.RequestBuilder.post(this._subscriptionUrl,"/subscribe-card").formParam("nonce",e);return t&&n.formParam("billingZip",t),this._token&&n.cookie("grauth",this._token),this._ajax(n.build(),i.Ajax.toVoid)},e.prototype.subscribeCardSandbox=function(e){void 0===e&&(e="1");var t=i.RequestBuilder.post(this._subscriptionUrl,"/subscribe-card").formParam("planId",e).formParam("nonce","fake-valid-nonce").formParam("sessionId","test-session").formParam("billingZip","12345");return this._token&&t.cookie("grauth",this._token),this._ajax(t.build(),i.Ajax.toVoid)},e.prototype.updateCreditCard=function(e,t){var n=i.RequestBuilder.post(this._subscriptionUrl,"/update-card").formParam("nonce",e);return t&&n.formParam("billingZip",t),this._token&&n.cookie("grauth",this._token),this._ajax(n.build(),i.Ajax.toVoid)},e.prototype.subscribePaypal=function(e){var t=i.RequestBuilder.post(this._subscriptionUrl,"/token/paypal").formParam("nonce",e);return this._token&&t.cookie("grauth",this._token),this._ajax(t.build(),i.Ajax.toVoid)},e.prototype.generateTokenPaypal=function(e){var t=e.cancelUrl,n=e.returnUrl,r=i.RequestBuilder.post(this._subscriptionUrl,"/token/paypal").formParam("cancelUrl",t).formParam("returnUrl",n);return this._token&&r.cookie("grauth",this._token),this._ajax(r.build(),i.Ajax.parseJSON)},e.prototype.updatePaypal=function(e){var t=i.RequestBuilder.post(this._subscriptionUrl,"/update-paypal").formParam("payPalToken",e);return this._token&&t.cookie("grauth",this._token),this._ajax(t.build(),i.Ajax.toVoid)},e.prototype.downloadBillingReceipts=function(){var e=i.RequestBuilder.get(this._subscriptionUrl,"/receipt");return this._token&&e.cookie("grauth",this._token),this._ajax(e.build(),i.Ajax.parseBlobResponse)},e.targetTag="irbis",e}();t.Irbis=s},1370:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(14),o=n(38),s=n(206),a=n(99),c=n(119),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.getChildContext=function(){var e=this.props.model,t=e.telemetry,n=e.gnarSpec,r=e.platformInfo,i=e.notifications,u=e.tooltip;return{appRouter:this.props.router,appConfig:this.props.config,textResources:a.getTextResources(o.isDesktopEditor(r.browser)?"desktopeditor":"webeditor"),telemetry:t,gnarSpec:n,pageId:"home",notifications:i,tooltip:u,screen:new s.ScreenContextImpl,documentLoader:new c.DocumentLoaderContextImpl}},t.prototype.render=function(){return i.Children.only(this.props.children)},t.childContextTypes=s.baseComponentContextTypes,t}(i.Component);t.ContextAppender=u},1371:function(e,t,n){"use strict";function r(e,t){var n=a.Monitoring.Logging.getLogger("config.parser");return t.flatMap(function(e){return i.Try.of(function(){return JSON.parse(e)}).recover(n.handler("Parse error of the provided JSON config",{config:e}).info).toOption()}).fold(function(){return e},function(t){return o.validate(t,l).mapLeft(s.failure).mapLeft(function(e){return n.info("Validation error of the provided JSON config",{config:t,error:e})}).toOption().fold(function(){return e},function(t){return n.info("Load app with custom config",t),c.merge(e,t)})})}Object.defineProperty(t,"__esModule",{value:!0});var i=n(18),o=n(175),s=n(249),a=n(6),c=n(1358),u={_A:o._A,name:"httpString",validate:function(e,t){return"string"==typeof e&&e.match(/^(https?|wss):\/\/(\w|\d|-|\/|\.|\?|\=|\_)*(:(\d)*)?$/)?o.success(e):o.failure(e,t)}},l=o.partial({api:o.partial({authUrl:u,capiApiUrl:u,capiWsUrl:u,crashLogUrl:u,dapiUrl:u,doxUrl:u,felogUrl:u,gnarApi:o.partial({url:u}),institutionUrl:u,irbisUrl:u,onlineTestUrl:u,pdfGeneratorUrl:u,proofitResultUrl:u,wsTest:u}),desktop:o.partial({mac:o.partial({infoURL:u,installURL:u}),windows:o.partial({infoURL:u,installURL:u})}),edu:o.partial({adminPanelURL:u}),extension:o.partial({chrome:o.partial({infoURL:u,installURL:u}),firefox:o.partial({iconURL:u,infoURL:u,installURL:u}),safari:o.partial({installURL:u})}),funnel:o.partial({accountDeleted:u,mainPage:u,resetPassword:u,signin:u,signup:u,subscribe:u,upgrade:u}),officeAddIn:o.partial({infoURL:u,installURL:u}),support:o.partial({connectionTroubleshooting:u,contact:u,diagnosticTestPath:u,documentAcceptTrackedChanges:u,email:u,emailExistsKBUrl:u,login:u,mainPage:u,newRequest:u,phoenixSupportUrl:u,phoenixWritingHelpUrl:u})});t.createConfig=r},1372:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(14),o=n(23),s=n(8),a=n(149),c=function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)},u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e){if(t.props.onClick&&t.props.onClick(e),!e.defaultPrevented&&0===e.button&&!t.props.target&&!c(e)){e.preventDefault();var n=t.props.destination;t.context.appRouter.navigate(n)}},t}return r.__extends(t,e),t.prototype.componentWillMount=function(){if(!(this.context.appRouter instanceof a.Router.Impl||this.context.appRouter instanceof a.Router.DummyImpl))throw new TypeError("No router or invalid router supplied to Link.\n        It should be the editor-router and should come from the context.")},t.prototype.render=function(){var e=this.props,t=e.destination,n=e.className,o=e.activeClassName,a=e.children,c=r.__rest(e,["destination","className","activeClassName","children"]),u=this.context.router.history.createHref(t),l=this.context.appRouter.isActive(t);return i.createElement(s.F.a,r.__assign({},r.__assign({href:u},s.classes(n,l.view(function(e){return e&&o})),c),{onClick:this.handleClick}),a)},t.contextTypes=Object.assign({router:o.shape({history:o.shape({push:o.func.isRequired,replace:o.func.isRequired,createHref:o.func.isRequired}).isRequired}).isRequired},a.Router.ContextTypes),t}(i.Component);t.Link=u},1373:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(14),o=n(8),s=n(80),a=n(1356),c=n(301),u=n(312),l=n(149),d=n(1374),h=n(1370),p=n(38),f=n(1371),g=n(296),m=n(5),_=n(377),y=new l.Router.Impl,v=f.createConfig(s.appConfig,y.query.get("config")),b=a.defaultModel(v,y),w=d.routesMap(b),E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._getContent=function(e){return function(t){return m.Async.isOk(t)?e():m.Async.isError(t)||m.Async.isFatal(t)?i.createElement(u.Error500Page,null):i.createElement(g.BasePage.PageWrapper,null,i.createElement(c.Spinner,{className:_.spinner}))}},t}return r.__extends(t,e),t.prototype.render=function(){var e=this;return i.createElement(l.Router.Wrapper,{routesMap:w,renderer:function(t,n){var s=t.match;return n.private&&(b.authentication.ensureAuthenticated(),b.authentication.status.filter(m.Async.isOk).first().subscribe(function(){b.apis.dox.clientType=b.userAccount.features.denali.enabled?"denali_editor":"web"})),i.createElement(h.ContextAppender,r.__assign({},{model:b,router:y,config:v}),n.private?i.createElement(o.F.div,r.__assign({},o.classes(p.isDesktopEditor(b.platformInfo.browser)&&_.desktopEditorPreventSelection)),b.authentication.status.view(e._getContent(function(){return d.globalExperiment(b,y).getOrElseL(function(){return n.component(s.params)})}))):n.component(s.params))}})},t}(i.Component);t.Main=E},1374:function(e,t,n){"use strict";function r(e,t){var n=b.RxUtils.promiseToStream(e).switchMap(function(e){return e.fold(function(){return l.Observable.of(c.createElement(_.Spinner,{className:w.spinner})).delay(50)},function(e){return l.Observable.of(e.fold(function(e){return h.Monitoring.Logging.getLogger("routes.loader").fatal("Fail on component load",e),c.createElement(f.Error500Page,null)},t))})});return c.createElement(v.BasePage.PageWrapper,null,n)}function i(e){return{documents:m.Router.bindComponent(m.Router.routes.documents,function(){return r(function(){return new Promise(function(e){return n.e(0).then(function(t){return e(n(1435))}.bind(null,n)).catch(n.oe)})},function(t){return c.createElement(t.DocumentsPage,{model:e})})}),profile:m.Router.bindComponent(m.Router.routes.profile,function(){return r(function(){return new Promise(function(e){return n.e(0).then(function(t){return e(n(1437))}.bind(null,n)).catch(n.oe)})},function(t){return c.createElement(t.ProfilePage,{model:e})})}),subscription:m.Router.bindComponent(m.Router.routes.subscription,function(){return r(function(){return new Promise(function(e){return n.e(0).then(function(t){return e(n(1438))}.bind(null,n)).catch(n.oe)})},function(t){return e.userAccount.features.isFree?c.createElement(C,{destination:m.Router.routes.free.href({})}):c.createElement(t.SubscriptionPage,{model:e})})}),apps:m.Router.bindComponent(m.Router.routes.apps,function(){return r(function(){return new Promise(function(e){return n.e(0).then(function(t){return e(n(1433))}.bind(null,n)).catch(n.oe)})},function(t){return c.createElement(t.AppsPage,{model:e})})}),new_document:m.Router.bindComponent(m.Router.routes.new_document,function(){return c.createElement(d.F.div,null,b.RxUtils.promiseToStream(function(){return e.documentsPage.actions.createDocument()}).map(function(e){return e.fold(function(){return c.createElement(_.Spinner,{className:w.spinner})},function(e){return e.map(function(e){return e.id.toString()}).fold(function(e){return h.Monitoring.Logging.getLogger("routes").fatal("Fail create new document",e),c.createElement(f.Error500Page,null)},function(e){return c.createElement(C,{destination:m.Router.routes.editor.href({docId:e})})})})}))}),editor:m.Router.bindComponent(m.Router.routes.editor,function(t){var i=t.docId;return e.userAccount.features.denali.enabled?c.createElement(C,{destination:m.Router.routes.denali_editor.href({docId:i})}):(e.apis.dox.clientType="web",r(function(){return n.e(3).then(n.bind(null,1439))},function(t){return c.createElement(t.EditorPage,{model:e,docId:i})}))}),denali_editor:m.Router.bindComponent(m.Router.routes.denali_editor,function(t){var i=t.docId;return e.userAccount.features.denali.enabled?(e.apis.dox.clientType="denali_editor",r(function(){return n.e(2).then(n.bind(null,1432))},function(t){return c.createElement(t.DenaliEditorPage,{wsConnectivity:e.wsConnectivity,networkState:e.networkState,notifications:e.denaliNotifications,doxApi:e.apis.dox,docId:i,userAccount:e.userAccount,logout:function(){return e.authentication.logout()},browser:e.platformInfo.browser})})):c.createElement(C,{destination:m.Router.routes.editor.href({docId:i})})}),free:m.Router.bindComponent(m.Router.routes.free,function(){return e.userAccount.features.isFree?r(function(){return n.e(6).then(n.bind(null,1436))},function(t){return c.createElement(t.FreePage,{authentication:e.authentication,userAccount:e.userAccount})}):c.createElement(C,{destination:m.Router.routes.documents.href({})})}),componentBrowser:m.Router.bindComponent(m.Router.routes.component_browser,function(e){var t=e.component;return r(function(){return n.e(1).then(n.bind(null,1440))},function(e){return c.createElement(e.ComponentBrowserPage,{component:t})})}),card_iframe:m.Router.bindComponent(m.Router.routes.card_iframe,function(){return r(function(){return n.e(4).then(n.bind(null,1434))},function(e){return c.createElement(e.CardIframePage,null)})}),diagnostic_test:m.Router.bindComponent(m.Router.routes.diagnostic_test,function(){return r(function(){return n.e(5).then(n.bind(null,1441))},function(e){return c.createElement(e.DiagnosticPage,null)})}),notFound:m.Router.bindComponent(m.Router.routes.notFound,function(){return c.createElement(g.Error404Page,{requestedData:"page"})})}}function o(e,t){var n=t.title,r=t.text,i=p.promiseToStream(function(){return e.documentsPage.actions.createDocument(r,n)});return u.Option.some(c.createElement(d.F.div,null,i.map(function(e){return e.fold(function(){return c.createElement(_.Spinner,{className:w.spinner})},function(e){return e.map(function(e){return e.id.toString()}).fold(function(e){return h.Monitoring.Logging.getLogger("global_experiment").fatal("Fail when redirecting to readability prototype doc",e),c.createElement(C,{destination:m.Router.routes.documents.href({})})},function(e){return c.createElement(C,{destination:m.Router.routes.denali_editor.href({docId:e})})})})})))}function s(e,t){return e.userAccount.features.isReadabilityPrototypeDemoUser&&!t.isActive(m.Router.routes.denali_editor.href({docId:"*"})).get()?o(e,E.readabilityDemoText):u.Option.none()}Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),c=n(14),u=n(18),l=n(22),d=n(8),h=n(6),p=n(306),f=n(312),g=n(1398),m=n(149),_=n(301),y=n(206),v=n(296),b=n(5),w=n(377),E=n(1412),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.componentDidMount=function(){var e=this.context.appRouter;e.navigate(this.props.destination,e.locationState.getOrElse(void 0),!0)},t.prototype.render=function(){return null},t}(y.BaseComponent);t.routesMap=i,t.testReadabilityPrototypeDemo=o,t.globalExperiment=s},1375:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(288),o=n(8),s=n(22),a=n(53),c=n(6),u=n(5),l=n(38),d=n(121),h=n(299),p=n(152),f=n(18);t.defaultState=u.Async.defaultValue();var g=function(e){function t(){return e.call(this,{code:403,status:"error",message:"User is anonymous"})||this}return r.__extends(t,e),t}(a.HTTPError);t.AnonymousUserError=g;var m=function(e){function t(){return e.call(this,{code:0,status:"error",message:"User cannot use editor"})||this}return r.__extends(t,e),t}(a.HTTPError);t.CannotUseEditorError=m;var _=function(e){function t(t){return e.call(this,{code:t,status:"error",message:"Connection failed"})||this}return r.__extends(t,e),t}(a.HTTPError);t.ConnectionError=_;var y=function(){function e(e,t,n,r,i,o,s,l,d,h,p){var f=this;this._state=e,this._authApi=t,this._institutionApi=n,this._dapi=r,this._onAuthenticated=i,this._appConfig=o,this._telemetry=s,this._navigateToFreePage=l,this._modal=d,this._overlay=h,this._browser=p,this._log=c.Monitoring.Logging.getLogger("model.authentication"),this.status=this._state.view(function(e){return u.Async.map(e,function(e){return e})}),this._disableProofitField="disableProofit",this._handleAuthError=function(e){e instanceof m?f._gotoFreePage():!e||401!==e.code&&403!==e.code?(f._log.fatal("authError: Failed to get user session","string"==typeof e?e:c.EventProps.fromAny(e)),f._state.modify(function(t){return u.Async.isOk(t)?u.Async.error(e||new Error("authError: Failed to get user session, error is undefined"))(t):t})):(f._log.warn("authError: Bad user session",e),f._gotoLogin())},this._retryWhen=function(e){return!(e instanceof a.HTTPError)||u.isServerErrorCode(e.code)}}return e.prototype.ensureAuthenticated=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n=this;return r.__generator(this,function(r){switch(r.label){case 0:if(!u.Async.isIdle(this._state.get()))return[2];r.label=1;case 1:return r.trys.push([1,3,,4]),this._state.modify(u.Async.begin),[4,this._getUserSession()];case 2:if(e=r.sent(),setTimeout(function(){n._onAuthenticated(e),n._state.modify(u.Async.success(e))},0),!e.userProfile.canUseEditor)throw new m;return[3,4];case 3:return t=r.sent(),this._handleAuthError(t),t instanceof m||this._state.modify(u.Async.error(t)),[3,4];case 4:return[2]}})})},e.prototype._parseUserProfileJSON=function(e,t,n,r){var i=new Set(e.groups.filter(Boolean)),o="Free"===e.type?d.UserType.free:"Premium"===e.type?d.UserType.premium:function(){throw new Error("Unknown user type "+e.type)}(),s=this._parseCustomFields(e.customFields);return{userProfile:{id:e.id,email:e.email,newEmail:e.newEmail,fullName:e.name,isFreebie:i.has(d.UserGroups.FREEBIE_USER),isTest:e.isTest||!1,canUseEditor:"Premium"===e.type||e.freemium||!1,groups:i,type:o,loginType:e.loginType,registrationDate:e.registrationDate?f.Some(new Date(e.registrationDate)):f.None},subscription:h.defaultState,institution:r,settings:t,experiments:n,customFields:s}},e.prototype._parseLaterBanners=function(e){return e.map(function(e){if("object"==typeof e)return e;var t=e.split(":"),n=t[0],r=t[1];return{type:n,expire:parseInt(r,10)}})},e.prototype._parseCustomFields=function(e){return{disableProofit:Boolean(e[this._disableProofitField])}},e.prototype._parseUserSettings=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(h=a.Properties).find.apply(h,["banners"].concat(e)).getObject()||{},r=n.shown,i=void 0===r?[]:r,o=n.showen,s=void 0===o?[]:o,c=n.dismiss,u=void 0===c?[]:c,l=n.later,d=void 0===l?[]:l;return{firstCall:(p=a.Properties).find.apply(p,["firstCall"].concat(e)).getBool()||!1,seenWelcome:(f=a.Properties).find.apply(f,["seenWelcome"].concat(e)).getBool()||!1,suppressedWelcome:(g=a.Properties).find.apply(g,["suppressedWelcome"].concat(e)).getBool()||!1,forcedDenaliUI:(m=a.Properties).find.apply(m,["DN:forcedDenaliUI"].concat(e)).getBool()||!1,acceptedTermsVersion:(_=a.Properties).find.apply(_,["acceptedTermsVersion"].concat(e)).getStr()||"",dialectStrong:(y=a.Properties).find.apply(y,["dialectStrong"].concat(e)).getStr(),dialectWeak:(v=a.Properties).find.apply(v,["dialectWeak"].concat(e)).getStr(),denaliLens:(b=a.Properties).find.apply(b,["denaliLens"].concat(e)).getObject()||{},banners:{dismiss:u,later:this._parseLaterBanners(d),shown:i||s},onboardingPassed:(w=a.Properties).find.apply(w,["onboardingPassed"].concat(e)).getArray(),showExitNotification:(E=a.Properties).find.apply(E,["showExitNotification"].concat(e)).getBoolOrDefault(!0)};var h,p,f,g,m,_,y,v,b,w,E},e.prototype.checkAuthenticated=function(){return this._authApi.getUser().then(function(e){if(e.anonymous)throw new g}).catch(this._handleAuthError)},e.prototype._getUserMimicWithProps=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),t=(e=this._dapi).getMimicWithProps,[4,this._telemetry.getContainerId()];case 1:return[4,t.apply(e,[r.sent()])];case 2:return[2,r.sent()];case 3:return n=r.sent(),this._log.warn("dapiError: Failed to get dapi props and mimic groups",n),[2,{experiments:new Set,properties:a.Properties.of({})}];case 4:return[2]}})})},e.prototype._getUserSession=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,i,o,s,c;return r.__generator(this,function(r){switch(r.label){case 0:return[4,this._authApi.getUser(this._disableProofitField)];case 1:if(e=r.sent(),e.anonymous)throw new g;return[4,Promise.all([this._getUserMimicWithProps(),void 0!==e.institutionId?this._getUserInstitution():Promise.resolve(null)])];case 2:return t=r.sent(),n=t[0],i=n.properties,o=n.experiments,s=t[1],c=this._parseUserSettings(i,p.LocalStorageUserSettings.read(e.id),a.Properties.of(e.settings)),p.LocalStorageUserSettings.write(e.id,a.Properties.of(c)),[2,this._parseUserProfileJSON(e,c,o,s)]}})})},e.prototype._getUserInstitution=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t=this;return r.__generator(this,function(n){return e=o.Atom.create(u.Async.defaultValue()),u.Async.OperationRetrier.create(function(){return t._institutionApi.getInfo()},e,u.Async.OperationRetrier.RetryStrategy.conditional(this._retryWhen,u.Async.OperationRetrier.RetryStrategy.linear(3,3e3))),[2,e.do(function(e){u.Async.isError(e)&&1===e.attempt?t._log.info("institutionError: Failed to get institution info from first try",e.error):u.Async.isFatal(e)&&t._log.warn("institutionError: Can not get institution info",e.error)}).filter(u.Async.isTerminated).map(function(e){return u.Async.isFatal(e)?a.Institution.emptyInfo:e.value}).first().toPromise()]})})},e.prototype._gotoLogin=function(){this._gotoFunnelPage(this._appConfig.funnel.signin)},e.prototype._gotoFreePage=function(){this._navigateToFreePage()},e.prototype._gotoMainPage=function(){this._gotoFunnelPage(this._appConfig.funnel.mainPage)},e.prototype._gotoFunnelPage=function(e){if(l.isDesktopEditor(this._browser)){i.gt(l.getBrowserInfo().version,"1.5.29")?(this._log.info("Redirecting DTE to social signin page"),document.location.href=this._appConfig.funnel.socialSignin+"?fromDesktopEditor=true"):document.location.href=e}else document.location.href=e},e.prototype.logout=function(){var e,t=this,n=o.Atom.create(0),r=o.Atom.create(5),i=o.Atom.create(5),a=function(){return t._authApi.logout().catch(function(e){throw t._log.error("Logout error",e),e})},c=new s.Subject,l=function(){e.unsubscribe(),c.next(0),n.set(1),i.set(0),r.set(5)};this._modal.show({type:"inProgressSpinner"}),s.Observable.defer(a).retryWhen(function(o){return o.scan(function(e){return e+1},0).flatMap(function(o){if(o>10)throw i.set(-1),t._modal.hide(),t._overlay.show(),new Error("Logout retry limit exceeded");n.set(o);var a=Math.min(5*o,30);return r.set(a),i.set(a),e=s.Observable.interval(1e3).take(a).subscribe(function(){i.modify(function(e){return e-1}),0===i.get()&&c.next(0)}),c=new s.Subject})}).subscribe(function(){u.Extension.notifications.sendLogout(),t._gotoMainPage()},function(e){return t._log.error("Logout error",e)}),n.filter(function(e){return e>1}).first().subscribe(function(){return t._modal.notifications.show(t._modal.notifications.create.logoutError(l,i))})},e}();t.AuthenticationModelImpl=y},1376:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(6),o=n(5),s=function(){function e(e,t){this._notification=e,this._overlay=t}return e.prototype.getDisposer=function(e,t){var n=this;return void 0===t&&(t={hideOverlay:!1}),function(){e&&n._notification.hide(e),t.hideOverlay&&n._overlay.hide()}},e}();t.ErrorHandler=s;var a=function(e){function t(t,n){return e.call(this,t,n)||this}return r.__extends(t,e),t.prototype.handle=function(e){switch(e.type){case"slow":return this.getDisposer(this._notification.show(this._notification.create.slowNetwork()));case"offline":return this._overlay.show(),this.getDisposer(this._notification.show(this._notification.create.offline(e.timer.resetClock,e.timer.reconnectTime)),{hideOverlay:!0});default:return o.assertNever(e)}},t}(s);t.NetworkErrorHandler=a;var c=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r._log=i.Monitoring.Logging.getLogger("connectivity.wsProtocol"),r}return r.__extends(t,e),t.prototype.handle=function(e){switch(this._log.info(e.type),e.type){case"offline":return this._overlay.show(),this.getDisposer(this._notification.show(this._notification.create.connectionWSError()),{hideOverlay:!0});default:return o.assertNever(e.type)}},t}(s);t.WsProtocolErrorHandler=c;var u=function(e){function t(t,n,r,o){var s=e.call(this,t,n)||this;return s._authentication=r,s._navigateToDocuments=o,s._log=i.Monitoring.Logging.getLogger("connectivity.dox"),s}return r.__extends(t,e),t.prototype.handle=function(e){switch(this._log.info(e.type),this._overlay.show(),e.type){case"unauthorized":return this._authentication.checkAuthenticated(),this.getDisposer(this._notification.show(this._notification.create.unauthorizedError()),{hideOverlay:!0});case"serverError":return this.getDisposer(this._notification.show(this._notification.create.serverError()),{hideOverlay:!0});case"blockedByClient":return this.getDisposer(this._notification.show(this._notification.create.connectionWSError()),{hideOverlay:!0});case"clientConnectionError":return this.getDisposer(this._notification.show(this._notification.create.clientConnectionError()),{hideOverlay:!0});case"unknownConnectionError":return this.getDisposer(this._notification.show(this._notification.create.unknownConnectionError()),{hideOverlay:!0});case"documentNotFoundError":return this.getDisposer(this._notification.show(this._notification.create.documentNotFoundError(this._navigateToDocuments)),{hideOverlay:!0});default:return o.assertNever(e.type)}},t}(s);t.DoxErrorHandler=u;var l=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r._log=i.Monitoring.Logging.getLogger("connectivity.capi"),r}return r.__extends(t,e),t.prototype.handle=function(e){switch(this._log.info(e.type),e.type){case"offline":return this.getDisposer(this._notification.show(this._notification.create.checkingIsDown()));default:return o.assertNever(e.type)}},t}(s);t.CapiErrorHandler=l},1377:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(8),o=n(5),s=n(552);t.DoxOfflineType=s.DoxOfflineType;var a=function(){function e(e){var t=this;this._handlers=e,this.onlineState=i.Atom.create({network:{type:s.ONLINE},dox:{type:s.ONLINE},wsProtocol:{type:s.ONLINE},wsDox:{type:s.ONLINE},wsCapi:{type:s.ONLINE}}),this.networkOnline=this.onlineState.view(function(e){return"offline"!==e.network.type}),o.invariant(!this._subscription,"ConnectivityModel already subscribed"),this.onlineState.pairwise().subscribe(function(e){var n=e[0],r=e[1],i=t._getNextOfflineKey(n),o=t._getNextOfflineKey(r);if(null===o)return void(t._dispose&&t._dispose());var s=r[o];i===o&&n[i].type===s.type||(t._dispose&&t._dispose(),"online"!==s.type&&(t._dispose=t._handlers[o].handle(s)))})}return e.prototype.setState=function(e){var t=e.type,n=e.state;this.onlineState.modify(function(e){return r.__assign({},e,(i={},i[t]=n,i));var i})},e.prototype._getNextOfflineKey=function(e){if("offline"===e.network.type)return"network";if(e.wsProtocol.type!==s.ONLINE)return"wsProtocol";if(e.dox.type!==s.ONLINE)return"dox";if(e.wsDox.type!==s.ONLINE)return"wsDox";if(e.wsCapi.type!==s.ONLINE)return"wsCapi";if("slow"===e.network.type)return"network";var t=Object.keys(e).find(function(t){return"online"!==e[t].type});if(t)throw new o.InvariantError("Expected that state is online but got '"+t+"' is '"+e[t].type+"'");return null},e}();t.ConnectivityModelImpl=a},1378:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(22),i=n(8),o=n(6),s=n(99),a=n(5),c=10,u=5e3,l={method:"HEAD",mode:"cors"},d=function(){function e(e,t){var n=this;this._connectivity=e,this._onlineTestUrl=t,this._log=o.Monitoring.Logging.getLogger("networkConnectivity"),this._online=i.Atom.create("online"),this.check=a.throttleByPromise(function(){return n._checkRequest().then(n._setOnline).catch(function(){n._log.info("Online check failed, switching to offline state"),n._setOffline(n.check)})}),this.getOnlineStatus=function(){return n._online.get()},this.checkOnlineStatus=function(){return n.check().then(n.getOnlineStatus)},this._startReconnectTimer=function(e){n._stopTimer();var t=i.Atom.create(c),o=function(){t.set(c),e&&e()};n._reconnectTimer=r.Observable.interval(1e3).subscribe(function(){t.get()<=1&&e&&e(),t.modify(function(e){return e<=1?c:e-1})}),n._timer={resetClock:o,reconnectTime:t}},this._setOnline=function(){n._stopTimer(),n._online.modify(n._toSlowOrOnline)},this._setOffline=function(e){"offline"!==n._online.get()&&(n._startReconnectTimer(e),n._online.modify(n._toOffline))},this._checkRequest=function(){return a.Async.promiseWithTimeout(s.RxFetch.nativeFetch(n._onlineTestUrl+"?_="+Date.now(),l),u)},this._online.subscribe(function(e){switch(e){case"online":n._log.info("Switch back to online state"),n._connectivity.setState({type:"network",state:{type:"online"}});break;case"slow":n._connectivity.setState({type:"network",state:{type:"slow"}});break;case"offline":n._connectivity.setState({type:"network",state:{type:"offline",timer:n._timer}});break;default:a.assertNever(e)}}),this._online.filter(function(e){return"slow"!==e}).switchMap(function(e){return"offline"===e?r.Observable.empty():s.RxFetch.requestResults.filter(function(e){return"timeoutWarn"===e.type}).do(function(){n._online.modify(n._toSlow)}).switchMap(function(){return r.Observable.of(!1).delay(s.RxFetch.FETCH_TIMEOUT)})}).subscribe(function(){return n._online.modify(n._toOnline)}),r.Observable.fromEvent(window,"online").subscribe(this._setOnline),r.Observable.fromEvent(window,"offline").mapTo(void 0).subscribe(this._setOffline),this._online.switchMap(function(e){return"offline"===e?s.RxFetch.requestResults.filter(function(e){return"success"===e.type}):r.Observable.merge(s.RxFetch.requestResults.filter(function(e){var t=e.type;return"clientError"===t||"timeoutWarn"===t||"timeoutError"===t}),n._connectivity.onlineState.skip(1).filter(function(e){var t=e.dox,n=e.wsDox;return"online"!==e.wsCapi.type||"online"!==t.type||"online"!==n.type}))}).debounceTime(1e3).subscribe(this.check)}return e.prototype._stopTimer=function(){this._reconnectTimer&&(this._reconnectTimer.unsubscribe(),this._reconnectTimer=null)},e.prototype._toSlow=function(e){return"online"===e?"slow":e},e.prototype._toOnline=function(e){return"online"},e.prototype._toSlowOrOnline=function(e){return"offline"===e?"online":e},e.prototype._toOffline=function(e){return"offline"},e}();t.NetworkConnectivityModelImpl=d},1379:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(8),o=n(552),s=n(5),a=function(){function e(e,t){var n=this;this._connectivity=e,this._wsHandlers=t,this._wsState=i.Atom.create({wsDox:{type:o.ONLINE},wsCapi:{type:o.ONLINE}}),this._getChangedState=function(e){var t=e[0],r=e[1],i=Object.keys(t).find(function(e){return n._wasChanged(t,r,e)});return s.invariant(!!i,"WsState must be changed"),{type:i,state:r[i]}},this._handleStateChange=function(e){var t=e.type,r=e.state;r.type===o.ONLINE?n._connectivity.setState({type:t,state:{type:"online"}}):n._wsHandlers[t].handle(r)},this._wsState.pairwise().map(this._getChangedState).subscribe(this._handleStateChange)}return e.prototype.setState=function(e){var t=e.type,n=e.state;this._wsState.modify(function(e){return r.__assign({},e,(i={},i[t]=n,i));var i})},e.prototype._wasChanged=function(e,t,n){return e[n].type!==t[n].type},e}();t.WsConnectivityModelImpl=a},1380:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(80),o=n(5),s=n(576),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t}(o.CustomError),c=function(){function e(e,t){var n=this;this.networkState=e,this.connectivity=t,this.checkWs=function(){return"offline"===n.networkState.getOnlineStatus()?Promise.resolve():n._wsTest().catch(n._checkOnline)},this._wsTest=function(){return Promise.race([new Promise(function(e,t){var n=o.getWebSocket(i.appConfig.api.wsTest);if(!n)throw new a("Socket is not accessible");n.onmessage=function(){try{n.close(),e()}catch(e){t(e)}},n.onerror=function(e){return t(e)}}),s.timeoutLimit(s.TIMEOUT)])},this._checkOnline=function(){return n.networkState.checkOnlineStatus().then(function(e){return"offline"===e?Promise.resolve():Promise.reject(new a("Websocket test failed while network test passed"))})}}return e}();t.WsErrorHandler=c;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.handle=function(e){var t=this;switch(e.type){case"unknownConnectionError":case"clientConnectionError":case"blockedByClient":this.checkWs().then(function(){return t.connectivity.setState({type:"wsDox",state:{type:e.type}})}).catch(function(){t.connectivity.setState({type:"wsProtocol",state:{type:"offline"}})});break;case"serverError":case"unauthorized":case"documentNotFoundError":this.connectivity.setState({type:"wsDox",state:{type:e.type}});break;default:o.assertNever(e.type)}},t}(c);t.WsDoxErrorHandler=u;var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.handle=function(e){var t=this;switch(e.type){case"offline":this.checkWs().then(function(){return t.connectivity.setState({type:"wsCapi",state:{type:e.type}})}).catch(function(){t.connectivity.setState({type:"wsProtocol",state:{type:"offline"}})});break;default:o.assertNever(e.type)}},t}(c);t.WsCapiErrorHandler=l},1381:function(e,t,n){"use strict";function r(e){for(var t=0,n=Array.from(c.keys());t<n.length;t++){var r=n[t],i=new RegExp(r.replace("*","[\\w/]+"));if(e.match(i))return c.get(r)}throw new Error("pname doesn't match any of regexps")}function i(e){var t=r(e);if(!t)throw new Error("pname "+e+" should have a mapping");return t}function o(e,t){void 0===t&&(t=function(e){return e});try{return t(i(e))}catch(t){return void s.Monitoring.Logging.getLogger("model.denali.alert_to_lens").info("Can't find lens by pname",t,{pname:e})}}Object.defineProperty(t,"__esModule",{value:!0});var s=n(6),a={},c=new Map;for(var u in a)!function(e){a[e].forEach(function(t){var n=t.title,r=t.rank,i=t.description;t.cards.forEach(function(t){c.set(t,{title:n,type:e,rank:r,description:i,key:n.replace(" ","_")})})})}(u);t.Lenses=Array.from(c.values()).filter(function(e,t,n){return n.findIndex(function(t){return t.key===e.key})===t}),t.pnameToLensUnsafe=i,t.pnameToLensProp=o},1382:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),i=n(22);t.defaultState={textScrollPosition:0};var o=function(){function e(){this.textScrollPosition=new i.Subject,this.sidebarScrollTopOffset=new i.Subject,this.viewportSize=r.Atom.create({top:0,height:0,scrollTop:0,left:0}),this.sidebarScrollBy=new i.Subject,this._textScrollOffsetReset=new i.Subject}return e.prototype.setTextScrollPosition=function(e){this.textScrollPosition.next(e)},e.prototype.clearTextScrollPosition=function(){this._textScrollOffsetReset.next(0)},e.prototype.createTextScrollOffset=function(e){var t={negativeTop:0,bottom:0};return i.Observable.merge(this._textScrollOffsetReset.mapTo(t),this.textScrollPosition.map(function(t){return{negativeTop:Math.max(-t,0),bottom:Math.max(t-e(),0)}}).startWith(t)).distinctUntilChanged()},e.prototype.ensureCardIsInSidebarViewport=function(e){var t=e.top,n=e.height,r=this.viewportSize.get();if(t<52)return this.sidebarScrollTopOffset.next(r.scrollTop+t-52),52;if(t+n>r.height){var i=r.height-n<52?r.height-52:n;return this.sidebarScrollTopOffset.next(r.scrollTop+(t+i-r.height)),r.height-i}return t},e.prototype.setViewportSize=function(e,t,n,r){this.viewportSize.set({top:e,left:t,height:n,scrollTop:r})},e.prototype.scrollBy=function(e){this.sidebarScrollBy.next(e)},e}();t.DenaliScrollModelImpl=o},1383:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(22),i=function(){function e(){var e=this;this.scrollTo=new r.Subject,this.focused=new r.Subject,this.focusedEvent=function(t){var n=t.target;"TEXTAREA"!==n.tagName&&"INPUT"!==n.tagName&&e.focused.next()}}return e.prototype.nextCursorPosition=function(e){var t=.7*Math.max(document.documentElement.clientHeight,window.innerHeight||0);e.top>t&&this.scrollTo.next(Math.round(e.top-t))},e}();t.DenaliEditorViewModel=i},1384:function(e,t,n){"use strict";function r(e,t){var n="prev"===t?e.previousSibling:e.nextSibling;if(!n)return e.parentNode?r(e.parentNode,t):"";var i=n.textContent;return i?" "===i?"prev"===t?r(n,"prev")+" ":" "+r(n,"next"):i:""}function i(e,t){var n=r(e,t);if(!n)return null;var i="prev"===t?n.replace(/\s$/,"").match(/\w+.\w+.?$/):n.replace(/^\s/,"").match(/^.?\w+.\w+/);return null===i?null:i[0]}function o(e){var t=document.querySelector(".gr_"+e.id);return t?[i(t,"prev"),i(t,"next")]:[null,null]}Object.defineProperty(t,"__esModule",{value:!0});var s=n(1381);t.LensType=s.LensType,t.Lenses=s.Lenses,t.pnameToLensUnsafe=s.pnameToLensUnsafe,t.pnameToLensProp=s.pnameToLensProp,t.getAlertContext=o},1385:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),i=n(5);t.defaultState={dictionary:null,status:i.Async.defaultValue()};var o=function(){function e(e,t){this._state=e,this._api=t,this.dictionary=this._state.lens("dictionary"),this.syncStatus=this._state.lens("status"),this.isInProgress=this.syncStatus.view(function(e){return e.status===i.Async.Status.inProgress}),this.ready=this.dictionary.view(function(e){return null!==e}),this.isReadyOrError=r.Atom.combine(this.ready,this.syncStatus,function(e,t){return e||t.status===i.Async.Status.error}),this.isNotReadyOrInProgres=r.Atom.combine(this.ready,this.isInProgress,function(e,t){return!e||t})}return e.prototype.update=function(){var e=this;return this.isInProgress.get()?Promise.resolve():i.Async.runWithTimeout(function(){return e._api.get().then(function(t){return e.dictionary.set(t)})},this.syncStatus)},e.prototype.add=function(e){var t=this;return i.Async.modifyRemoteState(this.dictionary,function(t){return[e].concat(t||[])},function(){return i.Async.runWithTimeout(function(){return t._api.add(e).then(function(e){return Promise.resolve()})},t.syncStatus)})},e.prototype.remove=function(e){var t=this;return i.Async.modifyRemoteState(this.dictionary,function(t){return(t||[]).filter(function(t){return t!==e})},function(){return i.Async.runWithTimeout(function(){return t._api.delete(e).then(function(e){return Promise.resolve()})},t.syncStatus)})},e}();t.DictionaryModelImpl=o},1386:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(8),o=n(6),s=n(553),a=n(5),c=n(120);!function(e){e[e.documentTypeUnsupported=0]="documentTypeUnsupported",e[e.documentIsEmpty=1]="documentIsEmpty",e[e.documentSizeExceeded=2]="documentSizeExceeded",e[e.noFilesToUpload=3]="noFilesToUpload",e[e.onlyOneDocumentAllowed=4]="onlyOneDocumentAllowed"}(r||(r={}));var u=function(e){return e&&s.ACCEPTED_UPLOAD_EXTENSIONS.some(function(t){return e.toLowerCase().endsWith(t)})},l=function(){return a.Async.defaultValue()},d=function(){function e(e,t,n,r){var o=this;this._upload=e,this._navigateToDocument=t,this._notifications=n,this._telemetry=r,this._state=i.Atom.create(l()),this._inBackground=!1,this.state=this._state.view(),this._state.filter(function(e){return a.Async.isTerminated(e)}).subscribe(function(e){if(a.Async.isOk(e)){var t=e.value,n=t.id,r=t.notify,i=o._navigateToDocument.bind(o,n,{openSidebar:!0,showDocumentUploadedNotification:r});o._inBackground?o._notifications.show(o._notifications.create.documentUploaded(i)):i()}else o._handleError(e.error)})}return e.prototype.upload=function(e,t){var n=this;if(void 0===t&&(t=!0),a.Async.isInProgress(this._state.get())){var i={type:"clientError",errorType:r.onlyOneDocumentAllowed};return this._handleError(i),Promise.resolve(a.Either.left(i))}this._inBackground=!1,this._state.modify(a.Async.begin);var o=this._validateFile(e);if(null!==o){var s={type:"clientError",errorType:o};return this._state.modify(a.Async.fatal(s)),this._state.set(l()),Promise.resolve(a.Either.left(s))}var c=e[0];return this._upload(c).then(function(e){var r=String(e.id);return n._state.modify(a.Async.success({id:r,notify:t})),n._telemetry.uploadDocument(!0),a.Either.right(r)}).catch(function(e){var t={type:"serverError",error:e};return n._state.modify(a.Async.fatal(t)),a.Either.left(t)}).then(function(e){return n._state.set(l()),e})},e.prototype.navigated=function(){this._inBackground=!0},e.prototype._handleError=function(e){"clientError"===e.type?this._handleClientError(e):this._handleServerError(e)},e.prototype._handleServerError=function(e){var t=e.error;o.Monitoring.Logging.getLogger("document.upload").error("uploadDocument failed",t),t instanceof c.DoxErrors.FileSizeOutOfRangeError?(this._telemetry.uploadDocument(!1,"serverError",r[r.documentSizeExceeded]),this._notifications.show(this._notifications.create.documentSizeExceeded())):t instanceof c.DoxErrors.UnsupportedFileTypeError?(this._telemetry.uploadDocument(!1,"serverError",r[r.documentTypeUnsupported]),this._notifications.show(this._notifications.create.documentTypeUnsupported())):t instanceof c.DoxErrors.TrackedChangesIsUnsupported?(this._telemetry.uploadDocument(!1,"serverError",t.message),this._notifications.show(this._notifications.create.trackedChangesIsUnsupported())):t instanceof c.DoxErrors.TooManyRequestsError?(this._telemetry.uploadDocument(!1,"serverError",t.message),this._notifications.show(this._notifications.create.error())):(this._telemetry.uploadDocument(!1,"serverError",t&&t.message),this._notifications.show(this._notifications.create.documentUploadGeneralError()))},e.prototype._handleClientError=function(e){var t=e.errorType;switch(this._telemetry.uploadDocument(!1,"clientError",r[t]),t){case r.documentTypeUnsupported:this._notifications.show(this._notifications.create.documentTypeUnsupported());break;case r.documentIsEmpty:this._notifications.show(this._notifications.create.documentIsEmpty());break;case r.documentSizeExceeded:this._notifications.show(this._notifications.create.documentSizeExceeded());break;case r.noFilesToUpload:this._notifications.showMessage("No files to upload!");break;case r.onlyOneDocumentAllowed:this._notifications.showMessage("Only one document upload at a time is allowed");break;default:a.assertNever(t)}},e.prototype._validateFile=function(e){var t=e?e[0]:null;return t?e&&e.length>1?r.onlyOneDocumentAllowed:u(t.name)?t.size?t.size>4194304?r.documentSizeExceeded:null:r.documentIsEmpty:r.documentTypeUnsupported:r.noFilesToUpload},e}();t.UploadModel=d},1387:function(e,t,n){"use strict";function r(e,t){function n(r){try{return e()}catch(e){if(r<t.length)return t[r](),n(r+1);throw e}}return n(0)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),o=n(5),s=function(){function e(e,t,n,r,s,a){void 0===s&&(s=o.LocalStorage.DenaliStorage.fromLocalStorage(o.LocalStorage.ls)),void 0===a&&(a=12096e5);var c=this;this._deserializeAlerts=e,this._serializeAlerts=t,this._storageNamePrefix=n,this._storageAlertVersion=r,this._storage=s,this._maxCacheAgeMs=a,this._log=i.Monitoring.Logging.getLogger("model.editor.alert_cache"),this._alertCacheKeyRe=new RegExp(o.StringUtils.escapeRegExp(this._getStorageKeyVersionedPrefix())+"-.+"),requestAnimationFrame(function(){try{c._pruneOldVersions()}catch(e){c._log.debug("could not clean old versions alerts",e)}})}return e.prototype._decodeCacheItem=function(e){var t=this,n=e.match(/([^;]+);([^;]+);([^;]+);(.*)/);if(!n)throw new TypeError("unexpected value content");var r=n.splice(1,5).map(function(e){return JSON.parse(e)}),i=r[0],s=r[1],a=r[2],c=r[3];if(void 0!==i&&"number"==typeof i&&void 0!==s&&void 0!==a&&"boolean"==typeof a&&void 0!==c&&Array.isArray(c)){var u=o.lazy(function(){return t._deserializeAlerts(c)});return{timeStamp:i,context:s,isFreeUser:a,get alerts(){return u.value}}}throw new TypeError("unexpected value content")},e.prototype._encodeCacheItem=function(e){var t=e.timeStamp,n=e.context,r=e.isFreeUser,i=e.alerts;return[t,n,r,this._serializeAlerts(i)].map(function(e){return JSON.stringify(e)}).join(";")},e.prototype._getStorageKeyVersionedPrefix=function(){return this._storageNamePrefix+this._storageAlertVersion},e.prototype._getStorageKeyForDoc=function(e){return this._getStorageKeyVersionedPrefix()+"-"+e},e.prototype._isAlertCacheKey=function(e){return this._alertCacheKeyRe.test(e)},e.prototype._isOldAlertCacheKey=function(e){return e.startsWith(this._storageNamePrefix)&&!e.startsWith(this._getStorageKeyVersionedPrefix())},e.prototype._saveAlerts=function(e,t,n,r){var i=this._encodeCacheItem({timeStamp:Date.now(),context:t,isFreeUser:n,alerts:r});this._storage.setItem(this._getStorageKeyForDoc(e),i)},e.prototype._loadAlerts=function(e,t,n){var r=this._storage.getItem(this._getStorageKeyForDoc(e));if(r.isEmpty())return null;var i=void 0;try{i=this._decodeCacheItem(r.get())}catch(t){try{this._removeAlerts(e)}catch(e){this._log.debug("could not remove broken cache item",e)}return null}if(i.isFreeUser===n&&i.context===t)return i.alerts;try{this._removeAlerts(e)}catch(e){this._log.debug("could not remove cache for a user of different type",e)}return null},e.prototype._removeAlerts=function(e){this._storage.removeItem(this._getStorageKeyForDoc(e))},e.prototype._pruneOldEditor=function(){var e=this;this._storage.getKeys().filter(function(e){return/matches_\d+/.test(e)}).forEach(function(t){return e._storage.removeItem(t)})},e.prototype._getAlertCacheKeys=function(){var e=this;return this._storage.getKeys().filter(function(t){return e._isAlertCacheKey(t)})},e.prototype._pruneOld=function(){var e=this,t=Date.now();this._getAlertCacheKeys().forEach(function(n){var r=e._storage.getItem(n);if(!r.isEmpty()){var i=void 0;try{i=e._decodeCacheItem(r.get())}catch(t){return void e._storage.removeItem(n)}t-i.timeStamp>e._maxCacheAgeMs&&e._storage.removeItem(n)}})},e.prototype._pruneAll=function(){var e=this;this._getAlertCacheKeys().forEach(function(t){return e._storage.removeItem(t)})},e.prototype._pruneOldVersions=function(){var e=this;this._storage.getKeys().filter(function(t){return e._isOldAlertCacheKey(t)}).forEach(function(t){return e._storage.removeItem(t)})},e.prototype.load=function(e,t,n){return this._loadAlerts(e,t,n)},e.prototype.hasCache=function(e,t,n){var r=this;return this._storage.getItem(this._getStorageKeyForDoc(e)).map(function(e){return r._decodeCacheItem(e)}).filter(function(e){return e.context===t&&e.isFreeUser===n}).map(function(e){return!0}).getOrElse(!1)},e.prototype.save=function(e,t,n,i){var o=this;try{return r(function(){return o._saveAlerts(e,t,n,i)},[function(){return o._pruneOldEditor()},function(){return o._pruneOld()},function(){return o._pruneAll()}])}catch(e){this._log.warn("Cannot write to localStorage",e)}},e.prototype.remove=function(e){this._removeAlerts(e)},e}();t.AlertCacheImpl=s},1388:function(e,t,n){"use strict";function r(e,t){var n=e.extra_properties&&e.extra_properties[t];return o.Option.of(n)}function i(e){var n=e.rawMatch,i=r(n,"source").filter(function(e){return"PUBLICATION"===e}),a=r(n,"title"),c=i.fold(function(){return o.Option.some("A part of your paper is matching some text from the web. Please make sure that this text is properly referenced.")},function(){return a.map(function(e){return'A part of your document is matching the publication "'+e+'."'})}),u=i.fold(function(){return o.Either.left({title:a,dateAccessed:t.parseDateAccessed(n.details)})},function(){return o.Either.right({mla:r(n,"reference_mla"),apa:r(n,"reference_apa"),chicago:r(n,"reference_chicago")})});return{title:"Unoriginal text: "+s.StringUtils.wordCount(n.text)+" words",description:c,url:r(n,"url").filter(function(e){return e.length>0}),reference:u}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(18),s=n(5);t.parseDateAccessed=function(e){void 0===e&&(e="");var t=e.match(/accessed\s(.*?)\)/);return o.Option.of(t).mapN(function(e){return e[1]})},t.parsePlagiarism=i},1389:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(8),o=n(6),s=n(196),a=n(5),c=n(555),u=n(557),l=n(298),d=n(53),h=n(120);t.defaultState={session:null,document:c.defaultState};var p=function(){function e(e,t,n,s,d,h,p,f,g,m,_){var y=this;this._state=e,this._dialectSettingsModel=t,this._doxApi=n,this._capiWsUrl=s,this._features=d,this._telemetry=h,this._modal=p,this._alertCache=f,this._wsConnectivity=g,this._connectivity=m,this._notifications=_,this._log=o.Monitoring.Logging.getLogger("model.editor.editor_page"),this._sessionState=this._state.lens("session"),this.currentSession=i.Atom.create(null),this._doStartSession=function(e){return r.__awaiter(y,void 0,void 0,function(){var t,n,i,o,s,a,d;return r.__generator(this,function(r){switch(r.label){case 0:return t=new c.DocumentModelImpl(e,this._state.lens("document"),this._doxApi,this._doxConnectivity,this._features.demoMode),[4,t.startSession()];case 1:return n=r.sent(),i=n.documentSession,o=n.initialGenre,s=n.initialChecks,this._sessionState.set(u.createDefaultState(o,s,this._features.defaultAcademicGenre.get().enabled)),a=this._sessionState,d=new u.EditorSessionImpl(a,i,new l.TextStatsModelImpl(a.lens("textStats")),this._capiWsUrl,this._dialectSettingsModel,this._features,this._telemetry,this._alertCache,this._capiConnectivity),this._telemetry.documentShow(e.toString()),[2,d]}})})},this._connectionManager=new a.ConnectionManager(this._doStartSession,function(e){return e.end()},this.currentSession),this._capiConnectivity=i.Atom.create({type:"init"}),this._doxConnectivity=i.Atom.create({type:"init"}),this._subs=[]}return e.prototype.startSession=function(e){var t=this;if(isNaN(Number(e)))throw new Error("Invalid documentId");var n=i.Atom.create(a.Async.defaultValue());this._subs=[a.Async.OperationRetrier.create(function(){return t._connectionManager.terminate(),t._connectionManager.connect(e)},n,a.Async.OperationRetrier.RetryStrategy.conditional(this._retryWhen,a.Async.OperationRetrier.RetryStrategy.linear(5,3e3))),n.filter(function(e){return a.Async.isError(e)&&3===e.attempt||a.Async.isFatal(e)}).subscribe(function(e){t._doxConnectivity.set({type:"error",reason:"session open",error:e.error})}),n.filter(a.Async.isOk).take(1).subscribe(function(){t._doxConnectivity.set({type:"success"})}),this._connectivity.networkOnline.subscribe(function(e){return e?t.listenConnectivity():t.clearConnectivityListener()})]},e.prototype.endSession=function(){this._subs.forEach(function(e){return e.unsubscribe}),this._subs=[],this.clearConnectivityListener(),this._connectionManager.terminate()},e.prototype._doxErrorHandler=function(e){var t=e.reason,n=e.error,r={reason:t};if(n)if(n instanceof d.HTTPError)this._httpErrorHandler(n.code,t,n);else if(n instanceof d.WSError)this._wsErrorHandler(n.code,t,n);else if(n instanceof s.FetchError){var i="clientConnectionError";this._log.warn("DOX connectivity error: "+i,n,r),this._connectivity.setState({type:"dox",state:{type:i}})}else{var i="unknownConnectionError";this._log.error("DOX connectivity error: "+i,n,r),this._connectivity.setState({type:"dox",state:{type:i}})}else this._log.error("DOX connectivity error: unknown",r)},e.prototype._httpErrorHandler=function(e,t,n){var r=this,i={code:e,reason:t},o=function(e){r._log.error("DOX connectivity error: "+e,n,i),r._connectivity.setState({type:"dox",state:{type:e}})};switch(e){case h.DoxErrors.HttpCodes.NOT_FOUND:this._log.info("DOX connectivity error",n,i),this._modal.show({type:"documentNotFound"});break;case h.DoxErrors.HttpCodes.UNAUTHORIZED:o("unauthorized");break;case h.DoxErrors.HttpCodes.TOO_MANY_REQUESTS:this._log.warn("Too many requests",n,i),this._notifications.show(this._notifications.create.error());break;default:o(a.isServerErrorCode(e)?"serverError":"unknownConnectionError")}},e.prototype._wsErrorHandler=function(e,t,n){var r=this,i={code:e,reason:t},o=function(e){r._log.error("WS DOX connectivity error: "+e,n,i),r._wsConnectivity.setState({type:"wsDox",state:{type:e}})};switch(e){case h.DoxErrors.WsCodes.NOT_FOUND:this._log.info("WS DOX connectivity error",n,i),this._modal.show({type:"documentNotFound"});break;case h.DoxErrors.WsCodes.UNAUTHORIZED:o("unauthorized");break;case h.DoxErrors.WsCodes.BLOCKED_BY_CLIENT:o("blockedByClient");break;default:o([0,-1,1005,1006].indexOf(e)>0?"unknownConnectionError":"serverError")}},e.prototype.listenConnectivity=function(){var e=this;this._connectivitySubs=[this._doxConnectivity.distinctUntilChanged(function(e,t){return e instanceof d.WSError&&t instanceof d.WSError&&e===t}).subscribe(function(t){switch(t.type){case"error":e._doxErrorHandler(t);break;case"success":e._connectivity.setState({type:"dox",state:{type:"online"}}),e._wsConnectivity.setState({type:"wsDox",state:{type:"online"}});break;case"init":break;default:a.assertNever(t)}}),this._capiConnectivity.subscribe(function(t){switch(t.type){case"connected":e._wsConnectivity.setState({type:"wsCapi",state:{type:"online"}});break;case"disconnected":e._log.warn("CAPI disconnected",t.error),e._wsConnectivity.setState({type:"wsCapi",state:{type:"offline"}});break;case"init":break;default:a.assertNever(t)}})]},e.prototype.clearConnectivityListener=function(){this._connectivitySubs&&(this._connectivitySubs.map(function(e){return e.unsubscribe()}),this._connectivitySubs=[]),this._wsConnectivity.setState({type:"wsDox",state:{type:"online"}}),this._wsConnectivity.setState({type:"wsCapi",state:{type:"online"}}),this._doxConnectivity.set({type:"init"}),this._capiConnectivity.set({type:"init"}),this._connectivity.setState({type:"dox",state:{type:"online"}})},e.prototype._retryWhen=function(e){return e instanceof d.HTTPError?a.isServerErrorCode(e.code)||0===e.code:!(e instanceof d.WSError)||e.code<4e3},e}();t.EditorPageModelImpl=p},1390:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(43),i=n(559),o=n(8),s=function(){function e(e,t,n){var r=this;this._synonymsModel=e,this._es=t,this._apply=n,this.viewState=o.Atom.create(null),this._synonymsModel.state.subscribe(function(e){i.SynonymsModel.isReady(e)&&void 0!==e.synonyms&&r.viewState.set({synonymsState:e,popupVisible:!1})})}return e.prototype.apply=function(e){var t=this.viewState.get();null!==t&&i.SynonymsModel.isReady(t.synonymsState)&&void 0!==t.synonymsState.synonyms&&this._apply(t.synonymsState.synonyms.alert,t.synonymsState.query,e),this.hide()},e.prototype.showPopup=function(){r.invariant(i.SynonymsModel.isReady(this._synonymsModel.state.get()));var e=this._synonymsModel.state.get().query;this._es().highlightSynonym(e.start,e.word),this.viewState.modify(function(e){return null===e?null:{cursorPosition:e.cursorPosition,wordPosition:e.wordPosition,popupVisible:!0,synonymsState:e.synonymsState}})},e.prototype.hidePopup=function(){this.viewState.modify(function(e){return null===e?null:{cursorPosition:e.cursorPosition,popupVisible:!1,synonymsState:e.synonymsState}})},e.prototype.showButton=function(e){this.hide(),this._synonymsModel.query(e)},e.prototype.hide=function(){this._synonymsModel.abortQuery(),this.viewState.set(null)},e.prototype.move=function(e,t){this.viewState.modify(function(n){return null===n?null:{cursorPosition:e,wordPosition:t,popupVisible:n.popupVisible,synonymsState:n.synonymsState}})},e}();t.SynonymsViewModelImpl=s},1391:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(6),o=n(5),s=function(){function e(e,t,n,r,o){this._browser=e,this._chromeUrl=t,this._firefoxUrl=n,this._firefoxIconUrl=r,this._notifications=o,this._log=i.Monitoring.Logging.getLogger("model.extInstall")}return e.prototype._installChromeExtension=function(){var e=this;return new Promise(function(t,n){return window.chrome.webstore.install(e._chromeUrl,function(){o.Cookie.setInstallSourceCookie(),t(!0)},function(e,t){return n({err:e,errorCode:t})})})},e.prototype.install=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,i=this;return r.__generator(this,function(r){switch(r.label){case 0:switch(e=this._browser){case"chrome":return[3,1];case"firefox":return[3,4];case"safari":case"edge":return[3,5]}return[3,6];case 1:return r.trys.push([1,3,,4]),[4,this._installChromeExtension()];case 2:return[2,r.sent()];case 3:return t=r.sent(),"userCancelled"===t.errorCode?this._log.warn("chrome extension install cancelled"):(n=t||new Error("banner: Click on install error is undefined"),this._log.error("chrome extension install failed",{error:n}),this._notifications.show(this._notifications.create.extensionInstallFailed())),[2,!1];case 4:return o.Cookie.setInstallSourceCookie(),window.InstallTrigger.install({Grammarly:{URL:this._firefoxUrl,IconURL:this._firefoxIconUrl,toString:function(){return i._firefoxUrl}}}),[2,!0];case 5:return[2,!0];case 6:throw new TypeError("Unexpected input in browser variable: "+this._browser)}})})},e}();t.ExtensionInstallModelImpl=s},1392:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultState={visible:!1,opts:{type:null}};var r=function(){function e(e,t,n){this._state=e,this.os=t,this.notifications=n,this.state=this._state.view()}return e.prototype.show=function(e){this._state.set({visible:!0,opts:e})},e.prototype.hide=function(){this._state.set(t.defaultState)},e}();t.ModalDialogModelImpl=r;var i=function(){function e(e){this._state=e,this.state=this._state.view()}return e.prototype.show=function(){this._state.set({visible:!0})},e.prototype.hide=function(){this._state.set({visible:!1})},e}();t.ModalOverlayModelImpl=i},1393:function(e,t,n){"use strict";function r(e,t,n,r){var s=3,a="windows"===n,c="mac"===n;return r&&!o.isAddinInstalled(e)&&a||s--,r&&!e.has(i.UserGroups.DESKTOP_EDITOR_INSTALLED)&&(a||c)||s--,o.isExtensionInstalled()&&s--,o.isBrowserHasExtension(t)||s--,s}Object.defineProperty(t,"__esModule",{value:!0});var i=n(121),o=n(199),s=["chrome","firefox","safari"],a=function(){function e(e,t,n){this.features=e,this._browser=t,this._os=n,this._showDesktopApps=this.features.desktopApps.get().enabled,this._appsSection=this.features.appsSection.get().enabled}return e.prototype.getAppsCount=function(e){return r(e,this._browser,this._os,this._showDesktopApps)},e.prototype.isAppsVisible=function(){var e=this;return this._appsSection&&(this._showDesktopApps||s.some(function(t){return t===e._browser}))},e}();t.NavigationBarModelImpl=a},1394:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(22),o=function(){function e(){this._dismissStream=new i.Subject}return e.prototype.dismiss=function(){this._cancel()},e.prototype.remind=function(){this._cancel()},e.prototype.cancel=function(){this._cancel()},e.prototype._cancel=function(){this._dismissStream.next(!1)},e}();t.ProofitBanner=o;var s=function(e){function t(t,n){var r=e.call(this)||this;return r._proofit=t,r._goToDocument=n,r._proofitStream=r._proofit.do(function(e){var t=e.id;return r._id=t}).map(function(e){return null!==e.id}),r.state=r._dismissStream.merge(r._proofitStream).distinctUntilChanged(),r}return r.__extends(t,e),t.prototype.install=function(){this.cancel(),this._id&&this._goToDocument(this._id)},t}(o);t.CancelledBanner=s;var a=function(e){function t(t){var n=e.call(this)||this;return n._proofitState=t,n.proofit=n._dismissStream.mapTo(null).merge(n._proofitState.map(function(e){return e})).distinctUntilChanged(),n}return r.__extends(t,e),t.prototype.install=function(){this.cancel()},t}(o);t.CompletedBanner=a},1395:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(288),i=n(22),o=n(8),s=n(6),a=n(196),c=n(5),u=n(80),l=function(){function e(e,t){var n=this;this._selfUpdate=t,this._logger=s.Monitoring.Logging.getLogger("router"),u.buildInfo.version&&setInterval(function(){return n.handleUpdate(e,u.buildInfo.version)},this._selfUpdate.versionCheckInterval)}return e.prototype.getVersion=function(){var e=this,t=o.Atom.create(c.Async.defaultValue());return c.Async.OperationRetrier.create(function(){return a.RxFetch.request("self_update")(e._selfUpdate.versionFilePath).then(function(e){return e.json()})},t,c.Async.OperationRetrier.RetryStrategy.linear(this._selfUpdate.retryFailedVersionCheckLimit,this._selfUpdate.retryFailedVersionCheckInterval)),t.filter(c.Async.isTerminated).first().toPromise().then(function(e){if(c.Async.isFatal(e))throw e.error;return e.value}).catch(function(t){return e._logger.warn("forceReload.getVersion failed",t)})},e.prototype.handleUpdate=function(e,t){var n=this;this.getVersion().then(function(o){r.lt(t,o.minimalVersion)?(i.Observable.fromEvent(document,"visibilitychange").startWith(void 0).map(function(){return document.hidden}).distinctUntilChanged().switchMap(function(e){return e?i.Observable.of(!0).delay(n._selfUpdate.forceUpdateOnHiddenDelay):i.Observable.empty()}).first().subscribe(e.forceReload),e.scheduleForceReload()):r.lt(t,o.currentVersion)&&setTimeout(e.scheduleForceReload,n._selfUpdate.latestVersionDelay)}).catch(function(e){return n._logger.warn("forceReload.handleUpdate failed",e)})},e}();t.SelfUpdate=l},1396:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(8),o=n(633),s=n(634),a=n(6),c=n(207),u=function(e,t){return new Promise(function(n,r){return e(t,function(e,t){if(e)return r(e);n(t)})})},l="braintree-hosted-fields-invalid",d=function(){function e(e,t,n){var d=this;this._notificationModel=e,this._irbisApi=t,this._updateSubscriptionState=n,this._log=a.Monitoring.Logging.getLogger("model.subscription.braintree"),this._braintreeInitializedInCreditCardForm=i.Atom.create(!1),this._teardownInProgress=!1,this.braintreeInitializedInCreditCardForm=this._braintreeInitializedInCreditCardForm.view(),this.updateCreditCard=function(e){return new Promise(function(t,n){d._hostedFields.tokenize(function(r,i){if(r){var o=d._hostedFields.getState().fields;return Object.keys(o).forEach(function(e){o[e].isValid||o[e].container.classList.add(l)}),void n(r)}i||n(r),d._irbisApi.updateCreditCard(i.nonce,e).then(function(){return Object.keys(d._hostedFields.getState().fields).forEach(function(e){return d._hostedFields.clear(e)}),t()}).then(d._updateSubscriptionState).catch(n)})})},this.getBraintreeClient=function(){return r.__awaiter(d,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){switch(n.label){case 0:return this._braintreeClient?[2,this._braintreeClient]:[4,this._generateCardToken()];case 1:return e=n.sent(),[4,u(o.create,{authorization:e})];case 2:return t=n.sent(),this._braintreeClient=t,[2,t]}})})},this.initInCreditCardForm=function(e){return r.__awaiter(d,void 0,void 0,function(){var t,n,i,o;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),this._notificationModel.clearNotification(),[4,this.getBraintreeClient()];case 1:return t=r.sent(),n={client:t,styles:e.styles,fields:e.fields},[4,u(s.create,n)];case 2:return i=r.sent(),this._hostedFields=i,this._braintreeInitializedInCreditCardForm.set(!0),[3,4];case 3:return(o=r.sent())&&"HOSTED_FIELDS_INVALID_FIELD_SELECTOR"!==o.code?[2]:(this._notificationModel.setNotification(c.SubscriptionNotificationType.unknownError),[3,4]);case 4:return[2]}})})},this.cleanupInCreditCardForm=function(){try{if(d._notificationModel.clearNotification(),d._teardownInProgress)return;return d._teardownInProgress=!0,d._hostedFields&&d._hostedFields.teardown(function(e){d._teardownInProgress=!1,e?d._log.error("Could not tear down Hosted Fields!",e):d._braintreeInitializedInCreditCardForm.set(!1)})}catch(e){d._log.warn("Braintree teardown error",e)}}}return e.prototype._generateCardToken=function(){return r.__awaiter(this,void 0,void 0,function(){var e;return r.__generator(this,function(t){switch(t.label){case 0:return[4,this._irbisApi.generateTokenCreditCard()];case 1:return e=t.sent().requestId,[4,this._irbisApi.getTokenRequest(e)];case 2:return[2,t.sent()]}})})},e}();t.BraintreeModelImpl=d},1397:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(6),o=n(5),s=n(207),a=function(){function e(e,t,n){this._notificationModel=e,this._irbisApi=t,this._updateSubscriptionState=n,this._log=i.Monitoring.Logging.getLogger("model.subscription.PayPal")}return e.prototype.initialize=function(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,this._initialize(e)];case 1:return n.sent(),[4,this._generateToken()];case 2:return n.sent(),[3,4];case 3:return t=n.sent(),this._log.error("paypal init error",t),this._notificationModel.setNotification(s.SubscriptionNotificationType.paypalError),[3,4];case 4:return[2]}})})},e.prototype.update=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),this._token?[3,2]:[4,this._generateToken()];case 1:n.sent(),n.label=2;case 2:return[4,this._irbisApi.getPaypalRedirectPageRequest(this._token)];case 3:if(!(e=n.sent()))throw new Error("Irbis return undefined paypal url");return document.location.href=e,[4,o.delay(5e3)];case 4:return n.sent(),[3,6];case 5:return t=n.sent(),this._log.error("paypal update error",t),this._notificationModel.setNotification(s.SubscriptionNotificationType.paypalError),[3,6];case 6:return[2]}})})},e.prototype._initialize=function(e){var t=e.token,n=e.paypal;return r.__awaiter(this,void 0,void 0,function(){var e=this;return r.__generator(this,function(i){return t.map(function(t){return r.__awaiter(e,void 0,void 0,function(){return r.__generator(this,function(e){switch(e.label){case 0:return[4,this._irbisApi.updatePaypal(t)];case 1:return e.sent(),[4,this._updateSubscriptionState()];case 2:return e.sent(),[2]}})})}),n.map(function(e){return"ok"===e.toLowerCase()?s.SubscriptionNotificationType.paypalSuccess:s.SubscriptionNotificationType.paypalError}).map(this._notificationModel.setNotification),[2]})})},e.prototype._generateToken=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t;return r.__generator(this,function(n){switch(n.label){case 0:return e=this._generateLinks(),[4,this._irbisApi.generateTokenPaypal(e)];case 1:return t=n.sent().requestId,this._token=t,[2]}})})},e.prototype._generateLinks=function(){var e=document.location.protocol+"//"+document.location.host+document.location.pathname.replace(/\/$/,"");return{cancelUrl:e+"?paypal=error",returnUrl:e+"?paypal=ok"}},e}();t.PayPalModelImpl=a},1398:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(14),o=n(119),s=n(309),a=n(934),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.back=function(){window.history.back()},t.prototype.render=function(){return i.createElement(o.BasePage,{title:"Page not found | Grammarly"},i.createElement("div",null,i.createElement(s.Logo,{mainPageUrl:this.context.appConfig.funnel.mainPage}),i.createElement("div",{className:a.header},i.createElement("div",{className:a.headOne},"Sorry, wecouldnt find that ",this.props.requestedData),i.createElement("div",{className:a.headSub},i.createElement("span",{className:a.sub},"Wecant get you there from here, but here are some options that might help you get back ontrack:"))),i.createElement("div",{className:a.linkWrapper},i.createElement("span",{className:a.home},"Go to the"," ",i.createElement("a",{"data-name":"linkHomePage",className:a.link,href:this.context.appConfig.funnel.mainPage},"Grammarly Homepage"))),i.createElement("div",{className:a.linkWrapper},i.createElement("span",{className:a.back},"Return to"," ",i.createElement("a",{"data-name":"linkBackPage",className:a.link,onClick:this.back},"Previous Page"))),i.createElement("div",{className:a.linkWrapper},i.createElement("span",{className:a.support},"Contact"," ",i.createElement("a",{"data-name":"linkSupportPage",className:a.link,href:this.context.appConfig.support.mainPage},"Grammarly Support")))))},t}(o.BaseComponent);t.Error404Page=c},1399:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(631),n(1418),n(937);var r=n(210);try{"edge"===r().browser&&(window.fetch=null)}catch(e){}n(394)},1400:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(6),o=n(1404);t.errorSource={client:"client",server:"server"},t.accountType={free:"free",premium:"premium"};var s=function(){function e(e,t){var n=this;this._gnar=e,this._clientName=t,this._eventLogger=i.Monitoring.Logging.getLogger("events.tracking"),this._exceptionLogger=i.Monitoring.Logging.getLogger("exceptions"),this._unhandledLogger=this._exceptionLogger.getLogger("unhandled"),this._tsRoot=i.Monitoring.TimeSeries.root,this.getContainerId=function(){return n._gnar.getContainerId()},this._failedToFetch="Failed to fetch",this._rejections=new Map,i.Monitoring.Logging.root.debug("Starting telemetry"),window.addEventListener("error",this._unhandledError.bind(this)),window.addEventListener("unhandledrejection",this._unhandledRejection.bind(this)),window.addEventListener("rejectionhandled",this._rejectionHandled.bind(this)),document.addEventListener("visibilitychange",this._visibilityChanged.bind(this)),this._visibilityChanged(),window.screen&&i.Monitoring.Logging.getLogger("userStats").info("Screen",{size:window.screen.width+"x"+window.screen.height})}return e.prototype.setUser=function(e,t){i.Monitoring.Logging.root.context.add({user:{id:e}}),this._gnar.setUser(e,t),this._logEvent("setUser"),this._tsRoot.getCounter("userChanged").increment()},e.prototype._track=function(e,t){return void 0===t&&(t={}),this._gnar.track(r.__assign({eventName:this._clientName+"/"+e},t))},e.prototype.documentListOpened=function(){this._logEvent("myGrammarly-page-show"),this._track("myGrammarly-page-show")},e.prototype.deleteDocument=function(e){this._logEvent("deleteDocument-button-click",{docId:e}),this._track("deleteDocument-button-click")},e.prototype.uploadDocument=function(e,t,n){void 0===t&&(t=""),void 0===n&&(n=""),this._logEvent("uploadDocument-form-submit",{isSuccess:e,errorSource:t,errorMessage:n}),this._track("uploadDocument-form-submit",{isSuccess:e,errorSource:t,errorMessage:n})},e.prototype.downloadDocument=function(e){this._logEvent("downloadDocument-button-click",{docId:e}),this._track("downloadDocument-button-click")},e.prototype.copyDocument=function(e){this._logEvent("copyDocument-button-click",{docId:e}),this._track("copyDocument-button-click")},e.prototype.newDocument=function(){this._logEvent("newDocument-button-click"),this._track("newDocument-button-click")},e.prototype.documentShow=function(e){this._logEvent("document-page-show",{docId:e}),this._track("document-page-show"),this._tsRoot.getCounter("documentPageShow").increment()},e.prototype.reportOpened=function(e){this._logEvent("detailedReport-page-show",{score:e}),this._track("detailedReport-page-show")},e.prototype.reportDownload=function(e){this._logEvent("detailedReportDownload-button-click",{score:e}),this._track("detailedReportDownload-button-click")},e.prototype.settingsToggled=function(e,t){this._logEvent("setting-toggle-click",{isEnabled:e,settingName:t}),this._track("setting-toggle-click",{isEnabled:e,settingName:t})},e.prototype.documentGenreSelected=function(e){this._logEvent("documentGenre-button-click",{documentGenre:e}),this._track("documentGenre-button-click",{documentGenre:e})},e.prototype.profileOpened=function(){this._logEvent("profile-page-show"),this._track("profile-page-show")},e.prototype.accountOpened=function(){this._logEvent("account-page-show"),this._track("account-page-show")},e.prototype.supportClicked=function(){this._logEvent("support-link-click"),this._track("support-link-click")},e.prototype.deleteAccountButtonClicked=function(e){this._logEvent("deleteAccount-button-click",{accountType:e}),this._track("deleteAccount-button-click",{accountType:e})},e.prototype.keepAccountButtonClicked=function(e){this._logEvent("keepAccount-button-click",{accountType:e}),this._track("keepAccount-button-click",{accountType:e})},e.prototype.deleteAccountFormSubmit=function(e,t,n,r){void 0===n&&(n=""),void 0===r&&(r=""),this._logEvent("deleteAccount-form-submit",{isSuccess:e,accountType:t,errorSource:n,errorMessage:r}),this._track("deleteAccount-form-submit",{isSuccess:e,accountType:t,errorSource:n,errorMessage:r})},e.prototype.cancelFutureBillingClicked=function(){this._logEvent("cancelFutureBilling-button-click"),this._track("cancelFutureBilling-button-click")},e.prototype.confirmSubscriptionCancelClicked=function(){this._logEvent("confirmSubscriptionCancel-button-click"),this._track("confirmSubscriptionCancel-button-click")},e.prototype.continueUsingGrammarlyClicked=function(){this._logEvent("continueUsingGrammarly-button-click"),this._track("continueUsingGrammarly-button-click")},e.prototype.reactivateSubscriptionClicked=function(){this._logEvent("reactivateSubscription-button-click"),this._track("reactivateSubscription-button-click")},e.prototype.downloadReceiptButtonClicked=function(){this._logEvent("downloadReceipt-form-submit"),this._track("downloadReceipt-form-submit",{isSuccess:!0})},e.prototype.downloadReceiptError=function(e){this._exceptionLogger.error("downloadReceipt-form-error",e),this._track("downloadReceipt-form-submit",{isSuccess:!1,errorSource:t.errorSource.client,errorMessage:e.message})},e.prototype.appsPageShown=function(){this._logEvent("apps-page-show"),this._track("apps-page-show")},e.prototype.installAppClicked=function(e){this._logEvent("installApp-button-click",{app:e}),this._track("installApp-button-click",{app:e})},e.prototype.learnMoreClicked=function(e){this._logEvent("learnMoreAboutApp-button-click",{app:e}),this._track("learnMoreAboutApp-button-click",{app:e})},e.prototype.bannerActionClicked=function(e,t){this._logEvent("bannerMainAction-button-click",{bannerType:e,cta:t}),this._track("bannerMainAction-button-click",{bannerType:e,cta:t})},e.prototype.bannerCloseClicked=function(e){this._logEvent("bannerClose-button-click",{bannerType:e}),this._track("bannerClose-button-click",{bannerType:e})},e.prototype.bannerDismissClicked=function(e){this._logEvent("bannerDismiss-button-click",{bannerType:e}),this._track("bannerDismiss-button-click",{bannerType:e})},e.prototype.bannerLaterClicked=function(e){this._logEvent("bannerRemindLater-button-click",{bannerType:e}),this._track("bannerRemindLater-button-click",{bannerType:e})},e.prototype.bannerNotificationShow=function(e){this._logEvent("banner-notification-show",{bannerType:e}),this._track("banner-notification-show",{bannerType:e})},e.prototype.dictionaryOpened=function(){this._logEvent("dictionary-page-show"),this._track("dictionary-page-show")},e.prototype.addToDictionary=function(e,t,n){void 0===t&&(t=""),void 0===n&&(n=""),this._logEvent("addToDictionary-button-click",{isSuccess:e,errorSource:t,errorMessage:n}),this._track("addToDictionary-button-click")},e.prototype.removeFromDictionary=function(e,t,n){void 0===t&&(t=""),void 0===n&&(n=""),this._logEvent("removeFromDictionary-button-click",{isSuccess:e,errorSource:t,errorMessage:n}),this._track("removeFromDictionary-button-click")},e.prototype.languageOpened=function(){this._logEvent("language-page-show"),this._track("language-page-show")},e.prototype.showTour=function(e){this._logEvent("tour-popup-show",{theme:e}),this._track("tour-popup-show",{theme:e})},e.prototype.closeTour=function(e){this._logEvent("tour-popup-close",{theme:e}),this._track("tour-popup-close",{theme:e})},e.prototype.showTutorial=function(){this._logEvent("tutorial-popup-show"),this._track("tutorial-popup-show")},e.prototype.closeTutorial=function(){this._logEvent("tutorial-popup-close"),this._track("tutorial-popup-close")},e.prototype._getExtraProps=function(e){return e.reason||i.EventProps.fromAny(e)},e.prototype._logUnhandledPromiseRejection=function(e,t,n){var r=this._exceptionLogger.getLogger("unhandled.promiseRejection");("error"===e?r.error:r.warn).bind(r)("Unhandled rejection at promise: "+t,this._getExtraProps(n))},e.prototype._unhandledError=function(e){var t=e.error?e.error.message:e.message,n=o.isExternalException(e),r=n?i.Logging.LogLevel.INFO:i.Logging.LogLevel.ERROR,s=n?"unknownUnhandledError":"unhandledError";this._tsRoot.getCounter(s).increment();var a=e.reason;this._unhandledLogger.log(r,"Unhandled exception at "+e.filename+":"+e.lineno+":"+e.colno+" \n"+t,e.error,a&&{reason:a})},e.prototype._isEventSimulated=function(e){return!1===e.isTrusted},e.prototype._isExternalPromiseRejection=function(e,t){return o.isExternalException(e)||o.isExternalExceptionMessage(t)||this._isEventSimulated(e)},e.prototype._unhandledRejection=function(e){this._rejections.set(e.promise,Date.now());var t=e.reason?e.reason.message:e.message;this._isExternalPromiseRejection(e,t)?this._tsRoot.getCounter("unknownUnhandledPromise").increment():t===this._failedToFetch?this._logUnhandledPromiseRejection(e.reason&&e.reason.isRxFetch?"error":"warn",t,e):(this._logUnhandledPromiseRejection("error",t,e),this._tsRoot.getCounter("unhandledPromise").increment())},e.prototype._rejectionHandled=function(e){var t=this._rejections.get(e.promise);this._rejections.delete(e.promise);var n=e.reason?e.reason.message:e.message;this._exceptionLogger.getLogger("handled.promiseRejection").error("Rejection handled at promise: "+n+" in "+(t?Date.now()-t:NaN)+" ms",e.reason)},e.prototype._visibilityChanged=function(){i.Monitoring.Logging.root.context.add({visibilityState:document.visibilityState})},e.prototype._logEvent=function(e,t){void 0===t&&(t={}),this._eventLogger.info(e,t)},e}();t.EditorTelemetry=s},1401:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.gnar=e}return e.prototype.subscriptionSummaryPageShow=function(e,t){return this.gnar.track({action:"show",eventName:"editor/subscriptionSummary-page-show",object:"page",objectId:"subscriptionSummary",pageId:e,url:t})},e.prototype.deleteAccountButtonClick=function(e,t){return this.gnar.track({action:"click",eventName:"editor/deleteAccount-button-click",object:"button",objectId:"deleteAccount",accountType:e,pageId:t})},e.prototype.professionalProofreadingButtonClick=function(e,t){return this.gnar.track({action:"click",eventName:"editor/professionalProofreading-button-click",isDenali:!0,object:"button",objectId:"professionalProofreading",pageId:e,placements:t})},e.prototype.settingToggleClick=function(e,t,n){return this.gnar.track({action:"click",eventName:"editor/setting-toggle-click",object:"toggle",objectId:"setting",isEnabled:e,pageId:t,settingName:n})},e.prototype.entireDocumentCopy=function(e){return this.gnar.track({action:"copy",eventName:"editor/entire-document-copy",object:"document",objectId:"entire",pageId:e})},e.prototype.performanceScoreButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/performanceScore-button-click",isDenali:!0,object:"button",objectId:"performanceScore",pageId:e})},e.prototype.newDocumentButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/newDocument-button-click",object:"button",objectId:"newDocument",pageId:e})},e.prototype.extensionPopupPageShow=function(e,t){return this.gnar.track({action:"show",eventName:"editor/extensionPopup-page-show",object:"page",objectId:"extensionPopup",pageId:e,url:t})},e.prototype.subscriptionManagePageShow=function(e,t){return this.gnar.track({action:"show",eventName:"editor/subscriptionManage-page-show",object:"page",objectId:"subscriptionManage",pageId:e,url:t})},e.prototype.entireDocumentPaste=function(e){return this.gnar.track({action:"paste",eventName:"editor/entire-document-paste",object:"document",objectId:"entire",pageId:e})},e.prototype.tutorialPopupClose=function(e){return this.gnar.track({action:"close",eventName:"editor/tutorial-popup-close",object:"popup",objectId:"tutorial",pageId:e})},e.prototype.advancedIssuesSidebarShow=function(e,t){return this.gnar.track({action:"show",eventName:"editor/advancedIssues-sidebar-show",isDenali:!0,object:"sidebar",objectId:"advancedIssues",pageId:e,withItemizedIssues:t})},e.prototype.subscriptionCancelDonePageShow=function(e,t){return this.gnar.track({action:"show",eventName:"editor/subscriptionCancelDone-page-show",object:"page",objectId:"subscriptionCancelDone",pageId:e,url:t})},e.prototype.bannerMainActionButtonClick=function(e,t,n){return this.gnar.track({action:"click",eventName:"editor/bannerMainAction-button-click",object:"button",objectId:"bannerMainAction",bannerType:e,cta:t,pageId:n})},e.prototype.referralNotificationShow=function(e,t){return this.gnar.track({action:"show",eventName:"editor/referral-notification-show",object:"notification",objectId:"referral",pageId:e,placement:t})},e.prototype.referralNotificationClose=function(e,t){return this.gnar.track({action:"close",eventName:"editor/referral-notification-close",object:"notification",objectId:"referral",pageId:e,placement:t})},e.prototype.bannerCloseButtonClick=function(e,t){return this.gnar.track({action:"click",eventName:"editor/bannerClose-button-click",object:"button",objectId:"bannerClose",bannerType:e,pageId:t})},e.prototype.documentStatisticsButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/documentStatistics-button-click",isDenali:!0,object:"button",objectId:"documentStatistics",pageId:e})},e.prototype.addToDictionaryButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/addToDictionary-button-click",object:"button",objectId:"addToDictionary",pageId:e})},e.prototype.downloadButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/download-button-click",isDenali:!0,object:"button",objectId:"download",pageId:e})},e.prototype.installAppButtonClick=function(e,t){return this.gnar.track({action:"click",eventName:"editor/installApp-button-click",object:"button",objectId:"installApp",app:e,pageId:t})},e.prototype.deleteDocumentButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/deleteDocument-button-click",object:"button",objectId:"deleteDocument",pageId:e})},e.prototype.keepAccountButtonClick=function(e,t){return this.gnar.track({action:"click",eventName:"editor/keepAccount-button-click",object:"button",objectId:"keepAccount",accountType:e,pageId:t})},e.prototype.editPasswordFormSuccess=function(e){return this.gnar.track({action:"success",eventName:"editor/editPassword-form-success",object:"form",objectId:"editPassword",pageId:e})},e.prototype.deleteAccountFormSuccess=function(e,t){return this.gnar.track({action:"success",eventName:"editor/deleteAccount-form-success",object:"form",objectId:"deleteAccount",accountType:e,pageId:t})},e.prototype.copyToClipboardButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/copyToClipboard-button-click",isDenali:!0,object:"button",objectId:"copyToClipboard",pageId:e})},e.prototype.documentGenreButtonClick=function(e,t){return this.gnar.track({action:"click",eventName:"editor/documentGenre-button-click",object:"button",objectId:"documentGenre",documentGenre:e,pageId:t})},e.prototype.setGoalsButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/setGoals-button-click",isDenali:!0,object:"button",objectId:"setGoals",pageId:e})},e.prototype.downloadDocumentButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/downloadDocument-button-click",object:"button",objectId:"downloadDocument",pageId:e})},e.prototype.editNameButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/editName-button-click",object:"button",objectId:"editName",pageId:e})},e.prototype.notAuthorizedUserSignout=function(e){return this.gnar.track({action:"signout",eventName:"editor/notAuthorized-user-signout",object:"user",objectId:"notAuthorized",pageId:e})},e.prototype.continueUsingGrammarlyButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/continueUsingGrammarly-button-click",object:"button",objectId:"continueUsingGrammarly",pageId:e})},e.prototype.appsPageShow=function(e,t){return this.gnar.track({action:"show",eventName:"editor/apps-page-show",object:"page",objectId:"apps",pageId:e,url:t})},e.prototype.reactivateSubscriptionButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/reactivateSubscription-button-click",object:"button",objectId:"reactivateSubscription",pageId:e})},e.prototype.lensSidebarShow=function(e,t){return this.gnar.track({action:"show",eventName:"editor/lens-sidebar-show",isDenali:!0,object:"sidebar",objectId:"lens",lensName:e,pageId:t})},e.prototype.tourPopupShow=function(e,t){return this.gnar.track({action:"show",eventName:"editor/tour-popup-show",object:"popup",objectId:"tour",pageId:e,theme:t})},e.prototype.tourPopupClose=function(e,t){return this.gnar.track({action:"close",eventName:"editor/tour-popup-close",object:"popup",objectId:"tour",pageId:e,theme:t})},e.prototype.assistantOpenButtonClick=function(e,t){return this.gnar.track({action:"click",eventName:"editor/assistantOpen-button-click",isDenali:!0,object:"button",objectId:"assistantOpen",pageId:e,placement:t})},e.prototype.bannerRemindLaterButtonClick=function(e,t){return this.gnar.track({action:"click",eventName:"editor/bannerRemindLater-button-click",object:"button",objectId:"bannerRemindLater",bannerType:e,pageId:t})},e.prototype.supportLinkClick=function(e,t){return this.gnar.track({action:"click",eventName:"editor/support-link-click",object:"link",objectId:"support",pageId:e,placement:t})},e.prototype.cancelFutureBillingButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/cancelFutureBilling-button-click",object:"button",objectId:"cancelFutureBilling",pageId:e})},e.prototype.dismissAllButtonClick=function(e,t){return this.gnar.track({action:"click",eventName:"editor/dismissAll-button-click",isDenali:!0,object:"button",objectId:"dismissAll",lensName:e,pageId:t})},e.prototype.contactSupportButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/contactSupport-button-click",object:"button",objectId:"contactSupport",pageId:e})},e.prototype.selectLanguageButtonClick=function(e,t){return this.gnar.track({action:"click",eventName:"editor/selectLanguage-button-click",object:"button",objectId:"selectLanguage",language:e,pageId:t})},e.prototype.editPasswordButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/editPassword-button-click",object:"button",objectId:"editPassword",pageId:e})},e.prototype.advancedIssuesButtonClick=function(e,t){return this.gnar.track({action:"click",eventName:"editor/advancedIssues-button-click",isDenali:!0,object:"button",objectId:"advancedIssues",pageId:e,placements:t})},e.prototype.openLensButtonClick=function(e,t){return this.gnar.track({action:"click",eventName:"editor/openLens-button-click",isDenali:!0,object:"button",objectId:"openLens",lensName:e,pageId:t})},e.prototype.bannerDismissButtonClick=function(e,t){return this.gnar.track({action:"click",eventName:"editor/bannerDismiss-button-click",object:"button",objectId:"bannerDismiss",bannerType:e,pageId:t})},e.prototype.documentTypeUpdate=function(e,t){return this.gnar.track({action:"update",eventName:"editor/document-type-update",object:"type",objectId:"document",documentType:e,pageId:t})},e.prototype.tutorialPopupShow=function(e){return this.gnar.track({action:"show",eventName:"editor/tutorial-popup-show",object:"popup",objectId:"tutorial",pageId:e})},e.prototype.downloadReceiptButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/downloadReceipt-button-click",object:"button",objectId:"downloadReceipt",pageId:e})},e.prototype.bannerNotificationShow=function(e,t){return this.gnar.track({action:"show",eventName:"editor/banner-notification-show",object:"notification",objectId:"banner",bannerType:e,pageId:t})},e.prototype.learnMoreAboutAppButtonClick=function(e,t){return this.gnar.track({action:"click",eventName:"editor/learnMoreAboutApp-button-click",object:"button",objectId:"learnMoreAboutApp",app:e,pageId:t})},e.prototype.documentPageShow=function(e,t){return this.gnar.track({action:"show",eventName:"editor/document-page-show",object:"page",objectId:"document",pageId:e,url:t})},e.prototype.assistantSidebarClose=function(e){return this.gnar.track({action:"close",eventName:"editor/assistant-sidebar-close",isDenali:!0,object:"sidebar",objectId:"assistant",pageId:e})},e.prototype.goalsFormSuccess=function(e,t,n,r,i,o){return this.gnar.track({action:"success",eventName:"editor/goals-form-success",isDenali:!0,object:"form",objectId:"goals",pageId:e,audience:t,domain:n,emotion:r,intent:i,style:o})},e.prototype.uploadDocumentFormSuccess=function(e){return this.gnar.track({action:"success",eventName:"editor/uploadDocument-form-success",object:"form",objectId:"uploadDocument",pageId:e})},e.prototype.languageSettingUpdate=function(e,t,n,r){return this.gnar.track({action:"update",eventName:"editor/language-setting-update",object:"setting",objectId:"language",language:e,languageSource:t,pageId:n,isLikeCapi:r})},e.prototype.editEmailFormSuccess=function(e){return this.gnar.track({action:"success",eventName:"editor/editEmail-form-success",object:"form",objectId:"editEmail",pageId:e})},e.prototype.editNameFormFail=function(e,t,n){return this.gnar.track({action:"fail",eventName:"editor/editName-form-fail",object:"form",objectId:"editName",pageId:e,fieldErrors:t,formErrorMessage:n})},e.prototype.printButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/print-button-click",isDenali:!0,object:"button",objectId:"print",pageId:e})},e.prototype.profileLanguagePageShow=function(e,t){return this.gnar.track({action:"show",eventName:"editor/profileLanguage-page-show",object:"page",objectId:"profileLanguage",pageId:e,url:t})},e.prototype.doneEditingButtonClick=function(e,t){return this.gnar.track({action:"click",eventName:"editor/doneEditing-button-click",isDenali:!0,object:"button",objectId:"doneEditing",pageId:e,placement:t})},e.prototype.reportPopupShow=function(e,t){return this.gnar.track({action:"show",eventName:"editor/report-popup-show",object:"popup",objectId:"report",pageId:e,reportScore:t})},e.prototype.removeFromDictionaryButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/removeFromDictionary-button-click",object:"button",objectId:"removeFromDictionary",pageId:e})},e.prototype.confirmSubscriptionCancelButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/confirmSubscriptionCancel-button-click",object:"button",objectId:"confirmSubscriptionCancel",pageId:e})},e.prototype.getPremiumButtonClick=function(e,t){return this.gnar.track({action:"click",eventName:"editor/getPremium-button-click",isDenali:!0,object:"button",objectId:"getPremium",pageId:e,placement:t})},e.prototype.editEmailButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/editEmail-button-click",object:"button",objectId:"editEmail",pageId:e})},e.prototype.uploadDocumentFormFail=function(e,t,n){return this.gnar.track({action:"fail",eventName:"editor/uploadDocument-form-fail",object:"form",objectId:"uploadDocument",pageId:e,fieldErrors:t,formErrorMessage:n})},e.prototype.profileAccountPageShow=function(e,t){return this.gnar.track({action:"show",eventName:"editor/profileAccount-page-show",object:"page",objectId:"profileAccount",pageId:e,url:t})},e.prototype.newTitleButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/newTitle-button-click",isDenali:!0,object:"button",objectId:"newTitle",pageId:e})},e.prototype.editEmailFormFail=function(e,t,n){return this.gnar.track({action:"fail",eventName:"editor/editEmail-form-fail",object:"form",objectId:"editEmail",pageId:e,fieldErrors:t,formErrorMessage:n})},e.prototype.plagiarismButtonClick=function(e,t){return this.gnar.track({action:"click",eventName:"editor/plagiarism-button-click",isDenali:!0,object:"button",objectId:"plagiarism",pageId:e,placements:t})},e.prototype.supportButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/support-button-click",object:"button",objectId:"support",pageId:e})},e.prototype.detailedReportDownloadButtonClick=function(e,t){return this.gnar.track({action:"click",eventName:"editor/detailedReportDownload-button-click",object:"button",objectId:"detailedReportDownload",pageId:e,reportScore:t})},e.prototype.editNameFormSuccess=function(e){return this.gnar.track({action:"success",eventName:"editor/editName-form-success",object:"form",objectId:"editName",pageId:e})},e.prototype.assistantCloseButtonClick=function(e,t){return this.gnar.track({action:"click",eventName:"editor/assistantClose-button-click",isDenali:!0,object:"button",objectId:"assistantClose",pageId:e,placement:t})},e.prototype.detailedReportPageShow=function(e,t){return this.gnar.track({action:"show",eventName:"editor/detailedReport-page-show",object:"page",objectId:"detailedReport",pageId:e,url:t})},e.prototype.assistantSidebarShow=function(e){return this.gnar.track({action:"show",eventName:"editor/assistant-sidebar-show",isDenali:!0,object:"sidebar",objectId:"assistant",pageId:e})},e.prototype.denaliDocumentPageShow=function(e,t){return this.gnar.track({action:"show",eventName:"editor/document-page-show",isDenali:!0,object:"page",objectId:"document",pageId:e,url:t})},e.prototype.newDocumentDenaliButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/newDocument-button-click",isDenali:!0,object:"button",objectId:"newDocument",pageId:e})},e.prototype.profileDictionaryPageShow=function(e,t){return this.gnar.track({action:"show",eventName:"editor/profileDictionary-page-show",object:"page",objectId:"profileDictionary",pageId:e,url:t})},e.prototype.copyDocumentButtonClick=function(e){return this.gnar.track({action:"click",eventName:"editor/copyDocument-button-click",object:"button",objectId:"copyDocument",pageId:e})},e.prototype.deleteAccountFormFail=function(e,t,n,r){return this.gnar.track({action:"fail",eventName:"editor/deleteAccount-form-fail",object:"form",objectId:"deleteAccount",accountType:e,pageId:t,fieldErrors:n,formErrorMessage:r})},e.prototype.editPasswordFormFail=function(e,t,n){return this.gnar.track({action:"fail",eventName:"editor/editPassword-form-fail",object:"form",objectId:"editPassword",pageId:e,fieldErrors:t,formErrorMessage:n})},e.prototype.myGrammarlyPageShow=function(e,t){return this.gnar.track({action:"show",eventName:"editor/myGrammarly-page-show",object:"page",objectId:"myGrammarly",pageId:e,url:t})},e.prototype.subscriptionCancelPageShow=function(e,t){return this.gnar.track({action:"show",eventName:"editor/subscriptionCancel-page-show",object:"page",objectId:"subscriptionCancel",pageId:e,url:t})},e.prototype.documentShow=function(e){return this.gnar.track({action:"show",eventName:"editor/document-show",object:"document",pageId:e})},e.prototype.subscriptionBillingInfoPageShow=function(e,t){return this.gnar.track({action:"show",eventName:"editor/subscriptionBillingInfo-page-show",object:"page",objectId:"subscriptionBillingInfo",pageId:e,url:t})},e}();t.GnarSpec=r},1402:function(e,t,n){"use strict";function r(){try{var e=localStorage.getItem("pageReloadReason");if(!e)return;localStorage.removeItem("pageReloadReason");var t=JSON.parse(e);(function(e,t){return window.location.href===e&&Date.now()-t<_})(t.location,t.timestamp)&&o.Monitoring.Logging.root.info("Page was reloaded",t)}catch(e){}}function i(){var e=o.TimeSeriesImpl.MetricsStorage.createRoot(s.appConfig.env+"."+s.appConfig.app.name,s.appConfig.api.felogUrl,a.RxFetch.nativeFetch.bind(window));o.TimeSeriesImpl.MetricsConfig.configure(e);var t=function(){function e(e){var t=this;this._sink=e,this._counters=new Map;var n=o.Monitoring.TimeSeries.root.getMetric("logging.levels");Object.keys(o.Logging.LogLevel).map(function(e){return o.Logging.LogLevel[e]}).filter(function(e){return"number"==typeof e}).forEach(function(e){return t._counters.set(e,n.getCounter(o.Logging.LogLevel[e]))})}return e.prototype.append=function(e){var t=this._counters.get(e.level);return t&&t.increment(),this._sink.append(e)},e}(),n=function(){function e(e){this._sink=e,this._shortRateReporter={name:"short",indicator:new c.RateLimitIndicator(new c.RateLimiter(30,2e3),1e4),counter:o.Monitoring.TimeSeries.root.getCounter("logRates.short")},this._longRateReporter={name:"long",indicator:new c.RateLimitIndicator(new c.RateLimiter(120,24e4),3e4),counter:o.Monitoring.TimeSeries.root.getCounter("logRates.long")},this._counting=o.Monitoring.TimeSeries.root.getCounter("logRates.either"),this._countingStarted=0,this._droppingLimiter=new c.RateLimiter(2,6e4),this._dropped=0}return e.prototype.append=function(t){var n=this._shortRateReporter.indicator.hit(),r=this._longRateReporter.indicator.hit();if((n.wasTriggered||r.wasTriggered)&&(n.wasTriggered&&n.aboveThreshold&&this._shortRateReporter.counter.increment(),r.wasTriggered&&r.aboveThreshold&&this._longRateReporter.counter.increment(),n.aboveThreshold||r.aboveThreshold?this._counts||(this._counting.increment(),this._counts=new u.LRUCache(50),this._countingStarted=Date.now(),this._sink.append(this._createTriggeredEvent(t,"Logging rate is above threshold",{short:n,long:r})).catch(console.warn)):(this._counts=void 0,this._sink.append(this._createTriggeredEvent(t,"Logging rate is back to normal",{dropped:this._dropped})).catch(console.warn))),this._counts){var i=this._eventToString(t),o=this._counts.set(i,function(e){return(e||0)+1})||0;return o/((Date.now()-this._countingStarted)/1e3)>e.DROP_RATE&&o>e.DROP_COUNT&&!this._droppingLimiter.hit()?(this._drop(),Promise.reject("Log message discarded due to rate limiting: "+t.message)):this._sink.append(t)}return this._sink.append(t)},e.prototype._drop=function(){++this._dropped},e.prototype._createTriggeredEvent=function(e,t,n){return new o.LoggingImpl.LogEvent(o.Logging.LogLevel.ERROR,t,"editor.logging.rate",Date.now(),void 0,n,e.context)},e.prototype._eventToString=function(e){return e.level+e.logger+e.message},e.DROP_RATE=.5,e.DROP_COUNT=15,e}(),i=function(e,t){return void 0===t&&(t=!0),new o.LoggingImpl.PostFelogClient(e,s.appConfig.app.name,s.buildInfo.version,s.appConfig.env,a.RxFetch.request("logs"),t)},_=o.Logging.LogLevel.fromString(s.appConfig.logLevel),y=s.appConfig.collectLogs?new n(new t(new o.LoggingImpl.LogQueue(i(s.appConfig.api.felogUrl+"/log"),g,m))):{append:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Promise.resolve()}},v=s.appConfig.collectCrashLogs?i(s.appConfig.api.felogUrl+"/crash",!1):void 0,b=function(e){return console.error("Error sending logs",e)},w=o.Logging.LogLevel.fromString(s.appConfig.crashLogLevel),E=s.appConfig.app.name,C=function(e){e.level>=_&&(s.appConfig.copyLogsToConsole&&d.ConsoleLogger.printToConsole(e),y.append(e).catch(b))},S=new d.TreeContext,x=C;if(v){var T=new d.SimpleLogger(E+".crashLogs",w,function(e){return v.append(e).catch(b)},new d.TreeContext(S)),k=new h.CrashLogWrapper(100,o.Logging.LogLevel.ERROR,C,T);x=k.sink,l.registerDebugHelper("printLogs",function(){k.logs.forEach(d.ConsoleLogger.printToConsole)})}var A=new d.SimpleLogger(E,Math.min(_,w),x,S);o.LoggingImpl.LoggingConfig.configure(A);var I=l.StringUtils.alphanumeric(f),O=p.getBrowserInfo(),D=O.browser,P=O.os,N=O.version,R=O.type,M={browser:D,os:P,version:String(N),type:R,raw:navigator.userAgent};o.Monitoring.Logging.root.context.add({userAgent:M,sessionId:I}),o.Monitoring.TimeSeries.root.getCounter("sessions").increment(),r(),o.Monitoring.Logging.root.info("Application starting. HTTP referrer: "+document.referrer),l.registerDebugHelper("kibana",function(){var e=encodeURIComponent("http://kibana.grammarly.io/app/kibana#/discover?_g=(refreshInterval:(display:Off,pause:!f,value:0),time:(from:now-30m,mode:quick,to:now))&_a=(columns:!(_source),filters:!(('$state':(store:appState),meta:(alias:!n,disabled:!f,index:'f-log-editor-*',key:context.sessionId,negate:!f,value:'"+I+"'),query:(match:(context.sessionId:(query:'"+I+"',type:phrase))))),index:'f-log-editor-*',interval:auto,query:(query_string:(analyze_wildcard:!t,lowercase_expanded_terms:!f,query:'*')),sort:!('@timestamp',desc))");fetch("https://private.gram.ly/shorten?url="+e).then(function(e){return e.text()}).then(function(e){return o.Monitoring.Logging.root.info("Kibana URL for this session: ",e)})})}Object.defineProperty(t,"__esModule",{value:!0});var o=n(6),s=n(80),a=n(196),c=n(1417),u=n(313),l=n(5),d=n(328),h=n(326),p=n(38),f=14,g=100,m=1e4,_=3e5;t.initializeMonitoring=i},1403:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=function(){function e(e,t,n){this._profile=e,this._subscription=t,this._gaClient=n,this._log=r.Monitoring.Logging.getLogger("pixels"),this._counter=r.Monitoring.TimeSeries.root.getCounter("pixels")}return e.doTracking=function(t,n,r,i){n&&n.isPremiumConversion&&new e(t,n,i)._doTracking(r)},e.prototype._doTracking=function(e){var t=this;this._log.info("Forcing premium conversion tracking"),this._counter.increment(),e.ackPremiumConversion().then(function(){t._try(function(){return t._googleAdwordsPixel()},"googleAdwordsPixel"),t._try(function(){return t._universalTracking()},"universalTracking")}).catch(function(e){return t._log.error("ackPremiumConversion failed",e)})},e.prototype._try=function(e,t){try{e()}catch(e){this._log.error("Error while calling tracking pixel "+t,e)}},e.prototype._googleAdwordsPixel=function(){var e,t=this._subscription.currentPlan.periodMonths;switch(t){case 1:e="DWnkCMbLrwkQ4ozj9gM";break;case 3:e="lqBBCL7MrwkQ4ozj9gM";break;case 12:e="w4TvCLbNrwkQ4ozj9gM";break;default:e="-eBYCKTnylgQ4ozj9gM",this._log.error("Unexpected periodMonths "+t)}new Image(1,1).src="https://www.googleadservices.com/pagead/conversion/1054393954/?label="+e+"&guid=ON&script=0"},e.prototype._universalTracking=function(){var e=this._subscription.currentPlan;this._gaClient.ga("require","displayfeatures"),this._gaClient.ga("require","ecommerce"),this._gaClient.ga("send","pageview","/thankyou"),this._gaClient.ga("ecommerce:addTransaction",{id:this._profile.email,affiliation:"",revenue:e.price+"",shipping:"",tax:""}),this._gaClient.ga("ecommerce:addItem",{id:this._profile.email,sku:e.periodMonths+"M",name:e.title+"",category:"Grammarly Subscription",price:e.price+"",quantity:"1"}),this._gaClient.ga("ecommerce:send")},e}();t.PixelTracking=i},1404:function(e,t,n){"use strict";function r(e){return/Unhandled exception at https?:\/\//.test(e)&&!/grammarly|cloudfront/.test(e)}function i(e){return u.test(e)}function o(e){return r(e)||c.test(e)}function s(e){var t=e.reason||e.error,n=t&&t.stack;if(n&&-1!==n.indexOf("denali"))return!1;if(!e.filename||/^javascript:/.test(e.filename))return!0;if(n&&i(n))return!0;try{return o((t?t.message:e.message)||JSON.stringify(t||a.EventProps.fromAny(e)))}catch(e){return!1}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(6),c=new RegExp(["^(Script error.?|Javascript error: Script error.? on line 0)$","(.*__gCrWeb.autofill.extractForms'\\))","(.*safari-extension.*)|(.*chrome-extension.*)|(.*moz-extension.*)",'Permission denied to access property "'].join("|"),"m"),u=new RegExp(["(.*safari-extension.*)|(.*chrome-extension.*)|(.*moz-extension.*)","<anonymous>"].join("|"),"m");t.containsExternalUrl=r,t.isExternalExceptionStack=i,t.isExternalExceptionMessage=o,t.isExternalException=s},1405:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=n(8),o=n(5),s="wootric-modal",a="wootric-text";!function(e){function t(e){return e&&e.id===a}e.isWootricTextArea=t;var n=function(){function e(e,t,n){var o=this;this._ls=e,this._isWootricTest=t,this._experimentGroup=n,this._log=r.Monitoring.Logging.getLogger("external.wootric"),this._isLoaded=this._isEnabled(),this._runOnLoad=!1,this._containerObserver=new MutationObserver(function(e){e.forEach(function(e){Array.from(e.addedNodes).forEach(function(e){if(e&&e.id===s){o.height.set(0);var t=document.getElementById(s);t&&o._surveyObserver.observe(t,{subtree:!0,attributes:!0,attributeFilter:["style","class"]})}})})}),this._surveyObserver=new MutationObserver(function(e){var t=document.getElementById(s);if(t)if(t.classList.contains("show")){var n=t.getBoundingClientRect();o.height.set(n.height)}else o.height.set(0)}),this.height=i.Atom.create(0)}return e.prototype._isEnabled=function(){return void 0!==window.wootric&&void 0!==window.WootricSurvey},e.prototype.load=function(e,t){var n=this;if(this._containerObserver.observe(document.body,{childList:!0}),this._isEnabled())this._isLoaded=!0;else{this._log.info("Loading Wootric snippet..");var r=document.createElement("script");r.type="text/javascript",r.async=!0;var i={email:e,created_at:Math.floor(t.getOrElse(new Date).getTime()/1e3),modal_footprint:"compact",account_token:"NPS-a6a6ec54",properties:{group:this._experimentGroup}};r.innerHTML="\n        "+(this._isWootricTest?"wootric_survey_immediately = true;":"")+"\n        window.wootricSettings = "+JSON.stringify(i)+";\n        ",document.body.appendChild(r);var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src="https://disutgh7q0ncc.cloudfront.net/beacon.js",o.onload=function(){n._isLoaded=!0,n._runOnLoad&&(n._runOnLoad=!1,n.takeSurvey())},document.body.appendChild(o)}},e.prototype.getAppliedCount=function(){try{var e=this._ls.getItem("wootric_applied_alerts"),t=e?JSON.parse(e):0;return t&&"number"==typeof t?t:0}catch(e){return this._log.warn("Can't get applied alerts count",e),0}},e.prototype.updateAppliedCount=function(e){try{var t=this.getAppliedCount();this._ls.setItem("wootric_applied_alerts",e(t).toString())}catch(e){this._log.warn("Can't set applied alerts count",e)}},e.prototype.takeSurvey=function(){if(this._isLoaded){this._log.info("Wootric run called"),o.invariant(this._isEnabled(),"Wootric snippet should be loaded");try{window.wootric("run")}catch(e){this._log.warn("Can't run survey",e)}}else this._log.info("Wootric run called. Waiting for beacon onload..."),this._runOnLoad=!0},e.prototype.dispose=function(){if(this._isEnabled())try{window.WootricSurvey.stop()}catch(e){this._log.warn("Can't stop survey",e)}var e=document.getElementById(s);e&&e.remove(),this.height.set(0),this._containerObserver.disconnect(),this._surveyObserver.disconnect()},e}();e.WootricListenerModelImpl=n;var c=function(){function e(e,t,n){void 0===n&&(n=5),this._wootricListenerImpl=e,this._appliedAlertsCount=t,this._appliedAlertsLimit=n,this._subs=[],this.height=this._wootricListenerImpl.height}return e.prototype._takeSurvey=function(e){return this._wootricListenerImpl.getAppliedCount()>=this._appliedAlertsLimit&&(e&&this._wootricListenerImpl.takeSurvey(),!0)},e.prototype.init=function(e,t){var n=this;this._wootricListenerImpl.load(e,t),this._takeSurvey(!0)||this._subs.push(this._appliedAlertsCount.take(this._appliedAlertsLimit).subscribe(function(e){n._wootricListenerImpl.updateAppliedCount(function(e){return e+1}),n._takeSurvey(!1)&&(n._subs.forEach(function(e){return e.unsubscribe()}),n._subs=[])}))},e.prototype.dispose=function(){this._subs.forEach(function(e){return e.unsubscribe()}),this._wootricListenerImpl.dispose()},e}();e.WootricViewModelImpl=c}(t.Wootric||(t.Wootric={}))},1406:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(22);!function(e){function t(t,i,o){return r.Observable.merge(n(t,i,o).takeUntil(e.hiddenObservable),e.hiddenObservable.mapTo(i).first())}function n(e,t,n){return r.Observable.create(function(r){function i(a){o||(o=a);var c=a-o;c<n?(r.next(Math.round(e+c/n*(t-e))),s=window.requestAnimationFrame(i)):(r.next(t),r.complete())}var o,s=window.requestAnimationFrame(i);return function(){return window.cancelAnimationFrame(s)}}).distinctUntilChanged()}function i(e){var t=new r.Subject;return{state:e.switchMap(function(e){return e?r.Observable.of("inProgress"):r.Observable.merge(r.Observable.of("fadeOut"),t.mapTo("end"))}),complete:function(){return t.next(!0)}}}function o(e){return r.Observable.create(function(t){var n=requestAnimationFrame(function(){return t.next(e)});return function(){return cancelAnimationFrame(n)}})}function s(e,t){return void 0===t&&(t=!1),r.Observable.create(function(n){function r(){n.next(e.shift()),e.length&&(i=requestAnimationFrame(r))}var i;return t?r():i=requestAnimationFrame(r),function(){return cancelAnimationFrame(i)}})}e.hiddenObservable=r.Observable.fromEvent(document,"visibilitychange").map(function(){return document.hidden}).startWith(document.hidden).filter(Boolean).repeat(1),e.createAnimationObservable=t,e.fadeOutState=i,e.rafScheduler=o,e.rafSequence=s}(t.Animation||(t.Animation={}))},1407:function(e,t,n){"use strict";function r(e,t){return e.reduce(function(e,n){return t(n)?e[0].push(n):e[1].push(n),e},[[],[]])}function i(e,t,n){if(n>=e.length||t>=e.length)return e;for(var r=new Set,i=Math.floor(t+n>t?Math.random()*(n-t)+1:0);r.size<i;){var o=Math.floor(Math.random()*e.length);r.add(o)}return Array.from(r).map(function(t){return e[t]})}function o(e){for(var t=e.slice(0),n=t.length;n>0;){var r=Math.floor(Math.random()*n);n--,i=[t[r],t[n]],t[n]=i[0],t[r]=i[1]}return t;var i}function s(e,t){for(var n=-1,r=e.length;n+1!==r;){var i=n+(r-n>>1);t(e[i])?n=i:r=i}return n+1}function a(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.sort(function(e,n){return t.reduce(function(t,r){return 0!==t?t:r(e,n)},0)})}function c(e,t,n){for(var r=t;r<e.length;++r)if(n(e[r]))return f.Some({index:r,value:e[r]});return f.None}function u(e,t,n){for(var r=t;r>=0;--r)if(n(e[r]))return f.Some({index:r,value:e[r]});return f.None}function l(e,t,n){return t<0||e.length<=t?f.None:c(e,t+1,n).orElseL(function(){return u(e,t-1,n)})}function d(e,t){for(var n,r=0;r<e.length;++r)!function(r){var i=t.findIndex(function(t){return e[r].equals(t)});-1!==i&&(e.splice(r--,1),t.splice(i,1)),n=r}(r),r=n;return e}function h(e){return e.reduce(function(e,t){return e.concat(t)},[])}function p(e,t){return new Array(e).fill(!0).map(function(e,n){return t(n)})}Object.defineProperty(t,"__esModule",{value:!0});var f=n(18);t.partition=r,t.pickRandom=i,t.shuffle=o,t.lowerBound=s,t.sort=a,t.findIndexFrom=c,t.findLastIndexFrom=u,t.lookAround=l,t.arraySubstract=d,t.flatMap=h,t.mapNTimes=p},1408:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(22),o=n(198),s=n(100);!function(e){function t(){return{status:C.idle}}function n(e){return{status:C.ok,value:e}}function a(e){return e.status===C.idle}function c(e){return e.status===C.inProgress}function u(e){return e.status===C.ok}function l(e){return e.status===C.error}function d(e){return e.status===C.fatal}function h(e){return u(e)||d(e)}function p(e){return h(e)||l(e)}function f(e,t){return u(e)?t(e.value):e}function g(e,t){return u(e)?n(t(e.value)):e}function m(e){return o.invariant(!c(e),"Can't enter begin state - unexpected status '"+C[e.status]+"'"),{status:C.inProgress}}function _(e,t){return function(n){o.invariant(!h(n),"Can't enter error state - unexpected status '"+C[n.status]+"'");var r=C.error;return t?{status:r,error:e,attempt:t}:{status:r,error:e}}}function y(e){return function(t){return o.invariant(l(t)||c(t),"Can't enter fatal state - unexpected status '"+C[t.status]+"'"),{status:C.fatal,error:e}}}function v(e){return function(t){return o.invariant(!u(t),"Can't enter ok state - unexpected status '"+C[t.status]+"'"),n(e)}}function b(t,n,r,o){return void 0===r&&(r=e.DEFAULT_TIMEOUT_MS),void 0===o&&(o=function(e){return e}),new Promise(function(e,s){n.modify(m);var a=!1;i.Observable.defer(t).last().timeout(r).subscribe(function(t){n.modify(v(o(t))),a=!0,e(t)},function(e){n.modify(_(e)),a=!0,s(e)},function(){if(!a){var e=void 0;n.modify(function(t){return t.status!==C.ok&&t.status!==C.error?_(e=new S)(t):t}),e&&s(e)}})})}function w(e,t,n){var r=e.get();return n().then(function(n){return new Promise(function(n){e.modify(t),n()})}).catch(function(t){return e.set(r),Promise.reject(t)})}function E(e,t,n,r){void 0===r&&(r=!0);var i=e.get();return e.modify(t),n().catch(function(t){return r&&e.set(i),Promise.reject(t)})}var C;!function(e){e[e.idle=0]="idle",e[e.inProgress=1]="inProgress",e[e.ok=2]="ok",e[e.error=3]="error",e[e.fatal=4]="fatal"}(C=e.Status||(e.Status={})),e.defaultValue=t,e.ok=n,e.isIdle=a,e.isInProgress=c,e.isOk=u,e.isError=l,e.isFatal=d,e.isTerminated=h,e.isSomething=p,e.flatMap=f,e.map=g,e.begin=m,e.error=_,e.fatal=y,e.success=v,e.DEFAULT_TIMEOUT_MS=1e4;var S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t}(o.CustomError);e.NoValueReturnedError=S,e.runWithTimeout=b,e.promiseWithTimeout=function(e,t){return i.Observable.from(e).timeout(t).toPromise()},e.modifyRemoteState=w,e.modifyRemoteStateOptimistic=E;!function(t){function n(t,n,a){void 0===a&&(a=r.noRetry);var c=0;n.modify(m);var u=i.Observable.defer(t).catch(function(e){throw n.modify(_(e,++c)),e}).retryWhen(a).catch(function(e){return n.modify(y(e)),i.Observable.never()}).map(v).do(n.modify.bind(n)).first().subscribe(s.noop);return{unsubscribe:function(){e.isTerminated(n.get())||(o.invariant(!u.closed,"cannot abort completed operation"),u.unsubscribe())}}}var r;!function(e){e.noRetry=function(e){return e.switchMap(function(e){return i.Observable.throw(e)}).first()},e.linear=function(e,t){return void 0===t&&(t=1e3),function(n){return n.switchMap(function(n,r){if(r>=e)throw n;return i.Observable.timer(r*t)})}},e.conditional=function(e,t){return function(n){return i.Observable.merge(t(n.takeWhile(e)),n.skipWhile(e).map(function(e){throw e}))}}}(r=t.RetryStrategy||(t.RetryStrategy={})),t.create=n}(e.OperationRetrier||(e.OperationRetrier={}))}(t.Async||(t.Async={}))},1409:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(22),i=n(8),o=n(38);r.Observable.fromEvent(window,"click").first().subscribe(function(){document.queryCommandSupported("copy")||s.copyApiAvailable.set(!1)});var s=function(){function e(){}return e.copy=function(e){this._clearSelection();var t=this._createHiddenSpan(e);return this.select(t),this._copy(e).then(function(){t.parentElement.removeChild(t)}).catch(function(e){throw t.parentElement.removeChild(t),e})},e.select=function(e){if(window.getSelection&&document.createRange){var t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}else if("selection"in document&&"createTextRange"in document.body){var n=document.body.createTextRange();n.moveToElementText(this),n.select()}},e._clearSelection=function(){var e=window.getSelection?window.getSelection():document.selection;"removeAllRanges"in e?e.removeAllRanges():"empty"in e&&e.empty()},e._createHiddenSpan=function(e){var t=document.createElement("span");return t.setAttribute("style",["all: unset","position: fixed","top -999px","left -999px","opacity: 0","background transparent","white-space: pre","-webkit-user-select: text","-moz-user-select: text","-ms-user-select: text","user-select: text"].join(";")),t.textContent=e,document.body.appendChild(t),t},e._copy=function(e){var t=this;return new Promise(function(n,r){try{("msie"===t._browser?window.clipboardData.setData("text",e):document.execCommand("copy"))?n():r(new Error("Copy API doesn't work"))}catch(e){r(e)}})},e._browser=o.getBrowserInfo().browser,e.copyApiAvailable=i.Atom.create(!0),e}();t.Clipboard=s},1410:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2),o=n(8),s=n(197);!function(e){e[e.IDLE=0]="IDLE",e[e.CONNECTING=1]="CONNECTING",e[e.CONNECTED=2]="CONNECTED",e[e.TERMINATING=3]="TERMINATING"}(r||(r={}));var a;!function(e){e[e.CONNECT=0]="CONNECT",e[e.CONNECTED=1]="CONNECTED",e[e.TERMINATE=2]="TERMINATE",e[e.TERMINATED=3]="TERMINATED"}(a||(a={}));var c=function(){function e(e,t,n){void 0===n&&(n=o.Atom.create(null));var c=this;this._connector=e,this._terminator=t,this._currentConnection=n,this._create=function(){return i.__awaiter(c,void 0,void 0,function(){var e,t,n;return i.__generator(this,function(r){switch(r.label){case 0:return e=this._connectionParams,[4,this._connector(e)];case 1:return t=r.sent(),n=e===this._connectionParams,n?[4,this._fsm.event(a.CONNECTED,t)]:[3,3];case 2:n=r.sent(),r.label=3;case 3:return n?(this._currentConnection.set(t),[3,6]):[3,4];case 4:return[4,this._terminator(t)];case 5:r.sent(),r.label=6;case 6:return[2]}})})},this._remove=function(){return i.__awaiter(c,void 0,void 0,function(){var e;return i.__generator(this,function(t){switch(t.label){case 0:return e=this._currentConnection.get(),this._currentConnection.set(null),[4,this._terminator(e)];case 1:return t.sent(),[4,this._fsm.event(a.TERMINATED,"removed")];case 2:return t.sent(),[2]}})})},this._processQueue=function(){return c._connectionParams?c._fsm.event(a.CONNECT,c._connectionParams):Promise.resolve(!0)},this._fsm=new s.StateMachine(r.IDLE).from(r.CONNECTED).to(r.TERMINATING).on(a.CONNECT,a.TERMINATE).from(r.IDLE,r.CONNECTING,r.TERMINATING).to(r.CONNECTING).on(a.CONNECT).from(r.CONNECTING).to(r.CONNECTED).on(a.CONNECTED).from(r.TERMINATING).to(r.IDLE).on(a.TERMINATED).on(r.CONNECTING,this._create).on(r.TERMINATING,this._remove).on(r.IDLE,this._processQueue)}return e.prototype.connect=function(e){return void 0===e&&(e="connection"),i.__awaiter(this,void 0,void 0,function(){var t;return i.__generator(this,function(n){switch(n.label){case 0:return(t=e===this._connectionParams&&this._fsm.is(r.CONNECTED,r.CONNECTING))?[3,2]:(this._connectionParams=e,[4,this._fsm.event(a.CONNECT,e)]);case 1:n.sent(),n.label=2;case 2:return[2]}})})},e.prototype.terminate=function(){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(e){switch(e.label){case 0:return this._connectionParams=null,[4,this._fsm.event(a.TERMINATE)];case 1:return e.sent(),[2]}})})},e}();t.ConnectionManager=c},1411:function(e,t,n){"use strict";function r(e){return s.default(e)}function i(e,t,n){s.default(e,t,n)}function o(){var e=new Date(Date.now()+36e5);i("grInstallSource","editor",{domain:a.appConfig.domains.cookie,path:"/",expires:e})}Object.defineProperty(t,"__esModule",{value:!0});var s=n(315),a=n(80);t.getCookie=r,t.setCookie=i,t.setInstallSourceCookie=o},1412:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readabilityDemoText={title:"Readability prototype demo text",text:'ignaling they defeated the wolf Dana falls to the ground from using a lot of her magic engery on the fight as gray runs over to her and picks her up carrying her back to the hotle they were staying at as the rest of them follow\n  "we will head back to the guild tommorrow" erza the red head says as they all go into there seprate rooms in the hotle as night falls they all fall asleep few hours later the sun rises adn they head back to the guild will gray carrying an unconses Lana in his arms as they run back looking for wendy to see if she could tell whats wrong with Lana as they found her they rush her into one of the inferany rooms and wendy starts to heal her but cant\n  "she just used to much of her magic engery she just needs to rest for a few days she will be fine" the young blue haired girl says to the group as they all sit around the infermity bed waiting for Misty to wake up.\n\n  Amplification of ribosomal genes has been observed in other species.\n  "Shadowy Weapon" as a shadow  apears above the wolf and hits it with a weapons making the wolf fall to the ground with a loud thump signaling they defeated the wolf Dana falls to the ground from using a lot of her magic engery on the fight as gray runs over to her and picks her up carrying her back to the hotle they were staying at as the rest of them follow\n  "we will head back to the guild tommorrow" erza the red head says as they all go into there seprate rooms in the hotle as night falls they all fall asleep few hours later the sun rises adn they head back to the guild will gray carrying an unconses Lana in his arms as they run back looking for wendy to see if she could tell whats wrong with Lana as they found her they rush her into one of the inferany rooms and wendy starts to heal her but cant\n  "she just used to much of her magic engery she just needs to rest for a few days she will be fine" the young blue haired girl says to the group as they all sit around the infermity bed waiting for Misty to wake up.\n\n  Amplification of ribosomal genes has been observed in other species.'}},1413:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(930);!function(e){function t(e,t,n){var i=window.Grammarly,o=i&&i.desktopEditor;if(o&&o.openUpgradePage){var s=r(n),a=e.substring(e.indexOf("?")+1),c=t.api.redirect+"?upgrade=1&hash="+s+"&"+a;return o.openUpgradePage(c)}return!1}e.openUpgradeUrl=t}(t.actions||(t.actions={}))},1414:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){function t(e){return{kind:"left",value:e}}function n(e){return{kind:"right",value:e}}function r(e){return"left"===e.kind}function i(e){return"right"===e.kind}function o(e,t){return r(e)?e:t(e.value)}function s(t){return t.then(function(t){return e.right(t)}).catch(function(t){return e.left(t)})}e.left=t,e.right=n,e.isLeft=r,e.isRight=i,e.flatMap=o,e.fromPromise=s}(t.Either||(t.Either={}))},1415:function(e,t,n){"use strict";function r(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return 0===e.length?o.Properties.of(t.ls):o.Properties.of.apply(o.Properties,e.map(function(e){return n={},n[e]=t.ls.getItem(e),n;var n}))}function i(e){for(var n=0,r=e.entries();n<r.length;n++){var i=r[n],o=i[0],a=i[1];try{var c=a.getStr();c&&t.ls.setItem(o,c)}catch(e){return void s.Monitoring.Logging.getLogger("model.settings.localStorage").warn("Cannot save data to local storage",e)}}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(547),s=n(6),a=n(100),c=n(18);t.ls=window.localStorage||Object.create({getItem:function(e){return null},setItem:function(e,t){return a.noop},removeItem:function(e){return null}}),t.readProperties=r,t.writeProperties=i;!function(e){function t(e){return{getItem:function(t){return c.Option.of(e.getItem(t))},setItem:function(t,n){return e.setItem(t,n)},safeRemoveItem:function(t){try{e.removeItem(t)}catch(e){}},getKeys:function(){return Object.keys(e)},removeItem:function(t){return e.removeItem(t)}}}e.fromLocalStorage=t}(t.DenaliStorage||(t.DenaliStorage={}))},1416:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(18),i=n(100);!function(e){function t(e){return r.Option.of(e).filter(i.notEmpty)}function n(e){return r.Option.of(e).map(function(e){return e.filter(Boolean)}).filter(i.notEmpty)}e.string=t,e.array=n}(t.NotEmpty||(t.NotEmpty={}))},1417:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(198),i=function(){function e(e,t){if(this.messageCount=e,this.timeframe=t,e<1)throw new r.IllegalArgumentError("messagesCount should be > 1");if(t<=0)throw new r.IllegalArgumentError("timeframe should be > 0");this._allowance=e,this._lastChecked=Date.now()}return e.prototype.hit=function(){var e=Date.now(),t=e-this._lastChecked;return this._lastChecked=e,this._allowance+=t*(this.messageCount/this.timeframe),this._allowance>this.messageCount&&(this._allowance=this.messageCount),!(this._allowance<1)&&(this._allowance-=1,!0)},e.prototype.toString=function(){return"[ messageCount: "+this.messageCount+", timeframe: "+this.timeframe+", allowance: "+Math.trunc(1e3*this._allowance)/1e3+", _lastCheck: "+this._lastChecked+"]"},e}();t.RateLimiter=i;var o=function(){function e(e,t){if(this._limiter=e,this._cooldownTime=t,this._lastLimiting=0,this._aboveThreshold=!1,t<0)throw new r.IllegalArgumentError("cooldownTime should be non-negative")}return e.prototype.hit=function(){var e=this._limiter.hit(),t=!1;return e?this._aboveThreshold&&Date.now()-this._cooldownTime>this._lastLimiting&&(this._aboveThreshold=!1,t=!0):(this._lastLimiting=Date.now(),this._aboveThreshold||(this._aboveThreshold=!0,t=!0)),{allow:e,aboveThreshold:this._aboveThreshold,wasTriggered:t}},e}();t.RateLimitIndicator=o},1423:function(e,t){e.exports={}},1424:function(e,t){e.exports={countdown:"_6e8ae1-countdown",gutter:"_6e8ae1-gutter",bar:"_6e8ae1-bar"}},1425:function(e,t){e.exports={clearfix:"_568abf-clearfix",proofreading:"_568abf-proofreading",gutter:"_568abf-gutter",pgs:"_568abf-pgs",pgsPlaceholder:"_568abf-pgsPlaceholder",proofitCompleted:"_568abf-proofitCompleted",proofitCancelled:"_568abf-proofitCancelled"}},1426:function(e,t){e.exports={clearfix:"_3e896f-clearfix",header:"_3e896f-header",headOne:"_3e896f-headOne",headSub:"_3e896f-headSub",sub:"_3e896f-sub",link:"_3e896f-link",logoWrapper:"_3e896f-logoWrapper",logo:"_3e896f-logo"}},1427:function(e,t){e.exports={clearfix:"_e36e5b-clearfix",header:"_e36e5b-header",headOne:"_e36e5b-headOne",headSub:"_e36e5b-headSub",sub:"_e36e5b-sub",link:"_e36e5b-link",logoWrapper:"_e36e5b-logoWrapper",logo:"_e36e5b-logo",linkWrapper:"_e36e5b-linkWrapper",back:"_e36e5b-back",home:"_e36e5b-home",support:"_e36e5b-support"}},1428:function(e,t){e.exports={clearfix:"_fda1ec-clearfix",header:"_fda1ec-header",headOne:"_fda1ec-headOne",headSub:"_fda1ec-headSub",sub:"_fda1ec-sub",link:"_fda1ec-link",logoWrapper:"_fda1ec-logoWrapper",logo:"_fda1ec-logo",robot:"_fda1ec-robot",contact:"_fda1ec-contact",smallText:"_fda1ec-smallText"}},1429:function(e,t){},1430:function(e,t){},1431:function(e,t,n){n(563),e.exports=n(564)},148:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2),o=n(197),s=n(607),a=n(43),c=n(6);!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.CONNECTED=1]="CONNECTED",e[e.DISCONNECTED=2]="DISCONNECTED",e[e.CLOSED=3]="CLOSED",e[e.ANY=4]="ANY"}(r=t.States||(t.States={}));var u;!function(e){e[e.CONNECT=0]="CONNECT",e[e.CONNECTED=1]="CONNECTED",e[e.DISCONNECT=2]="DISCONNECT",e[e.SEND=3]="SEND",e[e.CLOSE=4]="CLOSE"}(u=t.Events||(t.Events={})),t.errPrintln=function(e){c.Monitoring.Logging.getLogger("coreclients.errPrintln").error("WebSocket Error",e)},t.logPrintln=function(e){c.Monitoring.Logging.root.isEnabled(c.Logging.LogLevel.TRACE)&&c.Monitoring.Logging.getLogger("coreclients.errPrintln").trace("WebSocket:",{message:e})},t.ignore=function(e){};var l=function(){function e(){var e=this;this._log=c.Monitoring.Logging.getLogger("coreclients.ws"),this._maxDelay=6e4,this._delay=1e3,this._idleTimeout=-1,this._ondisconnect=t.logPrintln,this._onerror=t.errPrintln,this._onmessage=function(t,n){e._log.warn("Default message handler used <<< ",{message:n})},this._read=function(e){try{var t=JSON.parse(e);if(t&&"object"==typeof t&&null!==t)return t}catch(e){}return e},this._write=function(e){return"string"==typeof e?e:JSON.stringify(e)}}return e.create=function(){return new e},e.prototype.setMaxReconnectDelay=function(e){return this._maxDelay=e,this},e.prototype.setInitialReconnectDelay=function(e){return this._delay=e,this},e.prototype.idle=function(e){return void 0===e&&(e=3e5),this._idleTimeout=e,this},e.prototype.writer=function(e){return this._write=e,this},e.prototype.reader=function(e){return this._read=e,this},e.prototype.onDisconnect=function(e){return this._ondisconnect=e,this},e.prototype.onMessage=function(e){return this._onmessage=e,this},e.prototype.onError=function(e){return this._onerror=e,this},e.prototype.connect=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,n,s=this;return i.__generator(this,function(i){return t=new o.StateMachine(r.DISCONNECTED,r.CLOSED).with(r.ANY).parentOf(r.CLOSED,r.CONNECTED,r.CONNECTING,r.DISCONNECTED).from(r.CONNECTING).to(r.CONNECTED).on(u.CONNECTED).from(r.CONNECTED,r.CONNECTING).to(r.DISCONNECTED).on(u.DISCONNECT).from(r.DISCONNECTED).to(r.CONNECTING).on(u.CONNECT).from(r.ANY).to(r.CLOSED).on(u.CLOSE).from(r.CONNECTED).to(r.CONNECTED).on(u.SEND).on(r.DISCONNECTED,function(e){return s._ondisconnect(e.args)}),n=new h(this._maxDelay,this._delay),n.initReconnect(e,function(e){return s._createWebSocket(e,t,n)}),[2,this._createWebSocket(e,t,n)]})})},e.prototype._createWebSocket=function(e,t,n){return i.__awaiter(this,void 0,void 0,function(){var o=this;return i.__generator(this,function(a){return[2,new Promise(function(a,c){return i.__awaiter(o,void 0,void 0,function(){var o,l,h=this;return i.__generator(this,function(g){switch(g.label){case 0:return[4,t.event(u.CONNECT)];case 1:return(o=g.sent())?(this._log.debug("Connecting to "+e),l=new s.w3cwebsocket(e),l.onopen=function(e){return i.__awaiter(h,void 0,void 0,function(){var e,o,s=this;return i.__generator(this,function(i){switch(i.label){case 0:return[4,t.event(u.CONNECTED)];case 1:return(e=i.sent())?(o=new d(l,t,this._write),l.onmessage=function(e){n.reset(),s._onmessage(o,s._read(e.data))},a(o),[2]):(c(new Error("WebSocket [ERROR] FSM cannot be switched to CONNECTED state from "+r[t.current])),l.close(4e3,"WebSocket lib initialized"),[2])}})})},l.onclose=function(i){h._log.debug("Connection to "+e+" closed",{code:i.code,reason:i.reason,fsmState:r[t.current]});var o=new f({status:i.reason,message:"Connection to "+i.reason+" closed",code:i.code,url:e});t.event(u.DISCONNECT,new p(o,n))},l.onerror=function(r){try{var i=new f({status:"ws_error",message:"WebSocket error",url:e});try{h._onerror(i)}catch(e){h._log.error("OnError handler thrown an error",e)}t.event(u.DISCONNECT,new p(i,n))}finally{c(r)}},[2]):(c(new Error("\n          WebSocket [ERROR] FSM provided cannot be switched to CONNECTING state from "+r[t.current]+"\n        ")),[2])}})})})]})})},e}();t.WS=l;var d=function(){function e(e,t,n){this._ws=e,this._fsm=t,this.write=n}return e.prototype.send=function(t){var n=this;return this._fsm.event(u.SEND).then(function(i){if(!i)throw new Error("WebSocket [ERROR]: Trying to send on invalid connection state: "+r[n._fsm.current]);if(n.state!==e.State.OPEN)throw new Error("WebSocket [ERROR]: Trying to send on invalid websocket state: "+e.State[n.state]);n._ws.send(n.write(t))})},e.prototype.close=function(e){var t=this,n=void 0===e?{}:e,i=n.code,o=void 0===i?1e3:i,s=n.reason;return this._fsm.event(u.CLOSE).then(function(e){if(!e)throw new Error("WebSocket [ERROR]: Trying to close connection which already closed or had invalid state: "+r[t._fsm.current]);t._ws.close(o,s)})},Object.defineProperty(e.prototype,"url",{get:function(){return this._ws.url},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._ws.readyState},enumerable:!0,configurable:!0}),e}();t.WSConnection=d,function(e){!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSING=2]="CLOSING",e[e.CLOSED=3]="CLOSED"}(e.State||(e.State={}))}(d=t.WSConnection||(t.WSConnection={})),t.WSConnection=d;var h=function(){function e(e,t){this._maxDelay=e,this._initialDelay=t,this._log=c.Monitoring.Logging.getLogger("coreclients.wsreconnect"),this._prevDelay=0,this._reconnectCounter=0}return Object.defineProperty(e.prototype,"url",{set:function(e){this._log.info("WebSocket [INFO]: Url was overwritten "+this._url+" to "+e+" after disconnect"),this._url=e},enumerable:!0,configurable:!0}),e.prototype.initReconnect=function(e,t){this._reconnect=t,this._url=e},Object.defineProperty(e.prototype,"delay",{get:function(){return this._prevDelay},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reconnectCounter",{get:function(){return this._reconnectCounter},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this._reconnectCounter=0,this._prevDelay=0},Object.defineProperty(e.prototype,"nextDelay",{get:function(){return Math.min(this._maxDelay,Math.max(this._initialDelay,2*this._prevDelay))},enumerable:!0,configurable:!0}),e.prototype.scheduleReconnect=function(e){return void 0===e&&(e=this.nextDelay),i.__awaiter(this,void 0,void 0,function(){var t=this;return i.__generator(this,function(n){if(e<0)throw new Error("WebSocket [ERROR]: Negative delay is not allowed: "+e);return 0===e?[2,this.reconnectNow()]:[2,new Promise(function(n,r){var i=function(){return t.reconnectNow(t._url).then(function(e){n(e)}).catch(function(e){return r(e)})};t._log.debug("Reconnecting to "+t._url+" after timeout "+e),t.cancelReconnect(),t._timer=setTimeout(i,e),t._prevDelay=e})]})})},e.prototype.reconnectNow=function(e){return void 0===e&&(e=this._url),i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(t){if(!this._reconnect)throw new Error("WebSocket [ERROR]: Reconnect is not set, consider setting it before reconnect will be triggered");return this.cancelReconnect(),this._reconnectCounter++,[2,this._reconnect(e)]})})},e.prototype.cancelReconnect=function(){this._timer&&clearTimeout(this._timer)},e}();t.WSReconnect=h;var p=function(){function e(e,t){this._error=e,this.reconnect=t}return e.prototype.toString=function(){return this._error.message},Object.defineProperty(e.prototype,"code",{get:function(){return this._error.code},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this._error},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return"WebSocket [CLOSE]: statusCode="+this._error.code+" reason: "+this._error.status},enumerable:!0,configurable:!0}),e}();t.WSCloseReason=p;!function(e){function t(e){return void 0!==e&&null!==e&&(void 0!==e.code||void 0!==e.reason)}e.is=t}(t.CloseEventInfo||(t.CloseEventInfo={}));var f=function(e){function t(t){var n=t.code,r=void 0===n?-1:n,i=t.status,o=t.url,s=t.message,a=t.body,c=e.call(this,s)||this;return c.name="WSError",c.url=o,c.code=r,c.body=a,c.status=i,c}return i.__extends(t,e),t}(a.CustomError);t.WSError=f},149:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(14),o=n(23),s=n(18),a=n(8),c=n(6),u=n(398),l=n(49),d=n(1026),h=n(391),p=n(5),f=n(925);t.Location=f.Location;var g=h.default();!function(e){function t(e){return{route:e,href:function(t){return{pathname:u.compile(e.path)(t),exact:e.exact,path:e.path}}}}function n(e,t){return r.__assign({},e.route,{component:t})}var h="nextLocationState",f=function(){function t(){var e=this;this._fullReload=!1,this._logger=c.Monitoring.Logging.getLogger("router"),this._nextLocationState=s.Option.empty(),this.location=a.Atom.create(this._parseLocation(g.location)),this.locationState=s.Option.empty(),this.query=new _(g.location.search),this.scheduleForceReload=function(){e._fullReload=!0,e._logger.info("forceReload.scheduled")},this.forceReload=function(){e._logger.info("forceReload.started"),window.location.reload()};var t=c.Monitoring.Logging.getLogger("router");t.info("Router init",g.location),this.locationState=this._loadLocationState(),g.listen(function(n){t.info("Location change",n),e.location.set(e._parseLocation(n)),e.locationState=e._nextLocationState,e._nextLocationState=s.None})}return t.prototype._parseLocation=function(e){return{pathname:e.pathname}},t.prototype.navigate=function(e,t,n){void 0===n&&(n=!1),t&&(this._nextLocationState=s.Option.of(t)),this._fullReload?(this._saveLocationState(e.pathname),this._logger.info("forceReload.startedOnNavigation"),window.location.href=e.pathname):n?g.replace(e):g.push(e)},t.prototype.isActive=function(t){return this.location.view(e.isActive(t))},t.prototype._saveLocationState=function(e){try{this._nextLocationState.forEach(function(t){window.localStorage.setItem(h,JSON.stringify({pathname:e,state:t}))})}catch(e){}},t.prototype._loadLocationState=function(){var e=this,t=s.Try.of(function(){var e=JSON.parse(window.localStorage.getItem(h)||"");return{state:e.state,pathname:e.pathname}}).filter(function(t){return t.pathname===e.location.get().pathname}).map(function(e){return e.state}).toOption();return function(){try{window.localStorage.removeItem(h)}catch(e){}}(),t},t}();e.Impl=f;var m=function(){function e(){this.location=a.Atom.create({pathname:"/",query:new URLSearchParams}),this.locationState=s.None,this._query=a.Atom.create(new _("")),this.navigate=p.noop,this.scheduleForceReload=p.noop,this.forceReload=p.noop}return Object.defineProperty(e.prototype,"query",{get:function(){return this._query.get()},enumerable:!0,configurable:!0}),e.prototype.isActive=function(){return a.Atom.create(!1)},e.prototype.setQuery=function(e,t){var n=new URLSearchParams;n.set(e,t),this._query.set(new _(n.toString()))},e.prototype.setNextLocationState=function(){throw new Error("Method not implemented.")},e}();e.DummyImpl=m;var _=function(){function e(e){this._searchParam=new URLSearchParams(e)}return e.prototype.has=function(e){return this._searchParam.has(e)},e.prototype.get=function(e){return s.Option.of(this._searchParam.get(e))},e}();e.ContextTypes={appRouter:o.object},e.page=t,e.bindComponent=n,e.isActive=function(e){return function(t){var n=t.pathname;return Boolean(l.matchPath(n,e))}},e.Wrapper=function(e){var t=e.routesMap,n=e.renderer;return i.createElement(l.Router,{history:g},i.createElement(l.Switch,null,p.ObjectUtils.toArray(t).map(function(e){return i.createElement(d.Route,{path:e.path,exact:e.exact,key:e.path,render:function(t){return n(t,e)}})})))},e.Block=function(e){var t=e.when,n=e.message;return i.createElement(a.F.div,null,t.map(function(e){return i.createElement(l.Prompt,{key:"prompt",when:e,message:n})}))},e.routes={documents:t({path:"/",exact:!0,private:!0}),profile:t({path:"/profile",private:!0}),subscription:t({path:"/subscription",private:!0}),apps:t({path:"/apps",private:!0}),new_document:t({path:"/docs/new",exact:!0,private:!0}),editor:t({path:"/docs/:docId",private:!0}),denali_editor:t({path:"/ddocs/:docId",private:!0}),free:t({path:"/free",private:!0}),component_browser:t({path:"/component_browser/:component?"}),card_iframe:t({path:"/card_iframe"}),diagnostic_test:t({path:"/diagnostic-test"}),notFound:t({path:"*"})}}(t.Router||(t.Router={}))},150:function(e,t,n){"use strict";function r(e){return e?e[0].toUpperCase()+e.slice(1):""}function i(e){return e?e.replace(/(?:^|[-_\s])(\w)/g,function(e,t){return t?t.toUpperCase():""}):""}function o(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})}function s(e,t){if(void 0===e&&(e=""),!e||"undefined"==typeof window)return"";if(!t)return b.sanitize(e);var n=Object.assign({},t.allowedTags?{ALLOWED_TAGS:t.allowedTags}:{},t.sanitizeDom?{SANITIZE_DOM:t.sanitizeDom}:{});return b.sanitize(e,n)}function a(e,t){var n=e.match(t);return n&&n[1]}function c(e){return e.split(/\s+/)[0]}function u(e){if(!e)return 0;var t=e.replace(/[\W\d]/gi," ").replace(/\s+/gi," ").trim().split(" ");return 1===t.length&&""===t[0]?0:t.length}function l(e){return w.decode(e).length}function d(e){return e.replace(/\t/g,"    ")}function h(e,t,n){return 1===e?t:n}function p(e,t){return void 0===t&&(t="en-US"),e.toLocaleString(t,{minimumFractionDigits:2,maximumFractionDigits:2})}function f(e){return e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&")}function g(e,t,n){return t>>=0,n=String(n||" "),e.length>t?String(e):(t-=e.length,t>n.length&&(n+=n.repeat(t/n.length)),n.slice(0,t)+String(e))}function m(e){var t=document.createElement("div");return t.innerHTML=s(e),t.textContent||t.innerText||""}function _(e){if(!e)return"";var t=document.createElement("a");return t.href=e,t.hostname}function y(e){return e&&(e<48||58===e||59===e||63===e)||!1}function v(e){if(e<0)throw new TypeError("Length should not be negative: "+e);return Array.from({length:e},function(){return E.charAt(Math.random()*E.length)}).join("")}Object.defineProperty(t,"__esModule",{value:!0});var b=n(840),w=n(100);t.nbsp=String.fromCharCode(160),t.capitalize=r,t.camelize=i,t.toTitleCase=o,t.sanitize=s,t.getFirstMatch=a,t.getFirstWord=c,t.wordCount=u,t.charCount=l,t.replaceTabsWithSpaces=d,t.pluralize=h,t.formatPrice=p,t.escapeRegExp=f,t.padStart=g,t.decodeHTMLCodes=m,t.urlToDomain=_,t.isBreakWordChar=y;var E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";t.alphanumeric=v},151:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(18);t.Delta=n(951);!function(e){function n(e,t){return void 0===t&&(t=0),new p(e,t)}function o(e,r,i){return void 0===i&&(i=0),n((new t.Delta).retain(e).insert(r),i)}function s(e,r,i){return void 0===i&&(i=0),n((new t.Delta).retain(e).delete(r),i)}function a(e,r,i){return void 0===r&&(r=0),n((new t.Delta).retain(e,i),r)}function c(e){return new g(e)}function u(){return new f}function l(e){return"delta"===e.kind}function d(e){return"reset"===e.kind}function h(e){return"flush"===e.kind}var p=function(){function e(e,t){this.delta=e,this.prevLen=t,this.kind="delta",this._length=void 0,this._amount=void 0,this._text=void 0}return Object.defineProperty(e.prototype,"length",{get:function(){return this._length||(this._length=i.calcDiffLength(this.delta))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"amount",{get:function(){return this._amount||(this._amount=i.calcAmountLength(this.delta))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){var e=this;return this._text||(this._text=r.Try.of(function(){return e.delta.ops.reduce(function(e,t){if(t.insert)return e+t.insert;throw t.delete?new Error("can not get text on delta with deletes"):new Error("can not get text on delta with retains")},"")}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this.delta.ops.length},enumerable:!0,configurable:!0}),e.prototype.compose=function(t){return new e(this.delta.compose(t.delta),this.prevLen)},e.prototype.transform=function(t,n){return void 0===n&&(n=!0),new e(t.delta.transform(this.delta,n),this.prevLen+t.length)},e.prototype.toString=function(){return"Delta("+this.delta+", pl: "+this.prevLen+")"},e}();e.DeltaChangeImpl=p;var f=function(){function e(){this.kind="flush"}return e.prototype.toString=function(){return"Flush()"},e}();e.FlushImpl=f;var g=function(){function e(e){this.text=e,this.kind="reset"}return e.prototype.toString=function(){return"Reset(len: "+this.text.length+")"},e}();e.ResetImpl=g,e.delta=n,e.ins=o,e.del=s,e.ret=a,e.res=c,e.flush=u,e.isDelta=l,e.isReset=d,e.isFlush=h}(t.Change||(t.Change={}));var i;!function(e){function n(e){return e.ops.reduce(function(e,t){return t.insert?e+t.insert.length:t.delete?e-t.delete:e},0)}function r(e){return e.ops.reduce(function(e,t){return t.insert?e+t.insert.length:t.delete?e+t.delete:e},0)}function i(e){return e.reduce(function(e,t){return e.compose(t)},new t.Delta)}function o(e){return e.reduce(function(e,t){if(t.insert)return e.insert(t.insert);if(t.delete)return e.delete(t.delete);if(t.retain)return e.retain(t.retain);throw new Error("Unknown operation")},new t.Delta)}e.calcDiffLength=n,e.calcAmountLength=r,e.squash=i,e.cleanAttrs=o}(i=t.DeltaUtils||(t.DeltaUtils={}))},152:function(e,t,n){"use strict";function r(e){return"american"===e||"british"===e||"canadian"===e||"australian"===e}function i(e){return e&&"null"!==e}Object.defineProperty(t,"__esModule",{value:!0});var o=n(18),s=n(22),a=n(53),c=n(8),u=n(6),l=n(5),d=n(80);t.isDialectString=r;var h=function(){function e(e,t,n,r){this._userSettings=e,this._customFields=t,this._dapi=n,this._userId=r,this._log=u.Monitoring.Logging.getLogger("model.settings"),this.firstCall=this._userSettings.lens("firstCall"),this.dialect=this._userSettings.view(function(e){return i(e.dialectStrong)?o.Some(e.dialectStrong):i(e.dialectWeak)?o.Some(e.dialectWeak):o.None}),this.dialectOrDefault=this.dialect.view(function(e){return e.fold(function(){return d.appConfig.defaultDialect},function(e){return e})}),this.seenWelcome=this._userSettings.lens("seenWelcome"),this.suppressedWelcome=this._userSettings.lens("suppressedWelcome"),this.forcedDenaliUI=this._userSettings.lens("forcedDenaliUI"),this.acceptedTermsVersion=this._userSettings.lens("acceptedTermsVersion"),this.banners=this._userSettings.lens("banners"),this.denaliLens=this._userSettings.lens("denaliLens"),this.onboardingPassed=this._userSettings.lens("onboardingPassed"),this.showExitNotification=this._userSettings.lens("showExitNotification"),this.disableProofit=this._customFields.lens("disableProofit")}return e.prototype._sync=function(e){var t=this;return this._dapi.save(e).then(function(){return f.write(t._userId.get(),a.Properties.of(t._userSettings.get()))}).catch(this._log.handler("dapiError: save failed",{data:e}).warn)},e.prototype._setProperty=function(e,t){var n=this;return void 0===t&&(t=!0),l.Async.modifyRemoteStateOptimistic(this._userSettings,function(t){return Object.assign({},t,e)},function(){return n._sync(a.Properties.of(e))},t)},e.prototype.firstCallDone=function(){var e=this;return this._setProperty({firstCall:!0},!1).catch(function(t){t instanceof s.TimeoutError?e._log.warn("Cannot set first call as done",t):e._log.error("Cannot set first call as done",t)})},e.prototype.setDialect=function(e){return this._setProperty({dialectStrong:e}).then(function(t){return e})},e.prototype.setDialectWeak=function(e){return this._setProperty({dialectWeak:e}).then(function(t){return e})},e.prototype.welcomeTourLooked=function(){var e=this;return this._setProperty({seenWelcome:!0},!1).catch(function(t){return e._log.warn("Cannot mark welcome tour as looked",t)})},e.prototype.welcomeTourSuppressed=function(){var e=this;return this._setProperty({suppressedWelcome:!0},!1).catch(function(t){return e._log.warn("Cannot mark welcome tour as suppressed",t)})},e.prototype.acceptTerms=function(e){return this._setProperty({acceptedTermsVersion:e},!1).catch(this._log.handler("Cannot mark terms as accepted").error)},e.prototype._saveBanners=function(e){var t=e.shown,n=e.later,r=e.dismiss;return{shown:t,later:n.map(function(e){return e.type+":"+e.expire}),dismiss:r}},e.prototype.updateBanners=function(e){var t=this;return l.Async.modifyRemoteStateOptimistic(this.banners,function(t){return e},function(){return t._sync(a.Properties.of({banners:t._saveBanners(e)}))},!1).catch(function(e){e instanceof s.TimeoutError?t._log.warn("Cannot update banners state",e):t._log.error("Cannot update banners state",e)})},e.prototype.toggleMarkAsImportant=function(e,t){var n=Object.assign({},this.denaliLens.get());return n[e]=Object.assign({},n[e],{important:t}),this._setProperty({denaliLens:Object.assign({},n)},!1)},e.prototype.dismissAll=function(e){var t=Object.assign({},this.denaliLens.get());return t[e]=Object.assign({},t[e],{dissmissAllCounter:Math.sqrt(function(e){return e?e*e:1}(t[e]&&t[e].dismissAllCounter||0)+1)}),this._setProperty({denaliLens:Object.assign({},t)},!1)},e.prototype.updateOnboardingPassed=function(e){var t=new Set(this._userSettings.get().onboardingPassed),n=t.size;return e.forEach(function(e){return t.add(e)}),n===t.size?Promise.resolve():this._setProperty({onboardingPassed:Array.from(t)},!1)},e.prototype.updateExitNotification=function(e){var t=this;return this._setProperty({showExitNotification:e},!1).catch(function(e){t._log.warn("Cannot set showExitNotification",e)})},e}();t.SettingsModelImpl=h;var p=""+d.appConfig.userSettingsPrefix+d.appConfig.userSettingsVersion+"-",f=function(){function e(){}return e.read=function(e){try{var t=""+p+e;return a.Properties.of(JSON.parse(l.LocalStorage.readProperties(t)[t]))}catch(e){return a.Properties.of({})}},e.write=function(e,t){l.LocalStorage.writeProperties(a.Properties.of((n={},n[""+p+e]=JSON.stringify(t),n)));var n},e}();t.LocalStorageUserSettings=f;!function(e){var t=function(){function e(){this.denaliLens=c.Atom.create({}),this.onboardingPassed=c.Atom.create([]),this.showExitNotification=c.Atom.create(!0)}return e.prototype.toggleMarkAsImportant=function(e,t){return Promise.resolve()},e.prototype.dismissAll=function(e){return Promise.resolve()},e.prototype.updateOnboardingPassed=function(e){return Promise.resolve()},e.prototype.updateExitNotification=function(e){return Promise.resolve()},e}();e.Mock=t}(t.DenaliSettingsModel||(t.DenaliSettingsModel={}))},196:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(6),o=n(22),s=n(5),a=n(394),c=function(e){function t(t){var n=e.call(this,"Client fetch error: "+(t&&t.message||t))||this;return n.name="FetchError",n.cause=t,n}return r.__extends(t,e),t}(s.CustomError);t.FetchError=c;var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="TimeoutWarnError",t}return r.__extends(t,e),t}(s.CustomError);t.TimeoutWarnError=u;var l,d=function(){function e(){}return Object.defineProperty(e,"_logger",{get:function(){return void 0===e.__logger&&(e.__logger=i.Monitoring.Logging.getLogger("RxFetch")),e.__logger},enumerable:!0,configurable:!0}),e.request=function(t){return e._withTargetTag(this._trackedRequest,t)},Object.defineProperty(e,"_trackedRequest",{get:function(){return l||(l=i.Monitoring.TimeSeries.root.getMetric("fetch")),e._request},enumerable:!0,configurable:!0}),e.withTimeout=function(t,n){return function(r,i){return void 0===i&&(i={}),s.Async.promiseWithTimeout(t(r,i),n).catch(function(t){if(t instanceof o.TimeoutError){var n=e._getMeta(r,i),s=n.method,a=n.target;throw e.requestResults.next({type:"timeoutError",url:r,target:a,method:s}),e._extendError(t,r,s,a)}throw t})}},e._withTargetTag=function(t,n){return function(r,i){return"string"==typeof r?(i=i||{},i[e.FETCH_TARGET_TAG_OPTION]=n):r[e.FETCH_TARGET_TAG_OPTION]=n,t(r,i)}},e._withTimeoutWarn=function(t,n){return function(r,i){return o.Observable.merge(t(r,i),o.Observable.interval(n).mapTo(new u)).do(function(t){if(t instanceof u){var n=e._getMeta(r,i),o=n.method,s=n.target;e.requestResults.next({type:"timeoutWarn",url:r,method:o,target:s})}}).filter(function(e){return!(e instanceof u)}).first().toPromise()}},e._extendError=function(e,t,n,r){var i="object"==typeof e?s.isClientFetchError(e)?new c(e):e:new Error(e);return Object.assign(i,{isRxFetch:!0,method:n,target:r,url:"string"==typeof t?t:t.url})},e._getMeta=function(t,n){return{method:e._getMethod(t,n),target:e._getTarget(t,n)}},e._getMethod=function(e,t){return(("string"==typeof e?t&&t.method:e.method)||"get").toLowerCase()},e._getTarget=function(t,n){var r=("string"==typeof t?n&&n[e.FETCH_TARGET_TAG_OPTION]:t[e.FETCH_TARGET_TAG_OPTION])||"unknown";return"logs"===r?void 0:r},e.FETCH_TIMEOUT=15e3,e.FETCH_TARGET_TAG_OPTION="grammarly_target",e.__logger=void 0,e.requestResults=new o.Subject,e.nativeFetch=a.bind(window),e._request=function(t,n){var r=e._getMeta(t,n),i=r.method,o=r.target,s=l.getTimer(i+"."+o+".time").start();return e._withTimeoutWarn(e.nativeFetch,e.FETCH_TIMEOUT)(t,n).then(function(n){return o&&s.stop(),e.requestResults.next(n.ok?{type:"success",method:i,target:o}:{type:"serverError",method:i,response:n,url:t,target:o}),n}).catch(function(n){var r="object"==typeof n?n:new Error(n||"Unknown fetch error");throw e.requestResults.next({type:"clientError",url:t,reason:r,method:i,target:o}),e._extendError(r,t,i,o)})},e}();t.RxFetch=d;var h=!1;d.requestResults.subscribe(function(e){if(e.target)try{l.getCounter(e.method+"."+e.target+"."+e.type).increment(),h||"unknown"!==e.target||(h=!0,d._logger.warn("got unknown fetch target",{result:e}))}catch(e){console.error("Error while reporting timeseries metrics",e)}})},197:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(6),o=function(){function e(e,t,n,r){this.from=e,this.to=t,this.event=n,this.args=r}return e.prototype.toString=function(){return"Transition: From: "+this.from+" to: "+this.to+" (Args: "+this.args+")"},e}();t.EventInfo=o;var s=function(){function e(t,n){this._log=i.Monitoring.Logging.getLogger("coreclients.fsm"),this._parents={},this._transitions={},this._scheduled=[],this._listeners={},this._inTransition=!1,this._verbose=!1,this._id=++e._ids,this._initial=t,this._current=t,this._final=n||null}return Object.defineProperty(e.prototype,"current",{get:function(){return this._current},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFinal",{get:function(){return this._final===this._current},enumerable:!0,configurable:!0}),e.prototype.transition=function(e,t,n){this._transitions[e<<11|n]=t},e.prototype.parent=function(e,t){this._parents[e]=t},e.prototype.is=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.findIndex(function(t){return t===e._current})>=0},e.prototype.from=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new(c.bind.apply(c,[void 0,this].concat(e)))},e.prototype.with=function(e){return new a(this,e)},e.prototype.verbose=function(e,t){return this._verbose=!0,this._states=e,this._events=t,this},e.prototype.on=function(e,t){return this._addCallback(this._listeners,e,t),this},e.prototype.event=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n=this;return r.__generator(this,function(i){return[2,new Promise(function(i,s){return r.__awaiter(n,void 0,void 0,function(){var n,a,c,u,d;return r.__generator(this,function(h){switch(h.label){case 0:if(this._verbose&&this._trace("Handling event: "+this._eventName(e)),this._current===this._final)return this._trace("Cannot handle event "+e+": FSM is in it's final state"),[2,i(!1)];if(this._inTransition)return this._scheduled.push(new l(e,t,i,s)),[2];n=this._current,a=null,c=function(){var s,c,l,d,h,p,f;return r.__generator(this,function(g){switch(g.label){case 0:if(void 0===(s=u._transitions[n<<11|e]))return[3,10];u._inTransition=!0,c=u._listeners[s]||[],l=new o(u._current,s,e,t),g.label=1;case 1:g.trys.push([1,7,8,9]),u._verbose&&u._trace("Transition from "+u._stateName(l.from)+" to "+u._stateName(l.to)+" on "+u._eventName(e)+" Arguments: "+t),d=c.map(function(e){return Promise.resolve(e(l))}),u._current=s,u._inTransition=!1,h=function(e){return r.__generator(this,function(t){switch(t.label){case 0:return[4,u.event(e.event,e.args).then(function(t){return e.done(t)}).catch(function(t){return e.fail(t)})];case 1:return t.sent(),[2]}})},p=u._scheduled.shift(),g.label=2;case 2:return void 0===p?[3,5]:[5,h(p)];case 3:g.sent(),g.label=4;case 4:return p=u._scheduled.shift(),[3,2];case 5:return[4,Promise.all(d).then(function(e){return i(!0)})];case 6:return g.sent(),[3,9];case 7:return f=g.sent(),a=f,[3,9];case 8:return u._inTransition=!1,[7];case 9:return[2,"break"];case 10:return n=u._parents[n],[2]}})},u=this,h.label=1;case 1:return void 0===n?[3,3]:[5,c()];case 2:return d=h.sent(),"break"===d?[3,3]:[3,1];case 3:return a?s(a):i(!1),[2]}})})})]})})},e.prototype._addCallback=function(e,t,n){var r=e[t];return r||(r=[],e[t]=r),r.push(n),this},e.prototype._eventName=function(e){return void 0===this._events?e:this._events[e]},e.prototype._stateName=function(e){return void 0===this._states?e:this._states[e]},e.prototype._trace=function(e){this._log.trace("FSM#"+this._id+" [VERBOSE]: "+e)},e._ids=0,e}();t.StateMachine=s;var a=function(){function e(e,t){this.hsm=e,this.state=t}return e.prototype.childrenOf=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.forEach(function(t){return e.hsm.parent(e.state,t)}),this.hsm},e.prototype.parentOf=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.forEach(function(t){return e.hsm.parent(t,e.state)}),this.hsm},e}();t.WithBuilder=a;var c=function(){function e(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.hsm=e,this._states=t}return e.prototype.to=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new u(this.hsm,this._states,e)},e}();t.TransitionBuilder=c;var u=function(){function e(e,t,n){this.hsm=e,this.from=t,this.to=n}return e.prototype.on=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.forEach(function(t){return e.from.forEach(function(n){return e.to.forEach(function(r){return e.hsm.transition(n,r,t)})})}),this.hsm},e}();t.EventBuilder=u;var l=function(){function e(e,t,n,r){this.event=e,this.args=t,this.done=n,this.fail=r}return e}()},198:function(e,t,n){"use strict";function r(e,t){if(!e)throw new l("string"==typeof t?t:t&&t())}function i(e,t){if(!e)throw new l("string"==typeof t?t:t&&t());return e}function o(e){throw new h(e)}function s(e){if(!u.isObject(e))return!1;var t=e.name,n=e.message;return"FetchError"===t&&n===f||"TypeError"===t&&n===p||"TypeError"===t&&"Failed to fetch"===n}function a(e){return void 0!==e&&(e>=500&&e<=599)}Object.defineProperty(t,"__esModule",{value:!0});var c=n(2),u=n(203);t.CustomError=function(e){void 0===e&&(e="(nomessage)"),Error.call(this,e),this.stack=(new Error).stack,this.message=e,this.name=this.constructor.name},t.CustomError.prototype=Object.create(Error.prototype);var l=function(e){function t(t){return e.call(this,"Invariant condition failed: "+(t||"(unnamed)"))||this}return c.__extends(t,e),t}(t.CustomError);t.InvariantError=l;var d=function(e){function t(t){return e.call(this,t)||this}return c.__extends(t,e),t}(t.CustomError);t.IllegalArgumentError=d;var h=function(e){function t(t){return e.call(this,"Matching not exhaustive"+(t?": unexpected value "+t:""))||this}return c.__extends(t,e),t}(t.CustomError);t.MatchingNotExhaustiveError=h,t.invariant=r,t.expectNonNull=i,t.assertNever=o;var p="NetworkError when attempting to fetch resource.",f="Client fetch error: Failed to fetch";t.isClientFetchError=s,t.isServerErrorCode=a},199:function(e,t,n){"use strict";function r(){return void 0!==window.GR_EXTENSION_ID}function i(e){return"edge"===e?a.getBrowserInfo().parsedVersion>=15:["chrome","firefox","safari"].indexOf(e)>-1}function o(e){return Array.from(e).some(function(e){return e.indexOf("office-addin")>-1})}Object.defineProperty(t,"__esModule",{value:!0});var s=n(6),a=n(38);!function(e){function t(e){var t=window;try{t.GR_EXTENSION_SEND&&t.GR_EXTENSION_SEND(e)}catch(t){s.Monitoring.Logging.getLogger("utils.extension").error("GR_EXTENSION_SEND("+e+") failed",t)}}function n(){t("editor-fix")}function r(){t("changed-dialect")}function i(){t("cleanup")}e.sendEditorFix=n,e.sendDialectChanged=r,e.sendLogout=i}(t.notifications||(t.notifications={}));!function(e){function t(e){window.top.postMessage({grammarly:!0,action:"open-url",url:e},"*")}e.openUrl=t}(t.actions||(t.actions={})),t.isExtensionInstalled=r,t.isBrowserHasExtension=i,t.isAddinInstalled=o},202:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(23);t.telemetryContextType={telemetry:r.object},t.denaliTelemetryContextType={gnarSpec:r.object,pageId:r.string};var i=n(1400);t.EditorTelemetry=i.EditorTelemetry,t.TelemetryContainerId=i.TelemetryContainerId,t.errorSource=i.errorSource,t.ErrorSourceType=i.ErrorSourceType,t.DocumentTelemetry=i.DocumentTelemetry,t.CheckSettingName=i.CheckSettingName,t.DocumentTelemetryContext=i.DocumentTelemetryContext,t.AccountAndSupportTelemetry=i.AccountAndSupportTelemetry,t.AccountAndSupportTelemetryContext=i.AccountAndSupportTelemetryContext,t.accountType=i.accountType,t.SubscriptionTelemetry=i.SubscriptionTelemetry,t.SubscriptionTelemetryContext=i.SubscriptionTelemetryContext,t.AppsTelemetry=i.AppsTelemetry,t.AppsTelemetryContext=i.AppsTelemetryContext,t.TrackingAppType=i.TrackingAppType,t.TrackingBannerType=i.TrackingBannerType,t.DictionaryAndLanguageTelemetry=i.DictionaryAndLanguageTelemetry,t.DictionaryAndLanguageTelemetryContext=i.DictionaryAndLanguageTelemetryContext,t.DialectStringTelemetry=i.DialectStringTelemetry,t.TourTelemetry=i.TourTelemetry,t.TourTelemetryContext=i.TourTelemetryContext,t.BannersTelemetry=i.BannersTelemetry;var o=n(1403);t.PixelTracking=o.PixelTracking;var s=n(1405);t.Wootric=s.Wootric,t.WootricViewModel=s.WootricViewModel,t.FullWootricViewModel=s.FullWootricViewModel},203:function(e,t,n){"use strict";function r(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function i(e){return e&&!Array.isArray(e)&&"object"==typeof e}function o(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function s(e){return Object.keys(e).map(function(t){return e[t]})}function a(e,t){return function(n){var r=e,i=n[r],o=p.__rest(n,["symbol"==typeof r?r:r+""]);return"function"==typeof t?p.__assign((s={},s[e]=t(f.Option.of(i)),s),o):p.__assign((a={},a[e]=t,a),o);var s,a}}function c(e,t){return function(n){var r=e,i=n[r],o=p.__rest(n,["symbol"==typeof r?r:r+""]);return("function"==typeof t?t(f.Option.of(i)):t).fold(function(){return o},function(t){return p.__assign((n={},n[e]=t,n),o);var n})}}function u(e,t){return l(l({},e),t)}function l(e,t){for(var n in t){var r=e[n]||{},i=t[n];null!=i&&null!=r&&i.constructor===Object&&r.constructor===Object?e[n]=l(r,i):e[n]=i}return e}function d(e,t){return Object.assign({},e,t)}function h(e){return function(t){return d(t,e)}}Object.defineProperty(t,"__esModule",{value:!0});var p=n(2),f=n(18);t.objectWithoutProperties=r,t.isObject=i,t.isEmptyObject=o,t.toArray=s,t.immutableUpdate=a,t.immutableUpdateOption=c,t.merge=u,t.update=d,t.modify=h},205:function(e,t,n){"use strict";function r(e,n){var r=n?t.DefaultAcademicGenresTitleMap[e]:t.GenresTitleMap[e];if(!r)throw new TypeError("Coudn't find title for "+e);return r}function i(e){return{contextualSpelling:e,grammar:e,sentenceStructure:e,punctuation:e,style:e,enhancement:e,plagiarism:e}}function o(e,t){return Object.assign({},e,{plagiarism:t})}Object.defineProperty(t,"__esModule",{value:!0});var s=n(98);t.GenresTitleMap={general:"General (default)",academic:"Academic",academic_general:"General academic",academic_essay:"Essay",academic_report:"Report",academic_case:"Case study",academic_review:"Book/literature review",academic_proposal:"Research proposal",academic_results:"Research results",academic_disser:"Dissertation",academic_letter:"Admission letter",business:"Business",business_other:"General business",business_letter:"Business letter",business_email:"Business email",business_report:"Report",business_memo:"Memo",business_proposal:"Proposal",business_article:"Article/blog post",business_adv:"Ad/website copy",technical:"Technical",technical_other:"General technical",technical_manual:"End-user assistance document",technical_documentation:"Technical documentation",technical_marketing:"Marketing document",medical:"Medical",medical_other:"General medical",medical_regulatory:"Regulatory writing",medical_educational:"Educational writing",creative:"Creative",creative_other:"General creative",creative_nonfiction:"Creative non-fiction",creative_novel:"Novel",creative_script:"Script",creative_story:"Short story",casual:"Casual",casual_other:"General casual",casual_email:"Personal email",casual_blog:"Personal blog post"},t.DefaultAcademicGenresTitleMap=Object.assign({},t.GenresTitleMap,{general:"General",academic_general:"General academic (default)"}),t.getGenreMenuTitle=r,t.createChecksDefaultState=i,t.setPlagiarism=o,t.defaultState={contextualSpelling:!0,grammar:!0,sentenceStructure:!0,punctuation:!0,style:!0,enhancement:!0,plagiarism:!1};var a=function(){function e(e,t,n){this._genre=e,this._checks=t,this._telemetry=n,this.genre=this._genre,this.contextualSpellingEnabled=this._checks.lens("contextualSpelling"),this.grammarEnabled=this._checks.lens("grammar"),this.sentenceStructureEnabled=this._checks.lens("sentenceStructure"),this.punctuationEnabled=this._checks.lens("punctuation"),this.styleEnabled=this._checks.lens("style"),this.enhancementEnabled=this._checks.lens("enhancement"),this.plagiarismEnabled=this._checks.lens("plagiarism"),this.checksEnabled=this._checks}return e.prototype.setGenre=function(e){this._genre.set(e)},e.prototype.toggleFreemiumChecks=function(){var e=[this.contextualSpellingEnabled,this.grammarEnabled,this.punctuationEnabled,this.sentenceStructureEnabled,this.styleEnabled],t=e.some(function(e){return e.get()});e.forEach(function(e){return e.set(!t)}),this._telemetry.settingsToggled(!t,"all")},e.prototype.isAlertGroupEnabled=function(e){var t=this._checks.get();return e===s.AlertGroup.contextualSpelling&&t.contextualSpelling||e===s.AlertGroup.enhancement&&t.enhancement||e===s.AlertGroup.grammar&&t.grammar||e===s.AlertGroup.plagiarism&&t.plagiarism||e===s.AlertGroup.punctuation&&t.punctuation||e===s.AlertGroup.sentenceStructure&&t.sentenceStructure||e===s.AlertGroup.style&&t.style},e}();t.CheckingSettingsModelImpl=a},206:function(e,t,n){"use strict";function r(e,n){var r="function"==typeof e?e:n,i="function"!=typeof e?e:void 0;return r.contextTypes=t.baseComponentContextTypes,i&&(r.propTypes=i),r}function i(e){return r(e)}Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),s=n(14),a=n(23),c=n(202),u=n(99),l=n(560),d=n(209),h=n(149),p=n(22),f=n(303),g={appConfig:a.object},m={screen:a.object};t.baseComponentContextTypes=Object.assign({router:a.object},h.Router.ContextTypes,g,c.telemetryContextType,c.denaliTelemetryContextType,u.TextResources.ContextTypes,d.notificationsContextTypes,l.Tooltip.ContextTypes,m,f.documentLoaderContext);var _=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(n,e),n.contextTypes=t.baseComponentContextTypes,n}(s.Component);t.BaseComponent=_,t.component=r,t.withContext=i;var y=function(){function e(){this.resize=p.Observable.fromEvent(window,"resize").share().mapTo(void 0)}return Object.defineProperty(e.prototype,"remSize",{get:function(){var e=this;return this.resize.map(function(){return e._getRemSize()}).startWith(this._getRemSize()).distinctUntilChanged()},enumerable:!0,configurable:!0}),e.prototype._getRemSize=function(){return parseFloat(getComputedStyle(document.documentElement).fontSize||"16")},e}();t.ScreenContextImpl=y},207:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.updateBilling=0]="updateBilling",e[e.paymentError=1]="paymentError",e[e.subscriptionUpdated=2]="subscriptionUpdated",e[e.subscriptionCancelled=3]="subscriptionCancelled",e[e.cantUpgradeSubscription=4]="cantUpgradeSubscription",e[e.resumedSubscription=5]="resumedSubscription",e[e.cantResumeSubscription=6]="cantResumeSubscription",e[e.unknownError=7]="unknownError",e[e.unknownOrigin=8]="unknownOrigin",e[e.blobDownloadUnsupported=9]="blobDownloadUnsupported",e[e.mobileCancel=10]="mobileCancel",e[e.paypalSuccess=11]="paypalSuccess",e[e.paypalError=12]="paypalError"}(t.SubscriptionNotificationType||(t.SubscriptionNotificationType={}))},208:function(e,t,n){"use strict";function r(e){if(!e)return"general";switch(e.split("_")[0]){case"academic":return"academic";case"business":return"business";case"technical":case"medical":return"technical";case"creative":return"creative";case"casual":return"casual";default:return"general"}}function i(e){switch(e){case"general":return"general";case"academic":return"academic_general";case"business":return"business_other";case"technical":return"technical_other";case"creative":return"creative_other";case"casual":return"casual_other";default:return e}}function o(e){return s.fromDomain(r(e))}Object.defineProperty(t,"__esModule",{value:!0});var s,a=n(175),c=n(249),u=n(914),l=n(6),d=n(18);!function(e){function t(e){return{goals:new Set,domain:e,audience:d.None,style:d.None,emotion:d.None}}function n(e,t){return t.map(function(t){return"formal"===t?"creative"!==e&&"casual"!==e:"academic"!==e}).getOrElse(!0)}function r(e,t){return{_A:a._A,name:e,validate:function(e,n){return t.indexOf(e)>-1?a.success(e):a.failure(e,n)}}}function i(e){return{_A:a._A,name:e.name+"Option",validate:function(t,n){return void 0===t?u.either.right(d.None):e.validate(t,n).map(d.Some)}}}function o(e){var t=a.validate(e,v).mapLeft(c.failure).mapLeft(function(e){return l.Monitoring.Logging.getLogger("coreclients.dox.context").warn("failed to parse document context",e),e});return u.either.isLeft(t)?d.Left(t.value):d.Right(t.value)}function s(e){if(void 0!==e)return o(e).fold(function(){},function(e){return e})}function h(e){var t=e.goals,n=e.domain,r=e.audience,i=e.style,o=e.emotion;return{goals:Array.from(t),domain:n.toLowerCase(),audience:r.getOrElse(void 0),style:i.getOrElse(void 0),emotion:o.getOrElse(void 0)}}e.goals=["inform","describe","convince","tellStory"],e.goalsLabels=["Inform","Describe","Convince","Tell A Story"],e.audiences=["general","knowledgeable","expert"],e.styles=["formal","informal"],e.emotions=["mild","strong"],e.domains=["general","academic","business","technical","creative","casual"],e.fromDomain=t,e.empty=t("general"),e.isStyleValidWithDomain=n;var p=r("goal",e.goals),f=r("audience",e.audiences),g=r("style",e.styles),m=r("emotion",e.emotions),_=r("domain",e.domains),y={_A:a._A,name:"goals",validate:function(e,t){return a.array(p).validate(e,t).map(function(e){return new Set(e)})}};e.option=i;var v=a.interface({goals:y,domain:_,audience:i(f),style:i(g),emotion:i(m)});e.tryParse=o,e.parse=s,e.serialize=h}(s=t.DocumentContext||(t.DocumentContext={})),t.genreToDomain=r,t.domainToGenre=i,t.genreToDocumentContext=o},209:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(23),i=n(8),o=n(6),s=function(){function e(){}return e.prototype.error=function(e){return{type:"error",args:{errorMessage:e},dontRemoveOnAnyAction:!0,denaliShowTimeMs:1/0,denaliCloseOnClick:!0}},e.prototype.documentUploaded=function(e){return{type:"documentUploaded",args:{navigateToDocument:e},showTimeMs:1/0}},e.prototype.denaliDocumentUploaded=function(e){return{type:"denaliDocumentUploaded",args:{navigateToDocuments:e},severity:"info",showTimeMs:1/0}},e.prototype.newDocumentCreated=function(e){return{type:"newDocumentCreated",args:{navigateToDocument:e},showTimeMs:1/0}},e.prototype.documentDeleted=function(e,t,n,r){return void 0===r&&(r=!1),{type:"documentDeleted",args:{documentTitle:t,documentId:e,failedToRestore:r,restoreDocument:n}}},e.prototype.documentTypeUnsupported=function(){return{type:"documentTypeUnsupported"}},e.prototype.trackedChangesIsUnsupported=function(){return{type:"trackedChangesIsUnsupported",showTimeMs:3e4}},e.prototype.documentUploadGeneralError=function(){return{type:"documentUploadGeneralError"}},e.prototype.documentIsEmpty=function(){return{type:"documentIsEmpty"}},e.prototype.generic=function(e,t,n){return{type:"generic",args:{message:e,description:t},severity:n||"info",denaliShowTimeMs:5e3}},e.prototype.documentSizeExceeded=function(){return{type:"documentSizeExceeded"}},e.prototype.changeEmail=function(e){return{type:"changeEmail",args:{email:e}}},e.prototype.logoutError=function(e,t){return{type:"logoutError",args:{forceRetry:e,timeToRetry:t},showTimeMs:1/0,dontCloseOnClick:!0,important:!0,severity:"error"}},e.prototype.unauthorizedError=function(){return{type:"unauthorizedError",showTimeMs:1/0,dontCloseOnClick:!0,important:!0,severity:"error"}},e.prototype.offline=function(e,t){return{type:"offline",args:{resetClock:e,reconnectTime:t},showTimeMs:1/0,dontCloseOnClick:!0,important:!0,severity:"error"}},e.prototype.slowNetwork=function(){return{type:"slowNetwork",showTimeMs:1/0,dontCloseOnClick:!0,denaliShowTimeMs:5e3,denaliCloseOnClick:!0}},e.prototype.serverError=function(){return{type:"serverError",showTimeMs:1/0,dontCloseOnClick:!0,important:!0,severity:"error"}},e.prototype.unknownConnectionError=function(){return{type:"unknownConnectionError",showTimeMs:1/0,dontCloseOnClick:!0,important:!0,severity:"error"}},e.prototype.connectionWSError=function(){return{type:"connectionWSError",showTimeMs:1/0,dontCloseOnClick:!0,important:!0,severity:"error"}},e.prototype.clientConnectionError=function(){return{type:"clientConnectionError",showTimeMs:1/0,dontCloseOnClick:!0,important:!0,severity:"error"}},e.prototype.checkingIsDown=function(){return{type:"checkingIsDown",showTimeMs:1/0,dontCloseOnClick:!0,denaliCloseOnClick:!0}},e.prototype.extensionInstallFailed=function(){return{type:"extensionInstallFailed"}},e.prototype.copyToClipboardFailed=function(){return{type:"copyToClipboardFailed",denaliShowTimeMs:5e3,denaliCloseOnClick:!0}},e.prototype.alertUndo=function(e,t){return{type:"alertUndo",args:{undoAction:e,action:t},showTimeMs:1/0,size:"flexible",severity:"info"}},e.prototype.denaliAlertUndo=function(e,t,n){return{type:"alertUndoDenali",undoHandler:e,dismissedHandler:t,args:n,denaliShowTimeMs:5e3,size:"flexible",severity:"info",exclusiveTag:"alertUndoDenali"}},e.prototype.proofitPaymentDeclinedError=function(e,t){return{type:"proofitPaymentDeclinedError",denaliCloseOnClick:!0,denaliShowTimeMs:1/0,args:{paymentMethod:e,creditCardSuffix:t}}},e.prototype.proofitEmptyDocumentError=function(){return{type:"proofitEmptyDocumentError",denaliCloseOnClick:!0,denaliShowTimeMs:1/0}},e.prototype.proofitDocumentProofreadError=function(e){return{type:"proofitDocumentProofreadError",denaliCloseOnClick:!0,denaliShowTimeMs:1/0,args:{navigateToDocuments:e}}},e.prototype.proofitCancelled=function(){return{type:"proofitCancelled",denaliCloseOnClick:!0,denaliShowTimeMs:1/0}},e.prototype.proofitCompleted=function(e,t,n){return{type:"proofitCompleted",severity:"info",denaliCloseOnClick:!0,denaliShowTimeMs:1/0,args:{email:e,documentTitle:t,documentDownloadUrl:n}}},e.prototype.proofitInProgress=function(e){return{type:"proofitInProgress",args:{email:e}}},e.prototype.alertsNothingFound=function(){return{type:"alertsNothingFound",severity:"info"}},e.prototype.isTemporaryDownloadError=function(){return{type:"isTemporaryDownloadError"}},e.prototype.downloadDocumentNotFoundError=function(){return{type:"downloadDocumentNotFoundError"}},e.prototype.documentNotFoundError=function(e){return{type:"documentNotFoundError",showTimeMs:1/0,dontCloseOnClick:!0,important:!0,severity:"error",args:{navigateToDocuments:e}}},e.prototype.blobDownloadUnsupported=function(){return{type:"blobDownloadUnsupported",showTimeMs:1/0,denaliShowTimeMs:1/0,denaliCloseOnClick:!0}},e}();t.EditorNotificationFactory=s,t.defaultState={items:[],counterId:0};var a=function(){function e(e){this._getNotification=e}return e.prototype.show=function(e){return this._getNotification().show(e)},e.prototype.showMessage=function(e){return this._getNotification().showMessage(e)},e.prototype.showError=function(e,t){return this._getNotification().showError(e,t)},e.prototype.hide=function(e){return this._getNotification().hide(e)},Object.defineProperty(e.prototype,"create",{get:function(){return this._getNotification().create},enumerable:!0,configurable:!0}),e}();t.ProxyShowNotificationsModel=a;var c=function(){function e(e){this._state=e,this._items=this._state.lens("items"),this.items=this._items.view(),this.create=new s}return e.prototype.show=function(e){return o.Monitoring.Logging.getLogger("notifications").log("error"===e.type?o.Logging.LogLevel.WARN:o.Logging.LogLevel.INFO,"Notification shown: "+e.type,o.EventProps.fromAny(e)),this._addNotifications(this._state,e).id},e.prototype.showMessage=function(e,t){return this.show(this.create.generic(e,t))},e.prototype.showError=function(e){return this.show(this.create.error(e))},e.prototype.hide=function(e){this._hideNotification(this._state,e)},e.prototype.expire=function(e){this._hideNotification(this._state,e)},e.prototype.cleanup=function(){this._items.modify(this._cleanup)},e.prototype._addNotifications=function(e,t){var n=this,r=(e.get().counterId||0)+1,i=Object.assign({},t,{id:r});return e.modify(function(e){var t=n._cleanup(e&&e.items||[]),o=t.filter(function(e){return e.important}),s=t.filter(function(e){return!e.important});return{counterId:r,items:o.concat([i],s)}}),i},e.prototype._cleanup=function(e){return e.filter(function(e){return e&&!e.expired&&(e.dontRemoveOnAnyAction||e.important)})},e.prototype._hideNotification=function(e,t){e.lens("items").lens(i.Lens.find(function(e){return t===e.id})).lens(i.Lens.create(function(e){return e&&e.expired},function(e,t){return t?Object.assign({},t,{expired:e}):t})).set(!0)},e}();t.NotificationsModelImpl=c,t.notificationsContextTypes={notifications:r.object}},290:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(60),o=function(){function e(e,t,n,r,o,s){this._url=e,this._fetch=t,this._clientType=n,this._clientVersion=r,this._containerId=o,this._token=s,this._ajax=i.Ajax.factory(this._fetch)}return e.prototype._setToken=function(e){this._token=e},e.prototype._appendClientInfo=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,i;return r.__generator(this,function(r){switch(r.label){case 0:return n=(t=e.header("X-Client-Version",this._clientVersion).header("X-Client-Type",this._clientType)).header,i=["X-Container-Id"],[4,this._containerId];case 1:return[2,n.apply(t,i.concat([r.sent()]))]}})})},e.prototype._appendUserToken=function(e){return this._token?e.cookie("grauth",this._token):e},e.prototype.orAnonymous=function(){var e=this,t=i.RequestBuilder.get(this._url,"user/oranonymous").queryParam("app",this._clientType);return this._appendClientInfo(t).then(function(t){return e._ajax(e._appendUserToken(t).build())})},e.prototype.login=function(e,t){var n=this,r=i.RequestBuilder.post(this._url,"api/login").json({email_login:{email:e,password:t}});return this._appendClientInfo(r).then(function(e){return n._ajax(e.build())})},e.prototype.logout=function(){var e=this,t=i.RequestBuilder.post(this._url,"/logout");return this._appendClientInfo(t).then(function(t){return e._ajax(t.build(),i.Ajax.toVoid)})},e.prototype.changeName=function(e){var t=this,n=i.RequestBuilder.post(this._url,"/user").json({name:e});return this._appendClientInfo(n).then(function(e){return t._ajax(t._appendUserToken(e).build(),i.Ajax.toVoid)})},e.prototype.changeEmail=function(e,t){var n=this,r=i.RequestBuilder.post(this._url,"/user/email/change").json({newEmail:e,password:t});return this._appendClientInfo(r).then(function(e){return n._ajax(n._appendUserToken(e).build(),i.Ajax.toVoid)})},e.prototype.changePassword=function(e,t,n){var r=this,o=i.RequestBuilder.post(this._url,"/user/password/change").formParam("email",e).formParam("new_pwd",n).formParam("old_pwd",t);return this._appendClientInfo(o).then(function(e){return r._ajax(e.build(),i.Ajax.toVoid)})},e.prototype.getUser=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=i.RequestBuilder.get(this._url,"user").queryParam("app",this._clientType);return t.forEach(function(e){return r.queryParam("field",e)}),this._appendClientInfo(r).then(function(t){return e._ajax(e._appendUserToken(t).build())})},e.prototype.getSettings=function(){var e=this,t=i.RequestBuilder.get(this._url,"/user/settings");return this._appendClientInfo(t).then(function(t){return e._ajax(e._appendUserToken(t).build())})},e.prototype._setSettings=function(e){var t=this,n=i.RequestBuilder.post(this._url,"/user/settings").json(e);return this._appendClientInfo(n).then(function(e){return t._ajax(t._appendUserToken(e).build())})},e.prototype.setSettings=function(e){var t=this;return this.getSettings().then(function(n){return t._setSettings(Object.assign({},n,e))})},e.prototype.enableSandbox=function(e){var t=this,n=i.RequestBuilder.put(this._url,"user").json({id:e,customFields:{"sandbox.payments":"Yes"}});return this._appendClientInfo(n).then(function(e){return t._ajax(e.build(),i.Ajax.toVoid)})},e.prototype.addInstitution=function(e,t){var n=this,r=i.RequestBuilder.put(this._url,"user").json({id:e,institutionId:t});return this._appendClientInfo(r).then(function(e){return n._ajax(e.build(),i.Ajax.toVoid)})},e.targetTag="auth",e}();t.Auth=o;!function(e){e.email="EMAIL",e.google="GOOGLE",e.facebook="FACEBOOK"}(t.LoginType||(t.LoginType={}));!function(e){e.webChrome="webeditor_chrome",e.webFirefox="webeditor_firefox",e.webSafari="webeditor_safari",e.webIE="webeditor_ie",e.webEdge="webeditor_edge",e.desktop="desktopeditor",e.webTest="webeditor_test",e.unknown="webeditor_unknown"}(t.ClientType||(t.ClientType={}))},291:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;r||(r={});!function(e){function t(e,t){return Object.assign({},e,{begin:e.begin+t,end:e.end+t,highlightBegin:e.highlightBegin+t,highlightEnd:e.highlightEnd+t})}function n(e){return"Originality"===e.cardLayout.category}function r(e){return!0===e.hidden}function i(e){if(!e)return!1;var t=e;return Number.isInteger(t.rev)&&Number.isInteger(t.begin)&&Number.isInteger(t.end)&&Number.isInteger(t.highlightBegin)&&Number.isInteger(t.highlightEnd)}e.shift=t,e.isPlagiarism=n,e.isHidden=r,e.isRawAlert=i,e.mock={id:"",rev:0,pname:"Spelling/BritishVsAmerican/BrInstOfAm/BrInstOfAm",group:"ContextualSpelling",category:"BritishVsAmerican",categoryHuman:"British vs American",hidden:!1,text:"centralise",todo:"correct",title:"Inconsistent spelling",transforms:["<span class='gr_grammar_del'>centralise</span><span class='gr_grammar_ins'>centralize</span>"],details:"<p>One of&nbsp;the most obvious differences between American and British English is&nbsp;the spelling of&nbsp;certain words such as&nbsp;<b>color/colour, learned/learnt,</b> and <b>toward/towards</b>. Typically, the spelling of&nbsp;words like these only varies by&nbsp;one or&nbsp;two letters. In&nbsp;the interest of&nbsp;consistency and clarity, you should use the spelling that will be&nbsp;more familiar to&nbsp;your intended audience.\n",explanation:"<p>The word <b>centralise</b> is&nbsp;a&nbsp;British English spelling. In&nbsp;the interest of&nbsp;consistency, consider replacing it&nbsp;with the American English spelling.\n",examples:'<p><span class="grey">British: I&nbsp;wish you success in&nbsp;all your endeavours.</span><br/><span class="grey">American: I&nbsp;wish you success in&nbsp;all your endeavors.</span><br/><p><span class="grey">British: Sweet yoghurts contain a&nbsp;lot of&nbsp;sugar.</span><br/><span class="grey">American: Sweet yogurts contain a&nbsp;lot of&nbsp;sugar.</span><br/><p><span class="grey">British: Serena moved towards the blinking light.</span><br/><span class="grey">American: Serena moved toward the blinking light.</span><br/>',free:!0,highlightBegin:5092,highlightEnd:5102,highlightText:"",begin:5092,end:5102,replacements:["centralize"],extra_properties:{priority:"2"},cardLayout:{category:"Accuracy",group:"Spelling",groupDescription:"Checks spelling, confused words, capitalization",rank:10}},e.mockPlagiarism={id:"",rev:0,transforms:[],title:"Citation audit",details:"",explanation:"",examples:"",free:!1,hidden:!1,todo:"",cardLayout:{category:"Originality",group:"Unoriginal content",groupDescription:"Unoriginal content from the web",rank:0},category:"Plagiarism",categoryHuman:"Unoriginal content",begin:156,end:697,text:"",group:"Plagiarism",pname:"Plagiarism/Plagiarism/UnoriginalContent",highlightBegin:156,highlightEnd:697,highlightText:"",replacements:[],extra_properties:{}}}(t.RawAlert||(t.RawAlert={}));!function(e){e.NOT_AUTHORIZED="not_authorized",e.SESSION_NOT_INITIALIZED="session_not_initialized",e.BAD_REQUEST="bad_request",e.BACKEND_ERROR="backend_error",e.AUTH_ERROR="auth_error",e.RUNTIME_ERROR="runtime_error",e.ILLEGAL_DICT_WORD="illegal_dict_word",e.TIMEOUT="timeout",e.CANNOT_FIND_SYNONYM="cannot_find_synonym",e.CANNOT_GET_TEXT_STATS="cannot_get_text_stats"}(t.ErrorCode||(t.ErrorCode={}));!function(e){e[e.INFO=0]="INFO",e[e.WARN=1]="WARN",e[e.ERROR=2]="ERROR"}(t.ErrorSeverity||(t.ErrorSeverity={}));!function(e){e.IGNORE="IGNORE",e.IGNORE_ALL="IGNORE_ALL",e.ADD_TO_DICTIONARY="ADD_TO_DICTIONARY",e.REPORT_SUGGESTION="REPORT_SUGGESTION",e.REMOVE_FROM_DICTIONARY="REMOVE_FROM_DICTIONARY",e.LOOKED="LOOKED",e.ACCEPTED="ACCEPTED",e.ACKNOWLEDGED="ACKNOWLEDGED",e.POPUP_OPEN="POPUP_OPEN",e.POPUP_CLOSE="POPUP_CLOSE",e.UNDOED="UNDOED",e.LIKE="LIKE",e.DISLIKE="DISLIKE",e.WRONG_SUGGESTION="WRONG_SUGGESTION",e.OFFENSIVE_CONTENT="OFFENSIVE_CONTENT",e.EXPANDED="EXPANDED",e.DISMISS_BY_LENS="DISMISS_BY_LENS",e.SYNONYM_ACCEPTED="SYNONYM_ACCEPTED"}(t.FeedbackType||(t.FeedbackType={})),t.BIG_TEXT_SIZE=300},292:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_FILE_SIZE=4194304},293:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(18),o=n(6),s=n(5),a=n(295),c=n(151),u=n(43),l=n(97),d=n(1365),h=n(294),p=n(311),f=n(549),g=n(148),m=function(e){function t(n,o,a,c,d,h){void 0===d&&(d=t.Queue.create({})),void 0===h&&(h=500);var p=e.call(this,n)||this;return p._originalUrl=n,p._changesQueue=d,p._sendDelay=h,p._nextId=1,p._revision=-1,p._clientId=-1,p._idleRestore=i.None,p._forceSend=!1,p._proofitPlansRequester=new u.ValueRequester(function(e){return p._sendInbandCommand(e)},15e3,"ProofitPlans"),p._proofitCreateJobRequester=new u.ValueRequester(function(e){return p._sendInbandCommand(e)},15e3,"ProofitCreateJob"),p._disconnectHandler=function(e,t,n){return r.__awaiter(p,void 0,void 0,function(){var o;return r.__generator(this,function(r){switch(r.label){case 0:return o=e.code,(e.reconnect.url=this._originalUrl+(-1===this._revision?"":"?sinceVersion="+this._revision),o!==l.DoxErrors.WsCodes.GOING_AWAY&&o!==l.DoxErrors.WsCodes.NORMAL_CLOSURE||!this._changesQueue.isEmpty)?[3,1]:(u.invariant(!this._changesQueue.isStaging,"queue should be not in staging state"),this._log.debug("Disconnected due to timeout. Waiting for changes to reconnect."),this._idleRestore=i.Some(function(){return n(0)}),[3,3]);case 1:return this._changesQueue.isStaging&&(this._log.debug("We got disconnect while trying send changed"),this._changesQueue.unstage()),[4,this._handler.disconnectHandler(e,t,n)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},p._resolvePendingFlushPromise=s.noop,p._handler=new t.DefaultHandler(c),p._initHandler=o,p._failHandler=a,p._fsm.from(f.States.READY).to(f.States.WAIT_ACK).on(f.Events.SEND).from(f.States.WAIT_ACK).to(f.States.READY).on(f.Events.ACK,f.Events.RESET).from(f.States.WAIT_ACK).to(f.States.DISCONNECTED).on(f.Events.DISCONNECT).from(f.States.WAIT_ACK).to(f.States.CLOSED).on(f.Events.CLOSE).on(f.States.READY,function(e){return p._trySendAfterTimeout()}).on(f.States.CLOSED,function(e){var t=e.args?e.args:l.DoxErrors.CLOSED_ERROR;p._failInit(t),p._changesQueue.drop("connection closed")}),p._fsm.event(f.Events.CONNECT).catch(function(e){p._failInit(e)}),s.registerDebugHelper("doxReset",function(e){if(void 0===e)throw new Error("provide text!");p._handleResetMessage({op:"reset",id:p._nextId++,text:e,vsn:p._revision+10,clientId:p._clientId})}),s.registerDebugHelper("doxState",p),s.registerDebugHelper("closeDoxSocket",function(e,t){void 0===e&&(e=1e3),p._conn._ws.close(e,t)}),p}return r.__extends(t,e),t.getWsDocumentUrl=function(e,t){return e+(void 0===t?"/documents/ws":"/documents/"+t+"/ws")},t.create=function(e,n,r,i){return new Promise(function(o,s){return new t(e,o,s,n,r,i)})},Object.defineProperty(t.prototype,"inSync",{get:function(){return!this._changesQueue.isStaging&&this._changesQueue.isEmpty},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fsmState",{get:function(){return f.States[this._fsm.current]},enumerable:!0,configurable:!0}),t.prototype.getProofitPlans=function(){return this._proofitPlansRequester.request(new d.Message.ProofitOptionsMessage(this._nextId++))},t.prototype.placeProofitOrder=function(e){return this._proofitCreateJobRequester.request(new d.Message.ProofitPlaceOrderMessage(this._nextId++,a.Proofit.PlanType[e]))},t.prototype.pushChanges=function(e){if(c.Change.isDelta(e))return this._checkIdle(),this._changesQueue.pushChanges(e);if(c.Change.isReset(e))throw new Error("Invalid change. Reset changes are not supported by dox");return-1},t.prototype.updateMetadata=function(e){return this._checkIdle(),this._changesQueue.pushMeta(e)},t.prototype._handleMessage=function(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this._messageHandler(e)];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),this._log.warn("fail on processing incoming message",t),this._failInit(t),this._conn._ws.close(l.DoxErrors.WsCodes.CLIENT_MALFUNCTION,"Unexpected failure on: "+t.message),[3,3];case 3:return[2]}})})},t.prototype._messageHandler=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,i;return r.__generator(this,function(r){switch(r.label){case 0:switch(this._log.isEnabled(o.Logging.LogLevel.TRACE)&&this._log.trace("Message <<<",{message:JSON.stringify(e)}),t=e.op){case"init":return[3,1];case"patch":return[3,3];case"reset":return[3,9];case"vsn":return[3,11];case"mongodb_change":return[3,12];case"document_metadata_changed":return[3,13];case"proofit_turnaround_options":return[3,14];case"proofit_create_job":return[3,15]}return[3,16];case 1:return[4,this._handleInitMessage(e)];case 2:return r.sent(),[3,17];case 3:return this._fsm.is(f.States.READY)||this._fsm.is(f.States.WAIT_ACK)&&this._clientId===e.cl?[4,this._handlePatchMessage(e)]:[3,5];case 4:return r.sent(),[3,8];case 5:return this._fsm.is(f.States.WAIT_ACK)?(this._log.warn("got change while waiting ack for other change"),[4,this._handlePatchMessage(e)]):[3,7];case 6:return r.sent(),[3,8];case 7:this._log.warn("got unexpected patch message",{currentState:f.States[this._fsm.current]}),r.label=8;case 8:return[3,17];case 9:return[4,this._handleResetMessage(e)];case 10:return r.sent(),[3,17];case 11:case 12:return[3,17];case 13:return this._handleMetaChangeMessage(e),[3,17];case 14:return this._proofitPlansRequester.onValue(e.id,a.Proofit.processOptions(e)),[3,17];case 15:return this._proofitCreateJobRequester.onValue(e.id,a.Proofit.parseCreateJobResult(e)),[3,17];case 16:e.error?(n=e.code,i=e.error,this._failInit(new g.WSError({status:"ws_error",code:n,message:i}))):(this._log.warn("Unexpected message",{message:e}),this._failInit(e)),r.label=17;case 17:return[2]}})})},t.prototype._handleInitMessage=function(e){return r.__awaiter(this,void 0,void 0,function(){var n,i,o,a,c,u;return r.__generator(this,function(r){switch(r.label){case 0:return[4,this._fsm.event(f.Events.INITIALIZE)];case 1:return(n=r.sent())?(i=void 0!==e.deltas?e.deltas:[],i.length>0?(this._log.debug("Got changes on init. Skipping reset"),o=s.ArrayUtils.flatMap(i.map(function(e){return e.deltas})),a=i[0].doc_len,c=i[0].rev,[4,this._handlePatchMessage(new d.Message.PatchMessage(-1,-1,c,a,o,e.vsn),e.doc_len)]):[3,3]):[3,5];case 2:r.sent(),r.label=3;case 3:return u=e.text,this._initHandler?(this._initHandler({initialText:u,remoteDocument:this,meta:t.Meta.parse(e)}),this._initHandler=null,this._failHandler=null,this._clear(e)):0===i.length&&e.vsn!==this._revision?(this._log.debug("Remote has unknown revision, goto reset"),this._handleResetMessage({id:-1,op:"reset",clientId:e.clientId,vsn:e.vsn,text:u})):this._clear(e),[4,this._fsm.event(f.Events.INITIALIZED)];case 4:return r.sent(),[3,5];case 5:return[2]}})})},t.prototype._handlePatchMessage=function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,i,s,a,l;return r.__generator(this,function(r){switch(r.label){case 0:return(n=e.cl===this._clientId)?(this._log.trace("get patch from same client"),[4,this._fsm.event(f.Events.ACK)]):[3,2];case 1:return r.sent()?(this._log.trace("got ack for patch"),this._changesQueue.ack()):this._log.debug("got patch message from same client, but we are in unexpected state",{state:f.States[this._fsm.current]}),[3,3];case 2:this._log.trace("get patch from other client"),u.assert(this._revision,e.rev,"incoming patch should be on known revision"),this._handler.changeHandler(this,c.Change.flush()),i=c.DeltaUtils.squash(e.deltas),s=c.Change.delta(i,e.doc_len),void 0!==t&&u.assert(t,s.length+s.prevLen,"validated doc_len should match"),this._log.isEnabled(o.Logging.LogLevel.TRACE)&&!this._changesQueue.isEmpty&&this._log.trace("received incoming change, while has outgoing changes",JSON.stringify(s)),a=this._changesQueue.transformChangeAgainstQueue(s),s.prevLen!==a.prevLen&&(this._log.debug("incoming delta changed prev_len after transform on queue",{was:s.prevLen,now:a.prevLen}),this._log.trace("incoming delta transformed to",a)),this._handler.changeHandler(this,a),r.label=3;case 3:this._revision=n?e.rev:void 0===e.revAfterApply?e.rev+1:e.revAfterApply,r.label=4;case 4:return r.trys.push([4,6,,7]),[4,this._conn.send(new d.Message.VersionMessage(this._nextId++,e.rev))];case 5:return r.sent(),[3,7];case 6:return l=r.sent(),this._log.debug("fail onsend vsn ack",l),[3,7];case 7:return[2]}})})},t.prototype._handleResetMessage=function(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return this._log.warn("Got RESET message."),t=this._fsm.is(f.States.READY),t?[3,2]:[4,this._fsm.event(f.Events.RESET)];case 1:t=n.sent(),n.label=2;case 2:return t?(this._changesQueue.isStaging&&(this._log.debug("We got reset while trying send changed"),this._changesQueue.unstage()),this._changesQueue.drop("got reset"),this._clear(e),this._handler.changeHandler(this,c.Change.res(e.text))):this._log.warn("can not enter reset state, how it can happen?"),[2]}})})},t.prototype._handleMetaChangeMessage=function(e){this._changesQueue.drop("got incoming meta","meta");var n=t.Meta.parse(e);this._handler.metadataChangeHandler(this,n)},t.prototype._failInit=function(e){this._failHandler&&(this._failHandler(e),this._initHandler=null,this._failHandler=null)},t.prototype._checkIdle=function(){var e=this;this._idleRestore=this._idleRestore.flatMap(function(t){return e._log.debug("We are idle... reconnecting before push."),t(),i.None})},t.prototype._clear=function(e){var t=e.vsn,n=e.clientId;this._nextId=1,this._clientId=n,this._revision=t},t.prototype.flush=function(){var e=this;if(this._changesQueue.isEmpty)return this._resolvePendingFlushPromise(),Promise.resolve();if(!this._flushPromise){var t,n=function(){e._flushPromise=void 0,e._forceSend=!1,e._resolvePendingFlushPromise=s.noop,t&&clearTimeout(t)};this._flushPromise=new Promise(function(n,r){e._forceSend=!0,e._resolvePendingFlushPromise=n,t=window.setTimeout(r,4e3)}).then(n,function(e){throw n(),e}),this._timeout&&(clearTimeout(this._timeout),this._timeout=void 0,this._trySendAfterTimeout())}return this._flushPromise},t.prototype._trySendAfterTimeout=function(){var e=this;this._timeout||(this._timeout=setTimeout(function(){e._timeout=void 0,e._fsm.is(f.States.READY)&&(e._changesQueue.isEmpty||e._changesQueue.isStaging?(e._changesQueue.isEmpty&&e._resolvePendingFlushPromise(),e._trySendAfterTimeout()):e._send().catch(function(t){return e._log.warn("unexpected error onsend",t)}))},this._changesQueue.size>1||this._forceSend?this._changesQueue.isStaging?250:0:this._sendDelay))},t.prototype._send=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n=this;return r.__generator(this,function(i){switch(i.label){case 0:return[4,this._fsm.event(f.Events.SEND)];case 1:return(e=i.sent())?(t=this._changesQueue.poll(),[4,t.map(function(e){return r.__awaiter(n,void 0,void 0,function(){var t,n,i;return r.__generator(this,function(r){switch(r.label){case 0:t=p.ChangesQueue.isChange(e),n=this._createMessage(e),this._log.isEnabled(o.Logging.LogLevel.TRACE)&&this._log.trace("Message >>>",{message:JSON.stringify(n)}),r.label=1;case 1:return r.trys.push([1,5,,6]),[4,this._conn.send(n)];case 2:return r.sent(),t?[3,4]:[4,this._fsm.event(f.Events.ACK)];case 3:r.sent()?this._changesQueue.ack():this._log.debug("can not do ack for non change msg because we are in unexpected state",{state:f.States[this._fsm.current]}),r.label=4;case 4:return[3,6];case 5:return i=r.sent(),this._log.debug("Got error on ws send",{error:i}),[3,6];case 6:return[2]}})})})]):[3,3];case 2:return i.sent(),[3,5];case 3:return this._log.debug("we are can not send, goto connect"),[4,this._fsm.event(f.Events.CONNECT)];case 4:i.sent(),i.label=5;case 5:return[2]}})})},t.prototype._sendInbandCommand=function(e){this._checkIdle();var t=this._changesQueue.isEmpty;return this._changesQueue.pushCommand(e),t&&this._fsm.is(f.States.READY)&&(this._log.trace("Q.isEmpty, sending command immidiately",e),this._send()),e.id},t.prototype._createMessage=function(e){switch(e.kind){case"change":return this._createPatchMessage(e.change);case"meta":return this._createUpdateMetaMessage(e.meta);case"cmd":return e.cmd;default:return s.assertNever(e)}},t.prototype._createPatchMessage=function(e){return new d.Message.PatchMessage(this._nextId++,this._clientId,this._revision,e.prevLen,[e.delta])},t.prototype._createUpdateMetaMessage=function(e){var t=e.title,n=e.errors,r=e.settings;return new d.Message.UpdateDocumentMetadata(this._nextId++,t,n,void 0!==r?r.toJSON():void 0)},t}(f.Remote);t.DoxRemoteDocument=m,function(e){!function(e){function t(e){var t=e.title,n=e.errors,r=e.extra_params,o=e.proofit;return{title:t,errors:n,settings:h.DoxDocumentSettings.Holder.fromJSON(r),proofit:i.Option.of(o).map(a.Proofit.parseResult)}}e.parse=t}(e.Meta||(e.Meta={}));var t=function(){function t(t){this._handler=t,this.changeHandler=this._handler.changeHandler||s.noop,this.metadataChangeHandler=this._handler.metadataChangeHandler||s.noop,this.disconnectHandler=this._handler.disconnectHandler||e._defaultReconnect}return t}();e.DefaultHandler=t;!function(e){var t=function(){function e(e){this._handler=e,this.acceptedMsgHandler=this._handler.acceptedMsgHandler||function(){},this.droppedMsgsHandler=this._handler.droppedMsgsHandler||function(){}}return e}();e.DefaultHandler=t,e.create=function(e){var n=new t(e),r=n.acceptedMsgHandler,i=n.droppedMsgsHandler;return new p.DoxQueue(r,i)}}(e.Queue||(e.Queue={}))}(m=t.DoxRemoteDocument||(t.DoxRemoteDocument={})),t.DoxRemoteDocument=m},294:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(18),o=n(208);!function(e){function t(e){var t=e.checks,n=e.genre,r=e.context,i=e.extraSettings;return{apps:t.map(c).getOrElse(void 0),genre:n.getOrElse(void 0),context:r.map(o.DocumentContext.serialize).getOrElse(void 0),extraSettings:i.getOrElse(void 0)}}function n(t){return t?i.Try.of(function(){return{checks:i.Option.of(u(t.apps)),genre:i.Option.of(t.genre),context:i.Option.of(o.DocumentContext.parse(t.context)),extraSettings:i.Option.of(t.extraSettings)}}).getOrElse(e.empty):e.empty}function s(e,t){return{checks:e.checks,extraSettings:h.merge(e.extraSettings,t.extraSettings),genre:i.Option.of(t.genre).orElse(e.genre),context:i.Option.of(t.context).orElse(e.context)}}function a(e){return e.context.orElse(e.genre.map(o.genreToDocumentContext)).getOrElse(o.DocumentContext.empty)}function c(e){return e?{ContextualSpelling:{active:e.contextualSpelling},Enhancement:{active:e.enhancement},Grammar:{active:e.grammar},Plagiarism:{active:e.plagiarism},Punctuation:{active:e.punctuation},SentenceStructure:{active:e.sentenceStructure},Style:{active:e.style}}:null}function u(e){return e&&l(e)?{contextualSpelling:e.ContextualSpelling.active,grammar:e.Grammar.active,sentenceStructure:e.SentenceStructure.active,punctuation:e.Punctuation.active,style:e.Style.active,enhancement:e.Enhancement.active,plagiarism:e.Plagiarism.active}:null}function l(e){return!!e&&![e.ContextualSpelling,e.Enhancement,e.Grammar,e.Plagiarism,e.Punctuation,e.SentenceStructure,e.Style].map(function(e){return e&&"object"==typeof e&&"boolean"==typeof e.active}).some(function(e){return!e})}e.update=s,e.contextOrGenre=a,e.empty={checks:i.None,genre:i.None,context:i.None,extraSettings:i.None};var d=function(){function e(e){this._settings=e}return e.fromJSON=function(t){return new e(n(t))},Object.defineProperty(e.prototype,"genre",{get:function(){var e=this;return this._settings.genre.orElseL(function(){return e._settings.context.map(function(e){return o.domainToGenre(e.domain)})})},enumerable:!0,configurable:!0}),e.prototype.changeGenre=function(e){var t={genre:i.Some(e)};return this._settings.context.forEach(function(){t.context=i.Some(o.DocumentContext.fromDomain(o.genreToDomain(e)))}),this._update(t)},Object.defineProperty(e.prototype,"checks",{get:function(){return this._settings.checks},enumerable:!0,configurable:!0}),e.prototype.changeChecks=function(e){var t={checks:i.Some(e)};return this._update(t)},Object.defineProperty(e.prototype,"context",{get:function(){var e=this;return this._settings.context.orElseL(function(){return e._settings.genre.map(o.genreToDocumentContext)})},enumerable:!0,configurable:!0}),e.prototype.changeContext=function(e){var t={context:i.Some(e)};return this._settings.genre.forEach(function(){t.genre=i.Some(o.domainToGenre(e.domain))}),this._update(t)},Object.defineProperty(e.prototype,"extraSettings",{get:function(){return this._settings.extraSettings},enumerable:!0,configurable:!0}),e.prototype.changeExtra=function(e){var t={extraSettings:i.Some(e)};return this._update(t)},e.prototype.toJSON=function(){return t(this._settings)},e.prototype._update=function(t){return new e(r.__assign({},this._settings,t))},e}();e.Holder=d;var h;!function(e){function t(e,t){return e.fold(function(){return i.Option.of(t)},function(e){return i.Option.of(Object.assign({},e,t))})}e.empty={},e.merge=t}(h=e.Extra||(e.Extra={})),e.fromCheckingSettings=c,e.toCheckingSettings=u}(t.DoxDocumentSettings||(t.DoxDocumentSettings={}))},295:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(18),o=n(60),s=n(97),a=function(){function e(e,t,n){this._doxUrl=e,this._fetch=t,this._token=n,this._clientType="web",this._ajax=o.Ajax.factory(this._fetch,"include",s.DoxErrors.doxErrorMapper)}return e.prototype._processOptions=function(t){var n=t.words,r=t.turnaroundOptions;return r&&r.length||(r=[]),{words:n,turnaroundOptions:r.map(function(t){return{enabled:t.enabled,label:t.label,minutesToProcess:t.minutesToProcess,perWord:t.perWord,price:t.price,turnaround:e.parsePlanOption(t.turnaround)}})}},e.prototype.getOptions=function(e){var t=o.RequestBuilder.get(this._doxUrl,"documents/"+e+"/proofit/turnaroundOptions");return this._ajax(this._prepareRequest(t).build()).then(this._processOptions)},e.prototype.createJob=function(t){var n=t.docId,r=t.turnaround,i=e.PlanType[r],s=o.RequestBuilder.post(this._doxUrl,"documents/"+n+"/proofit/job").queryParam("turnaround",i);return this._ajax(this._prepareRequest(s).build()).then(e.parseCreateJobResult)},e.prototype._prepareRequest=function(e){return this._token&&e.cookie("grauth",this._token),e.header("X-API-Version","1").header("X-Client-Type",this._clientType)},Object.defineProperty(e.prototype,"clientType",{set:function(e){this._clientType=e},enumerable:!0,configurable:!0}),e.targetTag="proofit",e}();t.Proofit=a,function(e){function t(e){switch(e){case"New":return l.newJob;case"Building":return l.building;case"paymentError":return l.paymentError;case"duplicate":return l.duplicate;case"emptyDocument":return l.emptyDocument;case"Completed":return l.completed;case"Cancelled":return l.cancelled;default:return l.unknown}}function n(e){switch(e){case"Instant":return d.Instant;case"ThreeHours":return d.ThreeHours;case"TwentyFourHours":return d.TwentyFourHours;default:throw new Error("Unknown plan option "+e)}}function o(e){if(!e)return null;try{e.match(/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/)&&(e=e.replace(/\s/,"T"));return new Date(e).getTime()}catch(e){return null}}function s(e){return{submitted:o(String(e.submitted)),corrections:e.corrections,due:o(String(e.due)),price:e.price,name:e.name,completed:i.Option.of(o(String(e.completed))),id:e.id,status:t(e.status),is_dox_applied:e.is_dox_applied}}function a(e){var n=e.data;return{jobId:n.jobId,status:t(n.status),token:n.token}}function c(e,t){if(e||t){if(!e&&t||e&&!t)return!1;var n=e,r=t;return n.id===r.id&&n.status===r.status&&n.completed.equals(r.completed)}return!0}function u(e){return r.__assign({},h,e)}var l;!function(e){e.paymentError="paymentError",e.duplicate="duplicate",e.emptyDocument="emptyDocument",e.newJob="newJob",e.building="building",e.completed="completed",e.cancelled="cancelled",e.unknown="unknown"}(l=e.JobStatus||(e.JobStatus={}));var d;!function(e){e[e.Instant=0]="Instant",e[e.ThreeHours=1]="ThreeHours",e[e.TwentyFourHours=2]="TwentyFourHours"}(d=e.PlanType||(e.PlanType={})),e.processOptions=function(e){var t=e.data;return{words:t.words,turnaroundOptions:(t.turnaroundOptions||[]).map(function(e){return{enabled:e.enabled,label:e.label,minutesToProcess:e.minutesToProcess,perWord:e.perWord,price:e.price,turnaround:n(e.turnaround)}})}},e.parseStatus=t,e.parsePlanOption=n,e.parseResult=s,e.parseCreateJobResult=a,e.isProofitEqual=c;var h={corrections:null,price:null,submitted:null,due:null,name:"proofit-document-1474459282219.docx",completed:null,id:15696089,status:l.newJob,is_dox_applied:!0};e.mockResult=u}(a=t.Proofit||(t.Proofit={})),t.Proofit=a},296:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(14),o=n(8),s=n(5),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._subs=null,t}return r.__extends(t,e),t.prototype._setupTitle=function(){return s.RxUtils.toObservable(this.props.title).filter(function(e){return null!==e}).subscribe(function(e){return document.title=e})},t.prototype.componentWillMount=function(){this._subs=this._setupTitle()},t.prototype.componentWillUnmount=function(){this._subs&&this._subs.unsubscribe(),this._subs=null},t.prototype.render=function(){return i.Children.only(this.props.children)},t}(i.Component);t.BasePage=a,function(e){e.PageWrapper=function(e){var t=e.children;return i.createElement(o.F.div,{key:"page-wrapper"},t)}}(a=t.BasePage||(t.BasePage={})),t.BasePage=a},297:function(e,t,n){"use strict";function r(e,t,n,r){switch(t.kind){case"common":return new o.CommonCardModelImpl(e,t,n,r);case"plagiarism":return new o.PlagiarismCardModelImpl(e,t,n);case"enhancement":return new o.EnhancementCardModelImpl(e,t,n,r);case"synonym":return new o.SynonymsCardModelImpl(e,t,n);default:var i=t;throw new a.MatchingNotExhaustiveError(i)}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(8),o=n(302),s=n(585),a=n(5);t.defaultState={cardHeights:{},cardStates:{}};var c=function(){function e(e,t,n){var r=this;this._state=e,this._editor=t,this._features=n,this._cardsHeights=this._state.lens("cardHeights"),this._cardsState=this._state.lens("cardStates"),this.positions=i.Atom.combine(this._editor.alerts,this._cardsHeights,function(e,t){return s.getCardsPositions(Object.keys(e).reduce(function(n,r){return n[r]={alert:e[r],cardHeight:t[r]||o.DEFAULT_CARD_HEIGHT},n},{}))}),this.focusedCardHeight=this._editor.focusedAlert.switchMap(function(e){return r._cardsHeights.view(function(t){return e.id?t[e.id]:null})}),this.guideId=i.Atom.combine(this._editor.highlightedAlert,this._editor.focusedAlert,function(e,t){if(!e)return null;var n=t.id&&r._cardsState.get()[t.id];return e===t.id&&!n||n&&n.transientVisualState!==o.VisualState.applied?null:e})}return e.prototype.setCardHeight=function(e,t){this._cardsHeights.modify(function(n){return Object.assign({},n,(r={},r[e]=t,r));var r})},e.prototype.getOrCreateCardModel=function(e){var t=this._editor.alerts.get()[e];a.invariant(null!==t,"expect alert #"+e+" to exist");var n="synonym"===t.alert.kind?o.defaultSynonymState:o.defaultState;return this._cardsState.modify(function(t){return t[e]?t:Object.assign({},t,(r={},r[e]=n,r));var r}),r(this._cardsState.lens(i.Lens.key(e).compose(i.Lens.withDefault(n))),t.alert,this._editor,this._features)},e.prototype.removeCardModelState=function(e){this._cardsState.modify(function(t){return a.ObjectUtils.objectWithoutProperties(t,[e])})},e}();t.CardsModelImpl=c},298:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.words=0]="words",e[e.characters=1]="characters",e[e.speakingTime=2]="speakingTime",e[e.readingTime=3]="readingTime"}(r=t.TextStatsView||(t.TextStatsView={})),t.defaultState={textStatsView:r.words};var i=[r.words,r.characters,r.readingTime,r.speakingTime],o=function(){function e(e){this._state=e,this.textStatsView=this._state.lens("textStatsView")}return e.prototype.toggleTextStatsView=function(){this.textStatsView.set(i[(i.indexOf(this.textStatsView.get())+1)%i.length])},e}();t.TextStatsModelImpl=o},299:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(43),o=n(53);t.PaymentPlan=o.PaymentPlan,t.PaymentMethod=o.PaymentMethod;var s=n(8),a=n(6),c=n(5),u=n(207),l=n(1396),d=n(1397),h=n(38),p=n(582),f=n(99);t.defaultState=c.Async.defaultValue();var g=function(){function e(n,r,a,h,p,g,m,_){var y=this;this.state=n,this._irbisApi=r,this._subscribeUrl=a,this._upgradeBaseUrl=h,this._browserType=p,this._telemetry=g,this._appConfig=m,this._userId=_,this._notification=s.Atom.create(null),this._operation=null,this._getSubsciption=function(){return y._irbisApi.getStatus().then(function(e){return e.plans||(e.plans=[]),e})},this._updateSubscriptionState=function(){return y._getSubsciption().then(function(e){return y.state.set(c.Async.ok(e)),e})},this._diagnostics=new o.Diagnostics(""+this._appConfig.api.diagnosticsUrl,f.RxFetch.request(o.Diagnostics.targetTag)),this.notification=this._notification,this.braintreeApi=new l.BraintreeModelImpl(this,this._irbisApi,this._updateSubscriptionState),this.paypalApi=new d.PayPalModelImpl(this,this._irbisApi,this._updateSubscriptionState),this.browserType=this._browserType,this.ensureHasSubscription=function(){i.invariant(null!==y._operation,"operation must be created"),y._operation=y._operation;var e=y.state.get();c.Async.isOk(e)||c.Async.isInProgress(e)||(c.Async.isError(e)&&y._operation.unsubscribe(),y._operation=null,y.state.set(t.defaultState),y._createOperation())},this.setNotification=function(e,t){requestAnimationFrame(function(){return y._notification.set({type:e,planName:t})})},this._createOperation(),this.state.subscribe(function(t){c.Async.isError(t)&&1===t.attempt?e._log.warn("cant get user subscription",t.error):c.Async.isFatal(t)&&(e._log.error("cant get user subscription",t.error),y.setNotification(u.SubscriptionNotificationType.unknownError))})}return e.prototype.clearNotification=function(){this._notification.set(null)},e.prototype.changePlan=function(t){var n=this;return this.clearNotification(),this._irbisApi.changePlan(t).then(this._updateSubscriptionState).then(function(e){n.setNotification(u.SubscriptionNotificationType.subscriptionUpdated,e.queuedPlan&&e.queuedPlan.title||e.currentPlan.title)}).catch(function(t){n.setNotification(u.SubscriptionNotificationType.cantUpgradeSubscription),e._log.error("changePlan: cantUpgradeSubscription",t)})},e.prototype.cancelSubscription=function(){var t=this;return this._telemetry.confirmSubscriptionCancelClicked(),this.clearNotification(),this._irbisApi.cancelSubscription().then(this._updateSubscriptionState).then(function(){return t.setNotification(u.SubscriptionNotificationType.subscriptionCancelled)}).catch(function(n){t.setNotification(u.SubscriptionNotificationType.unknownError),e._log.error("cancelSubscription: unknownError",n)})},e.prototype.renewSubscription=function(){var t=this;return this._telemetry.reactivateSubscriptionClicked(),this.clearNotification(),this._irbisApi.renewSubscription().then(this._updateSubscriptionState).then(function(){return t.setNotification(u.SubscriptionNotificationType.resumedSubscription)}).catch(function(n){t.setNotification(u.SubscriptionNotificationType.cantResumeSubscription),e._log.error("renewSubscription: cantResumeSubscription",n)})},e.prototype.navigateToSubscribeUrl=function(){document.location.href=this._subscribeUrl},e.prototype.navigateToUpgradeUrl=function(e,t,n){var r=p.getUpgradeUrl(this._upgradeBaseUrl,e,t,n);window.parent===window?c.DesktopEditor.actions.openUpgradeUrl(r,this._appConfig,this._userId)||(document.location.href=r):c.Extension.actions.openUrl(r)},e.prototype.downloadBillingReceipts=function(){return r.__awaiter(this,void 0,void 0,function(){var t,n=this;return r.__generator(this,function(r){switch(r.label){case 0:return this._notification&&this.clearNotification(),h.isFetchBlobDownloadSupported?[4,this._diagnostics.checkOrigin().catch(function(t){return e._log.error("orginDiagnostics: cantCheck",t),{isOkay:!1,url:"unable to verify"}})]:[3,7];case 1:return t=r.sent(),t.isOkay?(this._telemetry.downloadReceiptButtonClicked(),[4,this._irbisApi.downloadBillingReceipts().then(o.RawFile.saveToFS).catch(function(t){n.setNotification(u.SubscriptionNotificationType.unknownError),e._log.error("originDiagnostics: unknownError",t),n._telemetry.downloadReceiptError(t)})]):[3,3];case 2:return r.sent(),[3,6];case 3:return[4,this.setNotification(u.SubscriptionNotificationType.unknownOrigin)];case 4:return r.sent(),[4,e._log.error("originDiagnostics: unknownOrigin",{origin:t.url})];case 5:r.sent(),r.label=6;case 6:return[3,8];case 7:this.setNotification(u.SubscriptionNotificationType.blobDownloadUnsupported),r.label=8;case 8:return[2]}})})},e.prototype._createOperation=function(){i.invariant(null===this._operation,"cant create another operation"),this._operation=c.Async.OperationRetrier.create(this._getSubsciption,this.state,c.Async.OperationRetrier.RetryStrategy.conditional(function(e){return 401!==e.code},c.Async.OperationRetrier.RetryStrategy.linear(3,3e3)))},e._log=a.Monitoring.Logging.getLogger("model.subscription"),e}();t.SubscriptionModelImpl=g},300:function(e,t,n){"use strict";function r(e){var t=Math.floor(e/3600),n=Math.floor((e-3600*t)/60);return{h:t,m:n,s:e-3600*t-60*n}}function i(e){return s.padStart(String(e),2,"0")}function o(e,t){var n=void 0===t?{}:t,o=n.short,a=void 0!==o&&o,c=n.withSec,u=void 0!==c&&c,l=r(e),d=l.h,h=l.m,p=l.s,f=[];return d>0&&f.push(i(d)+" "+(a?"h":s.pluralize(d,"hour","hours"))),(h>0||!u)&&f.push(i(h)+" "+(a?"min":s.pluralize(h,"minute","minutes"))),u&&f.push(i(p)+" "+(a?"sec":s.pluralize(p,"second","seconds"))),f.join(" ")}Object.defineProperty(t,"__esModule",{value:!0});var s=n(150);t.MS_IN_SEC=1e3,t.MS_IN_MIN=60*t.MS_IN_SEC,t.MS_IN_HOUR=60*t.MS_IN_MIN,t.MS_IN_DAY=24*t.MS_IN_HOUR,t.secondsToTime=r,t.formatTime=o},301:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(14),o=n(8),s=n(855);t.Spinner=function(e){var t=e.className,n=void 0!==t&&t,a=e.size,c=void 0===a?18:a,u=e.color,l=void 0===u?"#666":u,d={width:c+"px",height:c+"px",backgroundColor:l};return i.createElement("div",r.__assign({},o.classes(s.spinner,n)),i.createElement("div",{style:d,className:s.item}),i.createElement("div",{style:d,className:s.item}),i.createElement("div",{style:d,className:s.item}))}},302:function(e,t,n){"use strict";function r(e){var t=e.category,n=e.extraProperties,r=e.todo;return"Unknown"===t?"Unknown word":"Misspelled"===t?"":n.isDidYouMean||n.isShowTitle?"Check word usage":r}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=n(8),s=n(6),a=n(98),c=n(575);t.CommonHeaderModel=c.CommonHeaderModel;var u=n(304),l=n(5);t.DEFAULT_CARD_HEIGHT=36;var d;!function(e){e[e.expanded=0]="expanded",e[e.expandedMore=1]="expandedMore",e[e.collapsed=2]="collapsed",e[e.applied=3]="applied",e[e.hidden=4]="hidden"}(d=t.VisualState||(t.VisualState={})),t.defaultState={hovered:!1,expandButtonHovered:!1,undoButtonHovered:!1,transientVisualState:d.collapsed},t.defaultSynonymState={hovered:!1,expandButtonHovered:!1,undoButtonHovered:!1,transientVisualState:d.expanded};var h=function(){function e(e,t){this._state=e,this._focused=t,this._transientVisualState=this._state.lens("transientVisualState"),this.visualState=o.Atom.combine(this._transientVisualState,this._focused,function(e,t){return t?e===d.collapsed?d.expanded:e:e===d.expanded||e===d.expandedMore?d.collapsed:e}),this.isExpanded=this._transientVisualState.view(function(e){return e===d.expanded}),this.isExpandedMore=this._transientVisualState.view(function(e){return e===d.expandedMore}),this.isApplied=this._transientVisualState.view(function(e){return e===d.applied}),this.isHidden=this._transientVisualState.view(function(e){return e===d.hidden}),this.isActive=this._transientVisualState.view(function(e){return e===d.expanded||e===d.expandedMore}),this.isExpandButtonHovered=this._state.lens("expandButtonHovered"),this.isUndoButtonHovered=this._state.lens("undoButtonHovered"),this.isCardHovered=this._state.lens("hovered")}return e.prototype._transitionState=function(e,t){var n,r,i=this;if(this._transientVisualState.modify(function(t){var o=i.visualState.get(),s=e.find(function(e){return void 0!==e.from.find(function(e){return o===e})});if(s)return n=o,r=s.to,s.to;throw new TypeError("Can't transition Card from "+d[o])}),void 0===n||void 0===r)throw new l.InvariantError("Expected modify to complete by this point");t&&t(n,r)},e}();t.CardModelStateImpl=h;var p=function(e){function t(t,n,r){var i=e.call(this,t,r.isFocused(n.id))||this;return i._editorEngine=r,i.replace=function(e){i._applyThisAlert({action:"replace",replacementText:e,isSynonym:!1})},i.id=n.id,i.title=n.title,i}return i.__extends(t,e),t.prototype.toggleExpand=function(){var e=this.visualState.get()===d.collapsed;e?this._editorEngine.setFocusedAlert(this.id,"click"):(this._editorEngine.setHighlightedAlert(null),this._editorEngine.setFocusedAlert(null,null)),this._transitionState([{from:[d.expanded,d.expandedMore],to:d.collapsed},{from:[d.collapsed],to:d.expanded}]),e&&t._cardExpandCounter.increment()},t.prototype.hoverExpandButton=function(){this.isExpandButtonHovered.set(!0)},t.prototype.unhoverExpandButton=function(){this.isExpandButtonHovered.set(!1)},t.prototype.hoverUndoButton=function(){this.isUndoButtonHovered.set(!0)},t.prototype.unhoverUndoButton=function(){this.isUndoButtonHovered.set(!1)},t.prototype.hoverCard=function(){this._editorEngine.setHighlightedAlert(this.id),this.isCardHovered.set(!0)},t.prototype.unhoverCard=function(){this._editorEngine.setHighlightedAlert(null),this.isCardHovered.set(!1)},t.prototype.toggleMore=function(){this._transitionState([{from:[d.expanded],to:d.expandedMore},{from:[d.expandedMore],to:d.expanded}])},t.prototype.expand=function(){this._transitionState([{from:[d.collapsed],to:d.expanded}])},t.prototype.collapse=function(){this._transitionState([{from:[d.expanded,d.expandedMore],to:d.collapsed}])},t.prototype.showMore=function(){this._transitionState([{from:[d.expanded],to:d.expandedMore}])},t.prototype.showLess=function(){this._transitionState([{from:[d.expandedMore],to:d.expanded}])},t.prototype.hide=function(){this._transitionState([{from:[d.applied],to:d.hidden}])},t.prototype._applyThisAlert=function(e){this._editorEngine.applyAlert(this.id,e),this._transitionState([{from:[d.expanded,d.expandedMore,d.collapsed],to:d.applied}]),t._cardApplyCounter.getCounter(e.action).increment()},t.prototype.ignore=function(){this._applyThisAlert({action:"ignore"})},t.prototype.acknowledge=function(){this._applyThisAlert({action:"acknowledge"})},t.prototype.addToDictionary=function(){this._applyThisAlert({action:"addToDictionary"})},t.prototype.undoInteraction=function(){this._editorEngine.undoLastAlertAction(),this.unhoverUndoButton(),this._transitionState([{from:[d.applied],to:d.collapsed}])},t._cardExpandCounter=s.Monitoring.TimeSeries.root.getCounter("cards.expand"),t._cardApplyCounter=s.Monitoring.TimeSeries.root.getCounter("cards.apply"),t}(h);t.CardModelBaseImpl=p;var f=function(e){function t(t,n,r,i){var o=e.call(this,t,n,r)||this;return o._alert=n,o._features=i,o.kind="common",o.highlightText=o._alert.highlightText,o.isTextCard=u.isNoReplacement(o._alert.replacements),o.isUnknowWord="Unknown"===o._alert.category,o.details=o._alert.details,o.examples=o._alert.examples,o.explanation=o._alert.explanation,o.extraProperties=o._alert.extraProperties,o.hasReplacementsInContent=!u.isNoReplacement(o._alert.replacements)&&!!o.extraProperties.isShowTitle,o.hasAcknowledgeButton=0===o._alert.replacements.length&&o._alert.group!==a.AlertGroup.contextualSpelling,o.hasAddToDictionary=!!o._alert.extraProperties.hasAddToDictionary,o.showFullCard=o._features.showFullCards.get().enabled,o.isShowMore=Boolean(!o.showFullCard&&(o.details||o.examples&&o.examples.length)),o.hideTitleInEDUCard=o._features.hideTitleInEDUCard.get().enabled,o}return i.__extends(t,e),t.prototype.getHeader=function(e,t){return new c.CommonHeaderModelImpl(this.title,this._alert.todo,this._alert.replacements,e,t,this._alert.extraProperties,this._features.quickReplacementsInCard.get().enabled,this.replace)},t.prototype.getFooterProps=function(){return{hasAcknowledgeButton:this.hasAcknowledgeButton,hasAddToDictionary:this.hasAddToDictionary,isShowMore:this.isShowMore}},t.prototype.getReplacements=function(){var e=this._alert,t=e.category,n=e.extraProperties,i=e.todo;return u.getReplacementListModel({title:r({category:t,extraProperties:n,todo:i}),replacements:this._alert.replacements,onReplace:this.replace})},t}(p);t.CommonCardModelImpl=f;var g=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;return i._alert=n,i.kind="plagiarism",i.url=i._alert.url,i.description=i._alert.description,i.reference=i._alert.reference,i}return i.__extends(t,e),t.prototype.getHeader=function(e,t){return new c.PlagiarismHeaderModelImpl(this.title,e,t,this._alert.url)},t}(p);t.PlagiarismCardModelImpl=g;var m=function(e){function t(t,n,r,i){var o=e.call(this,t,n,r)||this;return o._alert=n,o._features=i,o.kind="enhancement",o.details=o._alert.details,o.examples=o._alert.examples,o.explanation=o._alert.explanation,o.hasReplacements=!u.isNoReplacement(o._alert.replacements),o.hasAcknowledgeButton=!o.hasReplacements,o.hasAddToDictionary=!1,o.showFullCard=o._features.showFullCards.get().enabled,o.isShowMore=Boolean(!o.showFullCard&&(o.details||o.examples&&o.examples.length)),o.isVisibleQuickReplacement=o._features.quickReplacementsInCard.get().enabled,o}return i.__extends(t,e),t.prototype.getReplacements=function(){var e=this._alert,t=e.category,n=e.extraProperties,i=e.todo;return u.getReplacementListModel({title:r({category:t,extraProperties:n,todo:i}),replacements:this._alert.replacements,onReplace:this.replace})},t.prototype.getHeader=function(e,t){return new c.EnhancementHeaderModelImpl(this.title,e,t,this.isVisibleQuickReplacement)},t.prototype.getFooterProps=function(){return{hasAcknowledgeButton:this.hasAcknowledgeButton,hasAddToDictionary:this.hasAddToDictionary,isShowMore:this.isShowMore}},t}(p);t.EnhancementCardModelImpl=m;var _=function(e){function t(t,n,r){var i=e.call(this,t,r.isFocused(n.id))||this;return i._alert=n,i._editorEngine=r,i.kind="synonyms",i.visualState=i._transientVisualState,i.replace=function(e){i._applyThisAlert({action:"replace",replacementText:e,isSynonym:!0})},i.id=i._alert.id,i.title=i._alert.title,i.explanation="",i.details="",i.examples=[],i.meanings=i._alert.meanings.map(function(e){return{title:e.title,list:u.getReplacementFlatListModel({title:e.title,replacements:e.replacements,onReplace:function(e){return i.replace(e)}})}}),i.isAnyMeanings=Boolean(i.meanings.length),i}return i.__extends(t,e),t.prototype._applyThisAlert=function(e){this._editorEngine.applyAlert(this.id,e),this._transitionState([{from:[d.expanded,d.expandedMore,d.collapsed],to:d.applied}])},t.prototype.hide=function(){this._transitionState([{from:[d.applied],to:d.hidden}])},t.prototype.collapse=function(){this._transientVisualState.get()!==d.hidden&&this._transitionState([{from:[d.expanded],to:d.hidden}])},t.prototype.undoInteraction=function(){this._editorEngine.undoLastAlertAction(),this._transitionState([{from:[d.applied],to:d.expanded}])},t.prototype.select=function(){this._editorEngine.setHighlightedAlert(this.id)},t.prototype.deselect=function(){this._editorEngine.setHighlightedAlert(null)},t}(h);t.SynonymsCardModelImpl=_},303:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(18),o=n(8),s=n(23);!function(e){!function(e){e.checking="checking",e.checkingIn="checkingIn",e.checkingOut="checkingOut"}(e.Type||(e.Type={}));!function(e){e.loading="loading",e.processing="processing"}(e.TextType||(e.TextType={}));!function(t){function n(e){var t=e.lens.filter(function(e){return"checkingOut"!==e}).nonEmpty()?"on":"off",n=e.navigation.filter(function(e){return"checkingOut"!==e}).nonEmpty()?"on":"off";return"text: "+e.text.getOrElse("off")+"; lens: "+t+"; nav: "+n}t.idle={text:i.None,lens:i.None,navigation:i.None},t.text={text:i.Some(e.TextType.loading),lens:i.None,navigation:i.None},t.processing={text:i.Some(e.TextType.processing),lens:i.Some(e.Type.checking),navigation:i.Some(e.Type.checking)},t.loading={text:i.Some(e.TextType.loading),lens:i.Some(e.Type.checking),navigation:i.Some(e.Type.checking)},t.toString=n}(e.State||(e.State={}))}(r=t.DocumentLoader||(t.DocumentLoader={}));var a=function(){function e(){this.state=o.Atom.create(r.State.idle)}return e}();t.DocumentLoaderContextImpl=a,t.documentLoaderContext={documentLoader:s.object}},304:function(e,t,n){"use strict";function r(e){return e.map(function(e){return e.transform}).every(function(e){return e.every(function(e){return"delete"!==e.type})})&&2===e.length}function i(e){return 1===e.length}function o(e){return e.reduce(function(e,t){return e+("arrow"!==t.type?t.text.length:0)},0)>35}function s(e){var t=e.filter(function(e){return"delete"===e.type});if(0===t.length)return!1;var n=t[0],r=n.text.replace(/,/g,"").split(" ").filter(Boolean)||[];return n.text.match(/^,(.*?),$/)&&n.text.length>2&&r.length>1}function a(e){return!e||0===e.length}function c(e){var t=e.isDidYouMean,n=e.isActive,c=e.replacements,u=e.todo,l=e.onReplace;if(a(c))return new p;var y="Click to "+u;return t?new m(y,c[0],l):r(c)?new d(y,c[0],c[1],l):o(c[0].transform)?new _(y,c,l):s(c[0].transform)?new g(y,c[0],l):i(c)?new f(y,c[0],l):new h(y,n,c,l)}Object.defineProperty(t,"__esModule",{value:!0});var u,l=n(2);!function(e){e[e.or=0]="or",e[e.single=1]="single",e[e.list=2]="list",e[e.flatList=3]="flatList",e[e.multi=4]="multi",e[e.multiExpanded=5]="multiExpanded",e[e.long=6]="long",e[e.didYouMean=7]="didYouMean",e[e.sideCommas=8]="sideCommas",e[e.empty=9]="empty"}(u=t.CardReplacementTemplate||(t.CardReplacementTemplate={})),t.isOrReplacement=r,t.isSingleReplacement=i,t.isLongReplacement=o,t.isSideCommasReplacement=s,t.isNoReplacement=a;var d=function(){function e(e,t,n,r){var i=this;this.tooltipText=e,this._replacement1=t,this._replacement2=n,this._onReplace=r,this.template=u.or,this.transform1=this._replacement1.transform,this.transform2=this._replacement2.transform,this.onReplace1=function(){return i._onReplace(i._replacement1.newText)},this.onReplace2=function(){return i._onReplace(i._replacement2.newText)}}return e}();t.CardReplacementOr=d;var h=function(){function e(e,t,n,r){var i=this;this.tooltipText=e,this.isExpanded=t,this.replacements=n,this._onReplace=r,this.getOnReplace=function(e){return function(){return i._onReplace(e.newText)}},this.template=this.isExpanded?u.multiExpanded:u.multi}return e.prototype.getTitleReplacement=function(){return new f(this.tooltipText,this.replacements[0],this._onReplace)},e}();t.CardReplacementMulti=h;var p=function(){function e(){this.template=u.empty,this.tooltipText=""}return e}();t.EmptyReplacement=p;var f=function(){function e(e,t,n){var r=this;this.tooltipText=e,this._replacement=t,this._onReplace=n,this.transform=this._replacement.transform,this.onReplace=function(){return r._onReplace(r._replacement.newText)},this.template=u.single}return e}();t.CardReplacementSingle=f;var g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.template=u.sideCommas,t}return l.__extends(t,e),t}(f);t.CardReplacementSideCommas=g;var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.template=u.didYouMean,t}return l.__extends(t,e),t}(f);t.CardReplacementDidYouMean=m;var _=function(){function e(e,t,n){var r=this;this.tooltipText=e,this.replacements=t,this._onReplace=n,this.getOnReplace=function(e){return function(){return r._onReplace(e.newText)}},this.template=u.long}return e}();t.CardReplacementLong=_;var y=function(){function e(e,t,n){var r=this;this.headerText=e,this.replacements=t,this._onReplace=n,this.template=u.list,this.tooltipText="",this.getOnReplace=function(e){return function(){return r._onReplace(e.newText)}}}return e}();t.CardReplacementList=y;var v=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;return i.headerText=t,i.template=u.flatList,i}return l.__extends(t,e),t}(y);t.CardReplacementFlatList=v,t.getReplacementModel=c,t.getReplacementListModel=function(e){var t=e.title,n=e.replacements,r=void 0===n?[]:n,i=e.onReplace;return new y(t,r,i)},t.getReplacementFlatListModel=function(e){var t=e.title,n=e.replacements,r=void 0===n?[]:n,i=e.onReplace;return new v(t,r,i)}},305:function(e,t,n){"use strict";function r(e){return e.view(function(e){return{enabled:!e.enabled}})}Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(8),s=n(571),a=n(288),c=n(18),u=n(551),l=n(119),d=n(5);!function(e){!function(e){e.AA="AA",e.BB="BB",e.CC="CC",e.UNKNOWN_TS="UNKNOWN_TS",e.UNKNOWN_DN="UNKNOWN_DN"}(e.WootricGroup||(e.WootricGroup={}));!function(e){e.simple="simple",e.loader="loader"}(e.OpenOnPasteOrUploadMode||(e.OpenOnPasteOrUploadMode={}));!function(e){e.small="small",e.large="large"}(e.CounterType||(e.CounterType={}))}(i=t.DenaliFeatures||(t.DenaliFeatures={}));var h;!function(e){e[e.CRITICAL_ADVANCED=0]="CRITICAL_ADVANCED",e[e.FREE_PREMIUM=1]="FREE_PREMIUM"}(h=t.AlertGroupNames||(t.AlertGroupNames={}));var p=function(){function e(e,t,n,r,i,o){this._userProfile=e,this._settings=t,this._router=n,this._experiments=r,this._appConfig=i,this._isFreeUser=o,this._denaliPreLaunchGroup="denali_partial_test1",this._denali50="denali_50_denali",this._denali50Control="denali_50_denali_control",this._denali2={AAGroups:["denali_2_editor_control_1","denali_2_editor_control_2"],BBHalfSidebarGroups:["denali_2_denali_sidebar_1","denali_2_denali_sidebar_2"],CCTheGreenButtonGroups:["denali_2_denali_green_btn_1","denali_2_denali_green_btn_2"]},this._denali3={AGroups:d.ArrayUtils.mapNTimes(2,function(e){return"denali_3_a_control_"+(e+1)}),BGroupsTheGreenBtn:d.ArrayUtils.mapNTimes(8,function(e){return"denali_3_b_the_green_button_"+(e+1)}),CGroupsPrettyBtn:d.ArrayUtils.mapNTimes(8,function(e){return"denali_3_c_pretty_button_"+(e+1)}),DGroupsImprovedSidebar:d.ArrayUtils.mapNTimes(8,function(e){return"denali_3_d_improved_sidebar_"+(e+1)})},this._denali4={AGroupsAdvanced:["denali_4_advanced_1","denali_4_advanced_2"],BGroupsPremium:["denali_4_premium_1","denali_4_premium_2"]},this._forceEditorTs=this._router.query.get("denali").exists(function(e){return"false"===e}),this._appInitedFromDenaliPage=this._router.isActive(l.Router.routes.denali_editor.href({docId:"*"})).get(),this.wootricTest=this._router.query.get("wootric").exists(function(e){return"test"===e}),this.showSwitchToDenaliBtn={enabled:"prod"!==this._appConfig.env||this._userProfile.get().email.includes("@grammarly.com")}}return e.prototype._isExperiment=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.some(function(t){return e._experiments.get().has(t)})},e.prototype._isQueryExperiment=function(e){return this._router.query.get("exp").contains(e)},Object.defineProperty(e.prototype,"_isDenaliAA_EditorTS",{get:function(){return this._isExperiment.apply(this,this._denali2.AAGroups)||this._isQueryExperiment("aa")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_isDenaliBB_HalfSidebar",{get:function(){return this._isExperiment.apply(this,this._denali2.BBHalfSidebarGroups)||this._isQueryExperiment("bb")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_isDenaliCC_TheGreenButton",{get:function(){return this._isExperiment.apply(this,this._denali2.CCTheGreenButtonGroups)||this._isQueryExperiment("cc")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_isExperiment2",{get:function(){return this._isDenaliAA_EditorTS||this._isDenaliBB_HalfSidebar||this._isDenaliCC_TheGreenButton},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_isDenali3A_EditorTS",{get:function(){return this._isExperiment.apply(this,this._denali3.AGroups)||this._isQueryExperiment("3a")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_isDenali3B_TheGreenButton",{get:function(){return this._isExperiment.apply(this,this._denali3.BGroupsTheGreenBtn)||this._isQueryExperiment("3b")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_isDenali3C_PrettyButton",{get:function(){return this._isExperiment.apply(this,this._denali3.CGroupsPrettyBtn)||this._isQueryExperiment("3c")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_isDenali3D_ImprovedHalfSidebar",{get:function(){return this._isExperiment.apply(this,this._denali3.DGroupsImprovedSidebar)||this._isQueryExperiment("3d")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_isExperiment3",{get:function(){return this._isDenali3A_EditorTS||this._isDenali3B_TheGreenButton||this._isDenali3C_PrettyButton||this._isDenali3D_ImprovedHalfSidebar},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_isDenali4A_NormalWording",{get:function(){return this._isExperiment.apply(this,this._denali4.AGroupsAdvanced)||this._isQueryExperiment("4a")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_isDenali4B_AlternativeWording",{get:function(){return this._isExperiment.apply(this,this._denali4.BGroupsPremium)||this._isQueryExperiment("4b")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_isExperiment4",{get:function(){return this._isDenali4A_NormalWording||this._isDenali4B_AlternativeWording},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wootric",{get:function(){return c.None},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{get:function(){return!this._forceEditorTs&&(!!this._settings.forcedDenaliUI.get()||(this._userProfile.get().email.indexOf("@grammarly.com")>-1||("readability_proto@bh.exacttarget.com"===this._userProfile.get().email||(!!(this._isExperiment(this._denaliPreLaunchGroup,this._denali50,this._denali50Control)||this._isExperiment.apply(this,this._denali2.BBHalfSidebarGroups.concat(this._denali2.CCTheGreenButtonGroups))||this._isExperiment.apply(this,this._denali3.BGroupsTheGreenBtn.concat(this._denali3.CGroupsPrettyBtn,this._denali3.DGroupsImprovedSidebar))||this._isExperiment4)||(this._appInitedFromDenaliPage||this._router.query.get("denali").exists(function(e){return"prod"===e}))))))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"halfSidebar",{get:function(){return this._isDenaliBB_HalfSidebar||this._isDenali3D_ImprovedHalfSidebar},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontalToolbar",{get:function(){return this._isExperiment2||this._isDenali3A_EditorTS||this._isDenali3B_TheGreenButton},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"emptyTitle",{get:function(){return this._isExperiment2||this._isDenali3A_EditorTS||this._isDenali3B_TheGreenButton},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showNothingFoundNotification",{get:function(){return this._isDenali3D_ImprovedHalfSidebar},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alertGroupNames",{get:function(){return this._isFreeUser&&this._isDenali4B_AlternativeWording?h.FREE_PREMIUM:h.CRITICAL_ADVANCED},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"openOnPasteAndUploadMode",{get:function(){return this._isExperiment2?this._isDenaliBB_HalfSidebar?c.None:c.Some(i.OpenOnPasteOrUploadMode.simple):c.Some(i.OpenOnPasteOrUploadMode.loader)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"counterType",{get:function(){return this.halfSidebar?c.None:this._isExperiment2||this._isDenali3A_EditorTS||this._isDenali3B_TheGreenButton?c.Some(i.CounterType.large):c.Some(i.CounterType.small)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"denaliGroup",{get:function(){return this.enabled?Array.from(this._experiments.get()).find(function(e){return e.startsWith("denali_")&&!e.startsWith("denali_1")})||"forced_denali":null},enumerable:!0,configurable:!0}),e}();t.DenaliFeaturesImpl=p;var f=function(){function e(e,t,n,i,c,l,h,f){var g=this;this._experiments=e,this._subscription=t,this._userProfile=n,this._settings=i,this._institution=c,this._browser=l,this._router=h,this._appConfig=f,this._isPhoenixEduUser=this._institution.view(function(e){return{enabled:g._router.query.get("edu").fold(function(){return null!==e&&/Phoenix University/i.test(e.name)},function(e){return"phoenix"===e})}}),this._eduUserFeature=this._institution.view(function(e){return{enabled:g._router.query.has("edu")||null!==e}}),this._nonEduUserFeature=r(this._eduUserFeature),this._usertestingGroups=["usertesting_2_002_usertesting","usertesting_3_003_usertesting","usertesting_4_004_usertesting"],this.isUserTesting=this._isUserTesting(this._usertestingGroups),this.isUserTesting1=this._isUserTesting(["usertesting_2_002_usertesting"]),this.isUserTesting2=this._isUserTesting(["usertesting_3_003_usertesting"]),this.isUserTesting3=this._isUserTesting(["usertesting_4_004_usertesting"]),this.showOnboarding=this._router.query.get("onboarding").exists(function(e){return"show"===e}),this.hideOnboarding=this._userProfile.get().email.indexOf("@bh.exacttarget.com")>-1||this._router.query.get("onboarding").exists(function(e){return"hide"===e}),this.isFree=this._userProfile.view(function(e){return e.type===u.UserType.free&&!e.isFreebie}).get()||this._router.query.has("isFree"),this.isPremium=this._userProfile.view(function(e){return e.type===u.UserType.premium}).get()&&!this._router.query.has("isFree"),this.isDesktopEditor=d.BrowserInfo.isDesktopEditor(this._browser),this.eduUserFeature=this._eduUserFeature,this.denali=new p(this._userProfile,this._settings,this._router,this._experiments,this._appConfig,this.isFree),this.proofit=o.Atom.combine(this._subscription.view(function(e){return d.Async.isOk(e)&&!!e.value.paymentMethod}),this._institution,this._settings.disableProofit,function(e,t,n){return{enabled:!1===g.demoMode&&null!==t?t.proofit:e&&!n}}),this.proofitToolbarItem=o.Atom.combine(this.proofit,this._institution,this._userProfile,this._settings.disableProofit,function(e,t,n,r){return{enabled:e.enabled||!n.isFreebie&&null===t&&!r}}),this.proofitTest=this._router.query.get("proofit"),this.plagiarism=this._institution.view(function(e){return{enabled:!(!1!==g.demoMode||e&&e.plagiarismDisabled)}}),this.banners=this.isDesktopEditor?o.Atom.create({enabled:!1}):this._nonEduUserFeature,this.navTutotial=this._eduUserFeature,this.tour=this._nonEduUserFeature,this.deleteAccount=r(this._isPhoenixEduUser),this.usernameUnderLogout=this._nonEduUserFeature,this.showChangeEmail=this._nonEduUserFeature,this.eduAdminPanelLink=this._institution.view(function(e){return{enabled:e&&e.admin}}),this.subscription=o.Atom.combine(this._userProfile,this._institution,function(e,t){return{enabled:null===t&&g.isPremium&&!e.isFreebie}}),this.goPremium={enabled:this.isFree},this.premiumBadge={enabled:this.isPremium},this.premiumCounter={enabled:!this.isFree},this.upgradeButton={enabled:this.isFree},this.appsSection=o.Atom.create({enabled:!this.isDesktopEditor}),this.desktopApps=r(this._isPhoenixEduUser),this.score=this._institution.view(function(e){return{enabled:!e||!e.scoreDisabled}}),this.downloadPdfReportButton={enabled:!this.isDesktopEditor},this.copyPasteMenuItems={enabled:!this.isDesktopEditor},this.quickReplacementsInCard=this._institution.view(function(e){return{enabled:!e||e.quickReplacement}}),this.hideTitleInEDUCard=this._institution.view(function(e){return{enabled:!e||!e.quickReplacement}}),this.showFullCards=this._institution.view(function(e){return{enabled:e&&e.fullCards}}),this.profileLink=r(this._isPhoenixEduUser),this.defaultAcademicGenre=o.Atom.create({enabled:!1}),this.enableTrackingOnDownload=this._isPhoenixEduUser.view(function(e){return!e}),this.phoenixReportBtn=this._isPhoenixEduUser,this.phoenixSupportLink=this._isPhoenixEduUser,this.phoenixTutorial=this._isPhoenixEduUser,this.phoenixTerms=o.Atom.combine(this._isPhoenixEduUser,this._settings.acceptedTermsVersion,function(e,t){var n=s.TermsOfService.termsVersion,r=a.valid(t)&&a.valid(n)&&a.gt(n,t)||!a.valid(t)||g._router.query.has("terms");return e.enabled&&r}),this.phoenixTour=this._isPhoenixEduUser,this.showTour=o.Atom.combine(this.phoenixTour,this._settings.seenWelcome,function(e,t){return!t&&!e.enabled&&!g.denali.enabled})}return e.prototype._isUserTesting=function(e){var t=this;return this._experiments.view(function(t){return e.some(function(e){return t.has(e)})}).view(function(e){return t._router.query.has("hasUserTesting")||e&&!t._router.query.has("skipUserTesting")}).get()},Object.defineProperty(e.prototype,"isReadabilityPrototypeDemoUser",{get:function(){return"readability_proto@bh.exacttarget.com"===this._userProfile.get().email},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInternalUser",{get:function(){var e=this._userProfile.get().email;return e.indexOf("@grammarly.com")>-1||e.indexOf("@bh.exacttarget.com")>-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showDiscoverabilityOnExit",{get:function(){return this._router.query.get("onexit").exists(function(e){return"show"===e})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"demoMode",{get:function(){return this.isUserTesting||this.isReadabilityPrototypeDemoUser},enumerable:!0,configurable:!0}),e}();t.FeaturesModel=f,function(e){var t=function(){function e(e,t,n,r,i,o){this.halfSidebar=e,this.emptyTitle=t,this.horizontalToolbar=n,this.openOnPasteAndUploadMode=r,this.counterType=i,this.showNothingFoundNotification=o,this.enabled=!0,this.wootric=c.None,this.wootricTest=!1,this.denaliGroup=null,this.alertGroupNames=h.CRITICAL_ADVANCED}return e}();e.DenaliFeaturesMock=t;var n=function(){function e(e,t){this.isFree=e,this.denali=t}return e}();e.DenaliPageFeaturesMock=n}(f=t.FeaturesModel||(t.FeaturesModel={})),t.FeaturesModel=f},306:function(e,t,n){"use strict";function r(e){return e instanceof c.Observable?e:c.Observable.of(e)}function i(e,t){return e instanceof c.Observable?e.map(t):t(e)}function o(e){return c.Observable.fromPromise(e().then(function(e){return a.Some(a.Right(e))}).catch(function(e){return a.Some(a.Left(e))})).startWith(a.None)}function s(e){return function(t,n){return n.catch(e.handler(t+" exception").error).retry(3).subscribe()}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(18),c=n(22);t.voidValue=void 0,t.toVoid=function(){return t.voidValue},t.toOptionValueOnly=function(e){return e.fold(function(){return c.Observable.empty()},function(e){return c.Observable.of(e)})},t.toAtom=function(e){return function(t){return e.set(t)}},t.or=function(e,t){return function(n){return n?e:t}},t.orEmpty=function(e){return t.or(e,c.Observable.empty())},t.delay=function(e,t){return c.Observable.of(e).delay(t)},t.toObservable=r,t.mapMaybeObservable=i,t.promiseToStream=o,t.createRetrySubscriber=s},307:function(e,t,n){"use strict";function r(e){switch(e){case"red":return i.red;case"green":return i.green;case"yellow":return i.yellow;default:return i.grey}}Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(5);!function(e){e[e.red=0]="red",e[e.green=1]="green",e[e.yellow=2]="yellow",e[e.grey=3]="grey"}(i=t.AlertExampleColor||(t.AlertExampleColor={}));!function(e){e[e.italic=0]="italic",e[e.plain=1]="plain"}(t.AlertExampleTextType||(t.AlertExampleTextType={})),t.getColor=r;t.parseExamples=function(e){return e?e.replace(/^<p>/,"").split("<p>").map(function(e){var t=e.match(/<span.*?<\/span><br\/>/g);return t&&t.length?t.map(function(e){var t=r(o.StringUtils.getFirstWord(o.StringUtils.getFirstMatch(e,/^<span.*?class="(.+?)".*?>/)||"")),n=o.StringUtils.getFirstMatch(e,/^<span.*?>(.+?): /)||"Comment",i=o.StringUtils.getFirstMatch(e,/^<span.*?>(?:.+?: )?(.+?)<\/span><br\/>/);return i?{color:t,type:n,text:i}:null}).filter(function(e){return!!e}):[]}).filter(function(e){return e.length}):[]}},308:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CardBaseClassName="cardBaseClassName";!function(e){function t(e,t){return{kind:"single",alertId:e,action:t}}function n(e){return{kind:"batchIgnore",alertIds:e}}function r(e){return"single"===e.kind}function i(e){return"batchIgnore"===e.kind}e.createSingle=t,e.createBatchIgnore=n,e.isSingle=r,e.isBatchIgnore=i}(t.AppliedAlertAction||(t.AppliedAlertAction={}));!function(e){e[e.idle=0]="idle",e[e.inProgress=1]="inProgress",e[e.finished=2]="finished"}(t.CheckingStatus||(t.CheckingStatus={}))},309:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(14),i=n(933),o=n(875);t.Logo=function(e){return r.createElement("div",{"data-name":"gr-logo",className:i.logoWrapper},r.createElement("a",{href:e.mainPageUrl},r.createElement("img",{className:i.logo,src:o})))}},310:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2),o=n(18),s=n(43),a=n(291),c=n(5);r||(r={});var u;!function(e){function t(e){return"change"===e.kind}function n(e){return"cmd"===e.kind}function r(e){return"cmdIncRevision"===e.kind}e.isChange=t,e.isCmd=n,e.isCmdIncRevision=r}(u=t.ChangesQueue||(t.ChangesQueue={}));var l=function(e){function t(t){var n=e.call(this,"The message was dropped from the queue")||this;return n.reason=t,n}return i.__extends(t,e),t.prototype.toString=function(){return"The message was dropped from the queue due to: "+this.reason},t.isDroppedFromQueueError=function(e){return e instanceof t},t}(c.CustomError);t.DroppedFromQueueError=l;var d=function(){function e(e,t,n){var r=this;this._shouldIncreaseRevision=e,this._acceptHandler=t,this._dropHandler=n,this._changes=[],this._staged=[],this._stagedAmount=0,this._acceptMessage=function(e){r._updateCheckedTextSize(e),r._acceptHandler(e)},this._dropMessages=function(e,t){e.forEach(r._updateCheckedTextSize),r._dropHandler(e,t)},this._updateCheckedTextSize=function(e){u.isChange(e)?r._changeStagedAmount(-e.change.amount):r._shouldIncreaseRevision(e.cmd)&&r._changeStagedAmount(-a.BIG_TEXT_SIZE)},this.clear("init")}return e.prototype.pushChanges=function(e){var t=this;return(this.isEmpty?o.None:this._tail().filter(u.isChange)).fold(function(){var n=++t._queuedId,r=++t._revision;return t._changeStagedAmount(e.amount),t._changes.push({kind:"change",change:e,id:n,rev:r}),n},function(n){var r=n.change.compose(e);if(t._replaceChange(t._changes.length-1,r),n.change.isEmpty){var i=t._changes.pop();setTimeout(function(){return t._acceptMessage(i)},0)}return n.id})},e.prototype.pushCommand=function(e){var t=++this._queuedId;return this._shouldIncreaseRevision(e)?(this._changeStagedAmount(a.BIG_TEXT_SIZE),this._changes.push({kind:"cmdIncRevision",cmd:e,id:t,rev:++this._revision})):this._changes.push({kind:"cmd",cmd:e,id:t,rev:this._revision}),t},Object.defineProperty(e.prototype,"isStaging",{get:function(){return this._staged.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this._changes.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localRevision",{get:function(){return this._revision},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stagedAmount",{get:function(){return this._stagedAmount},enumerable:!0,configurable:!0}),e.prototype.pollAll=function(){var e=this._changes;this._changes=[];var t=c.ArrayUtils.partition(e,u.isCmd),n=t[0],r=t[1];return n.forEach(this._acceptMessage),(i=this._staged).push.apply(i,r),e;var i},e.prototype.ack=function(e){this._ackedRevisions.add(e),this._cleanStaged()},e.prototype.transformAlertAgainstQueue=function(e){for(var t=this._staged.filter(function(t){return t.rev>e.rev}).concat(this._changes).filter(u.isChange).map(function(e){return e.change.delta}),n=0,r=t;n<r.length;n++){var i=r[n],s={begin:i.transformPosition(e.begin,!0),end:i.transformPosition(e.end,!0),highlightBegin:i.transformPosition(e.highlightBegin,!0),highlightEnd:i.transformPosition(e.highlightEnd,!0)};if(s.end-s.begin!=e.end-e.begin||s.highlightEnd-s.highlightBegin!=e.highlightEnd-e.highlightBegin)return o.None;e=c.ObjectUtils.update(e,s)}return o.Some(e)},e.prototype.clear=function(e){var t=this._changes.concat(this._staged);this._changes=[],this._staged=[],this._ackedRevisions=new Set,this._queuedId=-1,this._revision=-1,t.length>0&&this._dropMessages(t,e)},e.prototype._tail=function(){return o.Option.of(this._changes[this._changes.length-1])},e.prototype._replaceChange=function(e,t){var n=this._changes[e];s.invariant(u.isChange(n),"queued change should exist"),this._changeStagedAmount(-n.change.amount+t.amount),n.change=t},e.prototype._cleanStaged=function(){for(;void 0!==this._staged[0]&&this._ackedRevisions.has(this._staged[0].rev);){var e=this._staged.shift();this._ackedRevisions.delete(e.rev),this._acceptMessage(e)}},e.prototype._changeStagedAmount=function(e){this._stagedAmount+=e},e}();t.CapiQueue=d},311:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(18),o=n(43),s=n(5);r||(r={});var a;!function(e){function t(e){return"change"===e.kind}function n(e){return"cmd"===e.kind}function r(e){return"meta"===e.kind}e.isChange=t,e.isCmd=n,e.isMeta=r}(a=t.ChangesQueue||(t.ChangesQueue={}));var c=function(){function e(e,t,n){void 0===n&&(n=[]),this._acceptHandler=e,this._dropHandler=t,this._changes=n,this._staging=!1,this._queuedId=0}return e.prototype.pushChanges=function(e){var t=this;return(this.isEmpty||this._staging&&1===this._changes.length?i.None:this._tail().filter(a.isChange)).fold(function(){var n=t._queuedId++;return t._changes.push({kind:"change",change:e,id:n}),n},function(n){var r=n.change.compose(e);if(t._replaceChange(t._changes.length-1,r),n.change.isEmpty){var i=t._changes.pop();setTimeout(function(){return t._acceptHandler(i)},0)}return n.id})},e.prototype.pushMeta=function(e){var t=this;return(this.isEmpty||this._staging&&1===this._changes.length?i.None:this._tail().filter(a.isMeta)).fold(function(){var n=t._queuedId++;return t._changes.push({kind:"meta",meta:e,id:n}),n},function(t){return Object.assign(t.meta,e),t.id})},e.prototype.pushCommand=function(e){var t=this._queuedId++;return this._changes.push({kind:"cmd",cmd:e,id:t}),t},Object.defineProperty(e.prototype,"isStaging",{get:function(){return this._staging},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this._changes.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._changes.length},enumerable:!0,configurable:!0}),e.prototype.poll=function(){var e=this;o.invariant(!this._staging,"Should not be in staging mode");var t=i.Option.of(this._changes[0]);return t.forEach(function(){e._staging=!0}),t},e.prototype.pop=function(){o.invariant(!this._staging,"Should not be in staging mode");var e=i.Option.of(this._changes.shift());return e.forEach(this._acceptHandler),e},e.prototype.unstage=function(){o.invariant(this._staging,"Should be in staging mode"),o.invariant(void 0!==this._changes[0],"Staging change should exist"),this._staging=!1},e.prototype.ack=function(){this.unstage(),this.pop()},e.prototype.transformChangeAgainstQueue=function(e){var t=this;return this._changes.reduce(function(e,n,r){if(a.isChange(n)){var i=n.change,o=i.transform(e,!1);return t._replaceChange(r,o),e.transform(i)}return e},e)},e.prototype.drop=function(e,t){if(!this.isEmpty){var n=void 0===t?[this._changes,[]]:s.ArrayUtils.partition(this._changes,function(e){return e.kind===t}),r=n[0],i=n[1];this._changes=i,r.length>0&&this._dropHandler({messages:r,reason:e})}},e.prototype.toJSON=function(){return{changes:this._changes}},e.prototype._tail=function(){return i.Option.of(this._changes[this._changes.length-1])},e.prototype._replaceChange=function(e,t){var n=this._changes[e];o.invariant(a.isChange(n),"queued change should exist"),n.change=t},e}();t.DoxQueue=c},312:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(14),o=n(119),s=n(309),a=n(935),c=n(876),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return i.createElement(o.BasePage,{title:"Grammarly"},i.createElement("div",null,i.createElement(s.Logo,{mainPageUrl:this.context.appConfig.funnel.mainPage}),i.createElement("div",{className:a.robot},i.createElement("img",{src:c,width:155,height:215})),i.createElement("div",{className:a.header},i.createElement("div",{className:a.headOne},"Our grammar robot is recharging."),i.createElement("div",{className:a.headSub},i.createElement("p",{className:a.sub},"Grammarly is currently unavailable while we make upgrades",i.createElement("br",null),"to improve the service for you. Please try again in a minute."))),i.createElement("div",{className:a.smallText},"We apologize for the inconvenience and appreciate your patience.",i.createElement("br",null),"For more information, please"," ",i.createElement("a",{className:a.contact,href:this.context.appConfig.support.newRequest},"contact support"),".")))},t}(o.BaseComponent);t.Error500Page=u},313:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.capacity=e,this.size=0,this._keymap={}}return e.prototype.put=function(e,t){var n={key:e,value:t};if(this._keymap[e]=n,this._tail?(this._tail.newer=n,n.older=this._tail):this._head=n,this._tail=n,this.size===this.capacity)return this.shift().value;++this.size},e.prototype.get=function(e){var t=this._getImpl(e);return t&&t.value},e.prototype.peek=function(e){var t=this._keymap[e];return t&&t.value},e.prototype.set=function(e,t){var n=this._getImpl(e),r=t(n&&n.value);return r?n?n.value=r:this.put(e,r):n&&this.remove(e),r},e.prototype.getRef=function(e){return this._getImpl(e)},e.prototype.remove=function(e){var t=this._keymap[e];if(t)return delete this._keymap[e],t.newer&&t.older?(t.older.newer=t.newer,t.newer.older=t.older):t.newer?(t.newer.older=void 0,this._head=t.newer):t.older?(t.older.newer=void 0,this._tail=t.older):this._head=this._tail=void 0,--this.size,t.value},e.prototype.forEach=function(e){for(var t in this._keymap)e(t,this._keymap[t].value)},e.prototype.shift=function(){var e=this._head;return this._head&&(this._head.newer?(this._head=this._head.newer,this._head.older=void 0):this._head=void 0,e.newer=e.older=void 0,delete this._keymap[e.key]),e},e.prototype._getImpl=function(e){var t=this._keymap[e];if(t)return t===this._tail?t:(t.newer&&(t===this._head&&(this._head=t.newer),t.newer.older=t.older),t.older&&(t.older.newer=t.newer),t.newer=void 0,t.older=this._tail,this._tail&&(this._tail.newer=t),this._tail=t,t)},e}();t.LRUCache=r},377:function(e,t){e.exports={spinner:"_51ca9a4d-editor-core-spinner",desktopEditorPreventSelection:"_a3ef96c1-editor-core-desktopEditorPreventSelection"}},38:function(e,t,n){"use strict";function r(e){if(e){var t=e.match(/^Grammarly\s+Desktop\s+Editor\s(.*\s)?(\d+\.\d+\.\d+).*-(osx|windows)$/);if(t){var n=parseFloat(t[2]);return{browser:"desktop-editor",version:t[2],parsedVersion:isNaN(n)?0:n,os:"osx"===t[3]?"mac":"windows",type:"desktop",supported:function(){return!1}}}}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(210),o=n(290),s=n(210);t.Browser=s.Browser,t.PlatformInfo=s.PlatformInfo,t.BrowserType=s.BrowserType,t.OS=s.OS,t.getBrowserInfo=function(){return r(navigator.userAgent)||i()},t.isDesktopEditor=function(e){return"desktop-editor"===e},t.isDownloadAttrSupported="chrome"===t.getBrowserInfo().browser,t.isFetchBlobDownloadSupported=!("safari"===t.getBrowserInfo().browser&&Number(t.getBrowserInfo().version)<10),t.hotkeyLabel=function(e,t){return("mac"===t||"ios"===t?"":"Ctrl+")+e},t.isMac=function(e){return"mac"===e||"ios"===e},t.getClientType=function(){var e=t.getBrowserInfo().browser;if(t.isDesktopEditor(e))return o.ClientType.desktop;switch(t.getBrowserInfo().browser){case"chrome":return o.ClientType.webChrome;case"firefox":return o.ClientType.webFirefox;case"safari":return o.ClientType.webSafari;case"msie":return o.ClientType.webIE;case"edge":return o.ClientType.webEdge;default:return o.ClientType.unknown}}},43:function(e,t,n){"use strict";function r(e,t){if(!e)throw new Error("Invariant condition failed: "+(t?"string"==typeof t?t:t():"(unnamed)"))}function i(e,t,n){if(e!==t)throw new g(e,t,n)}function o(e){var t=new Date(e);return isNaN(t.getTime())?null:t}function s(e){return l.__awaiter(this,void 0,void 0,function(){return l.__generator(this,function(t){return[2,new Promise(function(t){return setTimeout(t,e)})]})})}function a(e,t,n){return void 0===t&&(t=10),void 0===n&&(n=1e3),l.__awaiter(this,void 0,void 0,function(){var r;return l.__generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,4]),[4,e()];case 1:return[2,i.sent()];case 2:if(r=i.sent(),t<=1||!(r instanceof m))throw r;return d.Monitoring.Logging.root.isEnabled(d.Logging.LogLevel.TRACE)&&d.Monitoring.Logging.root.getLogger("coreclients.utils").trace("retryWithDelay: count "+t+", timeout: "+n,r),[4,s(n)];case 3:return i.sent(),[2,a(e,t-1,1.3*n)];case 4:return[2]}})})}function c(e){var t=0;return function(){return t++<e}}function u(e,t){return new Promise(function(n,r){e().catch(function(n){if(t(n))return e();throw n}).then(n).catch(r)})}Object.defineProperty(t,"__esModule",{value:!0});var l=n(2),d=n(6),h=n(18),p=n(936);t.invariant=r;var f=function(){function e(e){var t=new Error(e);this.message=t.message,this.stack=t.stack}return e}();t.CustomError=f;var g=function(e){function t(t,n,r){var i=e.call(this,"AssertionError: "+r)||this;return i.expected=t,i.actual=n,i.name="AssertionError",i}return l.__extends(t,e),t.prototype.toString=function(){return this.message+"\nExpected: "+this.expected+"\nActual: "+this.actual},t}(f);t.AssertionError=g,t.assert=i;var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="RetryError",t}return l.__extends(t,e),t}(f);t.RetryError=m,t.stringToDate=o,t.delay=s,t.retryWithDelay=a,t.retryCountPredicate=c,t.promiseRetrier=u;var _=function(){function e(e,t,n,r){void 0===t&&(t=5e3),void 0===n&&(n=""),void 0===r&&(r=new Error("Timeout")),this._doRequest=e,this._timeout=t,this._timeoutError=r,this._requests=new Map,this._log=d.Monitoring.Logging.getLogger("ValueRequester"+(n.length>0?"."+n:""))}return e.prototype.request=function(e){return this._startRequest(e).promise},e.prototype.onValue=function(e,t){this._stopRequest(e,h.Right(t))},e.prototype.onError=function(e,t){this._stopRequest(e,h.Left(t))},e.prototype._startRequest=function(e){var t=this,n=this._doRequest(e),r={};return r.promise=new Promise(function(e,t){r.resolve=e,r.reject=t}),r.timer=setTimeout(function(){return t._stopRequest(n,h.Left(t._timeoutError))},this._timeout),this._requests.set(n,r),r},e.prototype._stopRequest=function(e,t){var n=this._requests.get(e);void 0===n?this._log.error("Got unrequested result or request has already expired."):(clearTimeout(n.timer),t.fold(n.reject,n.resolve),this._requests.delete(e))},e}();t.ValueRequester=_,t.fetchWithOrigin=function(e,t,n){void 0===n&&(n="https://app.grammarly.com");var r=l.__assign({},t.headers||{},{Origin:n});return p(e,l.__assign({},t,{headers:r}))}},5:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);r.__exportStar(n(198),t),r.__exportStar(n(100),t);var i=n(1408);t.Async=i.Async;var o=n(1406);t.Animation=o.Animation;var s=n(1410);t.ConnectionManager=s.ConnectionManager;var a=n(1409);t.Clipboard=a.Clipboard;var c=n(1414);t.Either=c.Either;var u=n(577);t.DOM=u;var l=n(150);t.StringUtils=l;var d=n(578);t.ReactUtils=d;var h=n(300);t.DateUtils=h;var p=n(1415);t.LocalStorage=p;var f=n(1411);t.Cookie=f;var g=n(199);t.Extension=g;var m=n(38);t.BrowserInfo=m;var _=n(203);t.ObjectUtils=_;var y=n(1407);t.ArrayUtils=y;var v=n(306);t.RxUtils=v;var b=n(1413);t.DesktopEditor=b;var w=n(1416);t.NotEmpty=w.NotEmpty;var E=n(587);t.Fullstory=E.Fullstory},53:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(566);t.CAPI=i;var o=n(547);t.Dapi=o.Dapi,t.Properties=o.Properties;var s=n(290);t.Auth=s.Auth,t.User=s.User,t.UserType=s.UserType,t.LoginType=s.LoginType;var a=n(1369);t.Irbis=a.Irbis,t.SubscriptionStatus=a.SubscriptionStatus,t.PaymentPlan=a.PaymentPlan,t.PaymentMethod=a.PaymentMethod,t.CreditCard=a.CreditCard;var c=n(60);t.Ajax=c.Ajax,t.MimeType=c.MimeType,t.Request=c.Request,t.RequestBuilder=c.RequestBuilder,t.HTTPError=c.HTTPError;var u=n(148);t.WSError=u.WSError;var l=n(1361);t.Diagnostics=l.Diagnostics,t.OriginStatus=l.OriginStatus;var d=n(43);t.CustomError=d.CustomError;var h=n(295);t.Proofit=h.Proofit;var p=n(1367);t.RawFile=p.RawFile,r.__exportStar(n(292),t);var f=n(208);t.DocumentContext=f.DocumentContext,t.genreToDomain=f.genreToDomain,t.domainToGenre=f.domainToGenre;var g=n(1362);t.Dictionary=g.Dictionary;var m=n(1368);t.Institution=m.Institution},542:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(14),i=n(38);t.textResources={base:{tooltipDownloadProofreadVersion:"Download proofread version",tooltipDownloadOriginalVersion:"Download original version",tooltipDownload:"Download",uploadText:"Upload",tooltipUploadElementInput:"Click here to upload document",menuDownloadText:"Download",documentPlaceholderText:"Upload a document to save original formatting.",modalUploadingDocumentText:"Uploading document",notificationUploadFileText:"Upload a file in one of the following formats",copyToClipboardIsNotAvailable:"Click and copy with "+i.hotkeyLabel("C",i.getBrowserInfo().os)},denali:{notEnoughTextToGetScore:r.createElement("p",null,"Write away! Grammarly needs at least 30",r.createElement("br",null),"words to score your text."),rankTooltip:function(e){return r.createElement("p",null,"Your text scores higher than ",e,"% ",r.createElement("br",null),"of all texts checked by Grammarly ",r.createElement("br",null),"where comparable goals were set")},documentStats:{notEnoughTextToCalculateStats:"Write away! Grammarly needs at least 30 words to calculate document statistics.",uniqueWords:"Measures vocabulary diversity by calculating\nthe number of unique words.",rareWords:"Measures depth of vocabulary by identifying words that are\nnot among the 5,000 most common English words.",readability:"In the Flesch reading-ease test, higher scores\nindicate material that is easier to read.",uniqueWordsTitle:"Unique words",rareWordsTitle:"Rare words",wordLengthTitle:"Word length",sentenceLengthTitle:"Sentence length",notEnoughTextToGenerateReport:"We need at least 30 words to calculate document statistics and generate your report.",report:{plagiarismDescription:function(e,t){return e+"% of your text matches "+t+" sources on the web\nor in archives of academic publications"},downloadPdfReport:"Download PDF report",preparingPdfReport:"Preparing PDF report...",readingEase:"reading ease",readingEaseDescription:"Rates the text by the number of years of\neducation needed to understand it",readingEaseMeasure:"grade level",uniqueWordsDescription:"Measures vocabulary diversity by calculating\nthe percentage of words used only once in your\ndocument",wordLengthDescription:"Measures average word length",wordLengthMeasure:"characters per word",sentenceLengthDescription:"Measures average sentence length",sentenceLengthMeasure:"words per sentence"}},sidebar:{openLabel:"start assistant",fixErrorsLabel:"Correct with Assistant",checkingLabel:"checking ",criticalIssue:"Critical issue",criticalIssues:"Critical issues",critical:"Critical",advanced:"Advanced",advancedIssue:"Advanced issue",advancedIssues:"Advanced\nissues",premium:"Premium",free:"Alerts",premiumAlerts:"Premium\nalerts"},uploadMenuItem:"Upload document",uploadDropZone:"Drag a text file here to upload",uploadDropZoneTypes:"Microsoft Word (.doc, .docx), OpenOffice (.odt), TXT and RTF are welcome",downloadMenuItem:"Download",uploadNotificationTitle:"The document was uploaded successfully",goals:{header:r.createElement("span",null,"The more Grammarly knows about the context",r.createElement("br",null)," of your writing, the more customized and",r.createElement("br",null)," ","helpful suggestions it will propose."),upgradeHookTitle:r.createElement("span",null,"Get the most accurate and relevant corrections",r.createElement("br",null),"for your specific writing situation")},plagiarism:{lensDescription:function(e,t,n){return r.createElement("span",null,r.createElement("em",null,e,"%")," ","of your text matches"," ",r.createElement("em",null,t," fragments")," ","from"," ",r.createElement("em",null,n," sources")," ","on the web or in Grammarlys archives of academic publications. Cite them with the style you prefer or with the most common citation styles:")},title:"Plagiarism",description:"Finds unoriginal text by checking against academic databases and over 8 billion web pages.",originalText:r.createElement("span",null,"Looks like your text is 100% original. ",r.createElement("br",null),"We found no matching text in our databases or on the Internet.")},documentPerformanceRankText:function(e){return r.createElement("span",null,"Great job! Your text is expected to ",r.createElement("br",null),"perform ",r.createElement("b",null,"better than ",e,"%")," of comparable ",r.createElement("br",null),"texts written by other Grammarly users.")},proofitTitle:"Professional Proofreaders",proofitDescription:"Our professional proofreaders are ready to check your document right now.",card:{less:"Less",more:"More",dismiss:"Dismiss",addToDict:"Add to dictionary",like:"I'll address this",dislike:"Not helpful",wrong:"Incorrect suggestion",offensive:"Offensive content"},placeholder:{typeOrPasteText:"Type or paste ("+i.hotkeyLabel("V",i.getBrowserInfo().os)+") your text here.",upload:"Upload a document to save original formatting."},toolbar:{loading:"Loading...",processing:"Processing your document..."}}}},543:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6),i=function(){};t.defaultReconnect=function(e,t,n){var i=r.Monitoring.Logging.getLogger("coreclients.capi");return i.info("Disconnected from CAPI.",e.reason),n(t).catch(function(e){i.warn("Reconnect failed with an error: ",e)})};var o=function(){function e(){this.onSessionStarted=i,this.beforeAlert=i,this.onAlert=i,this.onRemove=i,this.onSynonyms=i,this.onPlagiarism=i,this.onAsyncCheckFinish=i,this.onError=i,this.onBeforeFinish=i,this.onFinish=i,this.onStats=i,this.onPong=i,this.onDebugInfo=i,this.onDisconnect=t.defaultReconnect,this.onQueueMsgAccepted=i,this.onQueueMsgDropped=i}return e}();t.DefaultCAPIEventHandler=o},544:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(2),o=n(6),s=n(18),a=n(5),c=n(197),u=n(151),l=n(208),d=n(100),h=n(148),p=n(43),f=n(291),g=n(545),m=n(546),_=n(543),y=n(310);!function(e){e[e.DISCONNECTED=0]="DISCONNECTED",e[e.CONNECTING=1]="CONNECTING",e[e.CONNECTED=2]="CONNECTED",e[e.STARTED=3]="STARTED",e[e.ANY=4]="ANY",e[e.CLOSED=5]="CLOSED"}(r||(r={}));var v;!function(e){e[e.CONNECT=0]="CONNECT",e[e.CONNECTED=1]="CONNECTED",e[e.DISCONNECT=2]="DISCONNECT",e[e.START=3]="START",e[e.CLOSE=4]="CLOSE"}(v||(v={}));var b=5,w=function(){function e(e){var t=e.url,n=e.handler,a=e.context,f=void 0===a?l.DocumentContext.empty:a,m=e.dialect,w=void 0===m?"undefined":m,S=e.client,x=void 0===S?"web":S,T=e.clientVersion,k=void 0===T?"":T,A=e.extDomain,I=void 0===A?"":A,O=e.sendDelay,D=void 0===O?1e3:O,P=e.docid,N=void 0===P?"":P,R=e.token,M=void 0===R?"":R,L=this;this._log=o.Monitoring.Logging.getLogger("coreclients.capi",o.Logging.LogLevel.DEBUG),this._nextId=0,this._textSize=0,this._idleRestore=s.None,this._runtimeErrorCounter=new E,this._asyncChecksManager=new C,this._sendCmd=function(e){return s.Option.of(e).map(function(e){return L._sendInbandCommand(e)}).getOrElse(-1)},this._statsRequester=new p.ValueRequester(this._sendCmd,15e3,"DocStats"),this._synonymsRequester=new p.ValueRequester(this._sendCmd,15e3,"Synonyms"),this._getTextRequester=new p.ValueRequester(this._sendCmd,15e3,"Text"),this._startSession=function(){L._sendMessage(L._createStartMessage()),L._handler.onSessionStarted({kind:"session_started"})},this._send=function(){if(L._resetTimer(),L._log.trace("send("+r[L._fsm.current]+")"),L._fsm.is(r.STARTED)&&!L._changesQueue.isEmpty)try{L._changesQueue.pollAll().map(L._processQueueMessage).forEach(L._sendMessage)}catch(e){L._log.warn("unexpected error on sending",e)}else L._trySend(L._fsm.current)},this._processQueueMessage=function(e){return y.ChangesQueue.isChange(e)?new g.Message.SubmitOt(e.id,e.rev,e.change.prevLen,[e.change.delta]):L._shouldHaveSeparateRevision(e.cmd)?i.__assign({},e.cmd,{rev:e.rev,id:e.id}):i.__assign({},e.cmd,{id:e.id})},this._sendMessage=function(e){L._log.isEnabled(o.Logging.LogLevel.TRACE)&&L._log.trace("Sending >>> "+JSON.stringify(e).replace("\n"," ").substring(0,300)),L._conn.send(e).catch(function(e){return L._log.debug("fail on send",e)})},this._resetTimer=function(){void 0!==L._timeout&&(clearTimeout(L._timeout),L._timeout=void 0)},this._onQueueMsgAccepted=function(e){L._handler.onQueueMsgAccepted({kind:"queue_msg_accepted",message:e})},this._onQueueMsgDropped=function(e,t){"runtime_error"===t&&e.some(y.ChangesQueue.isChange)&&(L._runtimeErrorCounter.count>b?(L._log.debug("too frequent runtime errors, goto idle"),L._conn._ws.close(1e3)):(L._log.debug("runtime error on delta send, restart session",{tries:L._runtimeErrorCounter.count}),L._startSession())),e.filter(y.ChangesQueue.isCmd).forEach(function(e){switch(e.cmd.action){case"get_text_stats":L._statsRequester.onError(e.id,new y.DroppedFromQueueError(t));break;case"synonyms":L._synonymsRequester.onError(e.id,new y.DroppedFromQueueError(t));break;case"get_debug_info":L._getTextRequester.onError(e.id,new y.DroppedFromQueueError(t))}}),L._handler.onQueueMsgDropped({kind:"queue_msgs_dropped",messages:e,reason:t})},this._handler=Object.assign(new _.DefaultCAPIEventHandler,n||{}),this._url=t,this._context=f,this._dialect=w,this._client=x,this._clientVersion=k,this._extDomain=I,this._sendDelay=D,this._docid=N,this._token=M,this._changesQueue=new y.CapiQueue(this._shouldHaveSeparateRevision,this._onQueueMsgAccepted,this._onQueueMsgDropped),this._fsm=new c.StateMachine(r.DISCONNECTED,r.CLOSED).with(r.ANY).parentOf(r.CONNECTED,r.CONNECTING,r.DISCONNECTED,r.STARTED).from(r.ANY).to(r.CLOSED).on(v.CLOSE).from(r.DISCONNECTED).to(r.CONNECTING).on(v.CONNECT).from(r.CONNECTING).to(r.CONNECTED).on(v.CONNECTED).from(r.CONNECTED,r.STARTED,r.CONNECTING).to(r.DISCONNECTED).on(v.DISCONNECT).from(r.CONNECTED).to(r.STARTED).on(v.START).on(r.CONNECTED,this._startSession).on(r.STARTED,function(e){return L._trySend(e.to)}).on(r.DISCONNECTED,function(e){return L._clear(e.args)}).on(r.CLOSED,function(){return L._close()}),this._log.isEnabled(o.Logging.LogLevel.TRACE)&&this._fsm.verbose(r,v),this._ws=h.WS.create().onMessage(function(e,t){return L._handleMessage(t)}).onDisconnect(function(e){return L._handleDisconnect(e)}).onError(h.errPrintln),this._tryConnect(),d.registerDebugHelper("closeCapiSocket",function(e,t){void 0===e&&(e=1e3),L._conn._ws.close(e,t)}),d.registerDebugHelper("capiState",this),d.registerDebugHelper("capiRuntimeError",function(){var e=u.Change.ins(0,"test",100500);L.pushChanges(e)})}return e.prototype.setText=function(e){this._log.debug("setText(...)");return this._clear("setText"),this._fsm.is(r.STARTED)&&this._sendMessage(this._createStartMessage()),this.pushChanges(u.Change.ins(0,e))},e.prototype.pushChanges=function(e){if(this._checkIdle(),u.Change.isDelta(e)){var t=this._changesQueue.pushChanges(e);return this._textSize=e.prevLen+e.length,this._asyncChecksManager.stage(this._changesQueue.localRevision),this._trySend(this._fsm.current),t}if(u.Change.isReset(e)){var t=this.setText(e.text);return this._trySend(this._fsm.current),t}return this._changesQueue.isEmpty||this.ping(),-1},Object.defineProperty(e.prototype,"checkingState",{get:function(){var e=0===this._checkedTextSize||1===this._textSize?"idle":this._checkedTextSize>f.BIG_TEXT_SIZE&&this._textSize>f.BIG_TEXT_SIZE/3?"full":"checking";return this._log.trace("current checking state",e),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"asyncChecksState",{get:function(){return this._asyncChecksManager.getState()},enumerable:!0,configurable:!0}),e.prototype.accept=function(e,t,n){this._sendInbandCommand(new g.Message.UserFeedback(this._nextId++,f.FeedbackType.ACCEPTED,e,t,n))},e.prototype.setContext=function(e){this._log.debug("setContext(...)"),this._sendInbandCommand(new g.Message.SetContext(this._nextId++,-1,l.DocumentContext.serialize(e))),this._context=e},e.prototype.reportUserFeedback=function(e,t){this._sendInbandCommand(new g.Message.UserFeedback(this._nextId++,t===f.FeedbackType.SYNONYM_ACCEPTED?f.FeedbackType.ACCEPTED:t,e.id,e.begin))},e.prototype.dismissAll=function(e){this._sendInbandCommand(new g.Message.UserFeedback(this._nextId++,f.FeedbackType.DISMISS_BY_LENS,void 0,void 0,void 0,void 0,e))},e.prototype.requestSynonyms=function(e,t){return this._synonymsRequester.request(new g.Message.SynonymsRequest(this._nextId++,e,t))},e.prototype.requestDocStats=function(){var e=this,t=p.retryCountPredicate(3);return p.promiseRetrier(function(){return e._statsRequester.request(new g.Message.StatsRequest(e._nextId++))},function(e){return t()&&y.DroppedFromQueueError.isDroppedFromQueueError(e)})},e.prototype.enablePlagiarismSearch=function(){this._asyncChecksManager.resetCheck("plagiarism"),this._sendInbandCommand(new g.Message.ToggleChecks(this._nextId++,{plagiarism:!0}))},e.prototype.disablePlagiarismSearch=function(){this._sendInbandCommand(new g.Message.ToggleChecks(this._nextId++,{plagiarism:!1}))},e.prototype.setOption=function(e,t){this._log.trace("Set option "+t),this._sendInbandCommand(new g.Message.Option(this._nextId++,e,t))},e.prototype.ping=function(){this._sendInbandCommand(new g.Message.Ping(this._nextId++))},e.prototype.close=function(){return this._fsm.event(v.CLOSE)},e.prototype.getText=function(){return this._getTextRequester.request({id:this._nextId++,action:"get_debug_info"})},e.prototype._handleMessage=function(e){switch(this._log.isEnabled(o.Logging.LogLevel.TRACE)&&this._log.trace("Message <<< "+JSON.stringify(e).replace("\n"," ").substring(0,300)),e.action){case"start":this._fsm.event(v.START);break;case"alert":this._handleAlert(e);break;case"remove":this._handler.onRemove({kind:"alert_removed",alertId:e.id.toString()});break;case"finished":this._handleFinish(e);break;case"async_check_finished":this._handleAsyncCheckFinished(e);break;case"submit_ot":this._handleAck(e);break;case"feedback":case"option":case"toggle_checks":case"set_context":this._handleAck(e);break;case"error":this._handleError(e);break;case"pong":this._handler.onPong();break;case"synonyms":this._handleSynonyms(e);break;case"text_stats":e.readingTime=m.DocumentStatistics.calculateReadingTime(e),e.speakingTime=m.DocumentStatistics.calculateSpeakingTime(e),this._handler.onStats({kind:"stats",stats:e}),this._statsRequester.onValue(e.id,e);break;case"debug_info":this._handler.onDebugInfo({kind:"debug_info",info:e}),this._getTextRequester.onValue(e.id,e.text);break;default:this._log.error("Unknown message",{message:e}),a.assertNever(e)}},e.prototype._handleDisconnect=function(e){return i.__awaiter(this,void 0,void 0,function(){var t,n,r,o,a,c=this;return i.__generator(this,function(u){switch(u.label){case 0:return u.trys.push([0,3,,4]),t=(1001===e.code||1e3===e.code)&&this._changesQueue.isEmpty&&!this._changesQueue.isStaging,[4,this._fsm.event(v.DISCONNECT,e.reason)];case 1:return(n=u.sent())?(this._log.warn("Disconnected due to ",e.reason),[4,this._fsm.event(v.CONNECT)]):[2];case 2:return(r=u.sent())?(o=function(t){return i.__awaiter(c,void 0,void 0,function(){var n,r,o;return i.__generator(this,function(i){switch(i.label){case 0:return[4,e.reconnect.scheduleReconnect(t)];case 1:n=i.sent(),this._conn=n,i.label=2;case 2:return i.trys.push([2,4,,6]),[4,this._fsm.event(v.CONNECTED,n)];case 3:if(!(r=i.sent()))throw new Error("State change failed");return[3,6];case 4:return o=i.sent(),this._log.warn("Reconnect failed due to error ",o),[4,n.close()];case 5:return i.sent(),[3,6];case 6:return[2]}})})},t?(this._idleRestore=s.Some(function(){return o(0)}),this._log.debug("Postponed reconnect until changes arrive")):this._handler.onDisconnect(e,e.reconnect.nextDelay,o),[3,4]):[2];case 3:return a=u.sent(),h.errPrintln(a),[3,4];case 4:return[2]}})})},e.prototype._handleAlert=function(e){var t=this;this._handler.beforeAlert({kind:"before_alert"});var n=Object.assign(e,{id:e.id.toString()});this._log.trace("_handleAlert"),this._changesQueue.transformAlertAgainstQueue(n).fold(function(){t._log.isEnabled(o.Logging.LogLevel.TRACE)&&t._log.trace("OT ALERT: discarding alert due to position overlap",{message:JSON.stringify(n).substring(0,200)})},function(e){return t._handler.onAlert({kind:"alert_received",alert:e})})},e.prototype._handleFinish=function(e){this._handler.onBeforeFinish({kind:"before_finish"}),this._changesQueue.ack(e.rev);var t=this._createFinishEvent(e);this._handler.onFinish(t)},e.prototype._handleAsyncCheckFinished=function(e){this._asyncChecksManager.finish(e),this._handler.onAsyncCheckFinish({kind:"async_check_finished",check:e.check,revision:e.rev})},e.prototype._handleAck=function(e){this._log.trace("<<< Acknowledge for "+e.action,{message:e})},e.prototype._handleSynonyms=function(e){var t=this._parseSynonymsResult(e);this._handler.onSynonyms({kind:"synonyms",synonyms:t,word:e.token,position:e.synonyms.pos}),this._synonymsRequester.onValue(e.id,t)},e.prototype._createFinishEvent=function(e){return{kind:"finish",revision:e.rev,score:s.Option.of(e.scores).map(function(t){return{errorRateScore:e.score,accuracy:t.Accuracy,clarity:t.Clarity,effectiveness:t.Effectiveness,rank:Math.min(100,Math.round(.5*t.Accuracy+.25*(t.Clarity+t.Effectiveness)))}}),dialect:e.dialect}},e.prototype._parseSynonymsResult=function(e){var t=this,n=function(e){return e.derived};return e.synonyms.meanings.length>0?s.Some({id:e.id.toString(),originalWord:e.token,synonymsOrGroups:1===e.synonyms.meanings.length?s.Either.left(e.synonyms.meanings[0].synonyms.map(n)):s.Either.right(e.synonyms.meanings.map(function(r){if(void 0===r.meaning)throw t._log.error("Absent meaning in synonyms group.",{token:e.token}),new Error("Absent meaning in synonyms group.");return{meaning:r.meaning,words:r.synonyms.map(n)}}))}):s.None},e.prototype._createStartMessage=function(){return new g.Message.Start(this._nextId++,this._client,this._clientVersion,this._extDomain,this._dialect,this._docid,this._token,l.DocumentContext.serialize(this._context))},e.prototype._trySend=function(e){this._log.trace("_trySend("+r[e]+")"),void 0===this._timeout&&e===r.STARTED&&(this._timeout=setTimeout(this._send,this._sendDelay))},e.prototype._checkIdle=function(){var e=this;this._idleRestore=this._idleRestore.flatMap(function(t){return e._log.debug("We are idle... reconnecting before push."),t(),s.None})},e.prototype._shouldHaveSeparateRevision=function(e){return"set_context"===e.action},e.prototype._sendInbandCommand=function(e){this._checkIdle(),this._log.trace("_sendInbandCommand "+e.action);var t=this._changesQueue.isEmpty,n=this._changesQueue.pushCommand(e);return t?(this._log.trace("Q.isEmpty, sending command immidiately",e),this._send()):this._trySend(this._fsm.current),n},Object.defineProperty(e.prototype,"_checkedTextSize",{get:function(){return this._changesQueue.stagedAmount},enumerable:!0,configurable:!0}),e.prototype._tryConnect=function(){return i.__awaiter(this,void 0,void 0,function(){var e,t,n,r,o;return i.__generator(this,function(i){switch(i.label){case 0:return[4,this._fsm.event(v.CONNECT)];case 1:if(!(e=i.sent()))return[2];i.label=2;case 2:return i.trys.push([2,9,,10]),[4,this._ws.connect(this._url)];case 3:t=i.sent(),this._conn=t,i.label=4;case 4:return i.trys.push([4,6,,8]),[4,this._fsm.event(v.CONNECTED,t)];case 5:if(!(n=i.sent()))throw new Error("State change failed");return[3,8];case 6:return r=i.sent(),this._log.warn("Connection cannot be finalized due to error",r),[4,t.close()];case 7:return i.sent(),[3,8];case 8:return[3,10];case 9:return o=i.sent(),h.errPrintln(o),[3,10];case 10:return[2]}})})},e.prototype._close=function(){return i.__awaiter(this,void 0,void 0,function(){return i.__generator(this,function(e){switch(e.label){case 0:return this._clear("close() called"),this._conn?[4,this._conn.close()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.prototype._clear=function(e){this._nextId=0,this._changesQueue.isEmpty||this._log.warn("clean queue with messages",{reason:e}),this._changesQueue.clear(e),this._asyncChecksManager.reset(),this._resetTimer()},e.prototype._handleError=function(e){switch(e.error){case f.ErrorCode.CANNOT_GET_TEXT_STATS:this._statsRequester.onError(e.id,new Error("Server Error"));break;case f.ErrorCode.CANNOT_FIND_SYNONYM:this._synonymsRequester.onError(e.id,new Error("can not find synonym"));break;case f.ErrorCode.RUNTIME_ERROR:this._runtimeErrorCounter.inc(),this._clear("runtime_error");break;default:this._handler.onError(i.__assign({kind:"error"},e)),this._log.error("Error",{message:e})}},e}();t.CAPIClientImpl=w;var E=function(){function e(e){void 0===e&&(e=s.Duration.minutes(5).toMillis()),this._windowTime=e,this._count=0}return e.prototype.inc=function(){this._count++,this._startCounter()},Object.defineProperty(e.prototype,"count",{get:function(){return this._count},enumerable:!0,configurable:!0}),e.prototype._startCounter=function(){var e=this;this._timer=this._timer||setTimeout(function(){e._timer=void 0,e._count-- >0&&e._startCounter()},this._windowTime)},e}(),C=function(){function e(){this.reset()}return e.prototype.getState=function(){return{plagiarism:this._pendingRevision>this._finishedRevisions.plagiarism?"checking":"idle"}},e.prototype.stage=function(e){this._pendingRevision=Math.max(this._pendingRevision,e)},e.prototype.finish=function(e){this._finishedRevisions[e.check]=Math.max(this._finishedRevisions[e.check],e.rev)},e.prototype.reset=function(){this._pendingRevision=0,this._finishedRevisions={plagiarism:-1}},e.prototype.resetCheck=function(e){this._finishedRevisions[e]=-1},e}();t.AsyncChecksStateManager=C},545:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2);!function(e){var t=function(){function e(e){this.id=e}return e}();e.Base=t;var n=function(e){function t(t){var n=e.call(this,t)||this;return n.action="ping",n}return r.__extends(t,e),t}(t);e.Ping=n;var i=function(e){function t(t){var n=e.call(this,t)||this;return n.action="pong",n}return r.__extends(t,e),t}(t);e.Pong=i;var o=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.name=n,i.value=r,i.action="option",i}return r.__extends(t,e),t}(t);e.Option=o;var s=function(e){function t(t,n,r,i,o,s,a,c){void 0===a&&(a="");var u=e.call(this,t)||this;return u.client=n,u.clientVersion=r,u.extDomain=i,u.dialect=o,u.docid=s,u.token=a,u.documentContext=c,u.action="start",u}return r.__extends(t,e),t}(t);e.Start=s;var a=function(e){function t(t,n,r,i,o){var s=e.call(this,t)||this;return s.rev=n,s.score=r,s.dialect=i,s.scores=o,s.action="finished",s}return r.__extends(t,e),t}(t);e.Finish=a;var c=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.rev=n,i.documentContext=r,i.action="set_context",i}return r.__extends(t,e),t}(t);e.SetContext=c;var u=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.rev=n,i.check=r,i.action="async_check_finished",i}return r.__extends(t,e),t}(t);e.AsyncCheckFinished=u;var l=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;return o.rev=n,o.doc_len=r,o.deltas=i,o.action="submit_ot",o}return r.__extends(t,e),t}(t);e.SubmitOt=l;var d=function(e){function t(t,n,r,i,o,s,a,c,u,l,d,h,p,f,g,m,_,y,v,b,w,E,C,S){var x=e.call(this,t)||this;return x.rev=n,x.begin=r,x.end=i,x.highlightBegin=o,x.highlightEnd=s,x.text=a,x.pname=c,x.highlightText=u,x.category=l,x.categoryHuman=d,x.group=h,x.title=p,x.details=f,x.examples=g,x.explanation=m,x.transforms=_,x.replacements=y,x.free=v,x.extra_properties=b,x.hidden=w,x.cardLayout=E,x.sentence_no=C,x.todo=S,x.action="alert",x}return r.__extends(t,e),t}(t);e.Alert=d;var h=function(e){function t(t){var n=e.call(this,t)||this;return n.action="remove",n}return r.__extends(t,e),Object.defineProperty(t.prototype,"alertId",{get:function(){return this.id},enumerable:!0,configurable:!0}),t}(t);e.RemoveAlert=h;var p=function(e){function t(t,n){var r=e.call(this,t)||this;return r.checks=n,r.action="toggle_checks",r}return r.__extends(t,e),t}(t);e.ToggleChecks=p;var f=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.begin=n,i.token=r,i.action="synonyms",i}return r.__extends(t,e),t}(t);e.SynonymsRequest=f;var g=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.token=n,i.synonyms=r,i.action="synonyms",i}return r.__extends(t,e),t}(t);e.SynonymsMessage=g;var m=function(e){function t(t,n,r,i,o,s,a){var c=e.call(this,t)||this;return c.type=n,c.alertId=r,c.position=i,c.text=o,c.previousText=s,c.lens=a,c.action="feedback",c}return r.__extends(t,e),t}(t);e.UserFeedback=m;var _=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.error=n,i.severity=r,i.action="error",i}return r.__extends(t,e),t}(t);e.Error=_;var y=function(e){function t(t){var n=e.call(this,t)||this;return n.action="get_text_stats",n}return r.__extends(t,e),t}(t);e.StatsRequest=y}(t.Message||(t.Message={}))},546:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(300);!function(e){function t(e,t){var n=t/60,i=r.secondsToTime(e.words/n);return i.s=i.h>0&&i.m>10?0:Math.floor(i.s),i}function n(e){return t(e,250)}function i(e){return t(e,130)}function o(t,n){var r={words:t,chars:n,sentences:Math.floor(t/5),readingTime:{},speakingTime:{},uniqueWords:40*Math.random(),uniqueWordsIndex:100*Math.random(),rareWords:20*Math.random(),rareWordsIndex:100*Math.random(),wordLength:5.4,wordLengthIndex:100*Math.random(),sentenceLength:16.7,sentenceLengthIndex:100*Math.random(),readabilityScore:73,readabilityDescription:"Your text is likely to be understood by a reader who has at least 7th grade education (age 12)"};return r.readingTime=e.calculateReadingTime(r),r.speakingTime=e.calculateSpeakingTime(r),r}e.calculateReadingTime=n,e.calculateSpeakingTime=i,e.generateStats=o}(t.DocumentStatistics||(t.DocumentStatistics={}))},547:function(e,t,n){"use strict";function r(e){if(null===e||"null"===e||"boolean"==typeof e)return null;var t=Number(e);return Number.isNaN(t)?null:t}function i(e){return"null"===e||"undefined"===e?null:"true"===e||"false"!==e&&"0"!==e&&Boolean(e)}function o(e,t){return"null"===e||"undefined"===e||null===e||void 0===e?t:"true"===e||"false"!==e&&"0"!==e&&Boolean(e)}function s(e){try{return JSON.parse(decodeURI(e))}catch(e){return null}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(60),c=function(){function e(e){this._value=e}return e.prototype.getStr=function(){return void 0!==this._value&&null!==this._value&&"undefined"!==this._value&&"null"!==this._value?String(this._value):null},e.prototype.getNum=function(){return r(this._value)},e.prototype.getBool=function(){return i(this._value)},e.prototype.getBoolOrDefault=function(e){return o(this._value,e)},e.prototype.getObject=function(){return s(this._value)},e.prototype.getArray=function(){return s(this._value)},e.prototype.getObjProp=function(e){return this._value.hasOwnProperty(e)?this._value[e]:null},e}();t.Property=c;var u=function(){function e(){}return e.prototype.getStr=function(e){return this.hasOwnProperty(e)?String(this[e]):null},e.prototype.getNum=function(e){return this.hasOwnProperty(e)?r(this[e]):null},e.prototype.getBool=function(e){return this.hasOwnProperty(e)?i(this[e]):null},e.prototype.getObject=function(e){return this.hasOwnProperty(e)?s(this[e]):null},e.prototype.has=function(e){return this.hasOwnProperty(e)},e.prototype.ifPresent=function(e,t){this[e]&&t&&t.apply(this[e])},e.of=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=new e,i=0,o=t;i<o.length;i++){var s=o[i];for(var a in s){var c=s[a];r[a]="object"==typeof c?encodeURI(JSON.stringify(c)):c}}return r},e.prototype.entries=function(){var e=this;return Object.keys(this).map(function(t){return[t,new c(e[t])]})},e.find=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=t.find(function(t){return t.has(e)});return new c(r&&r[e])},e}();t.Properties=u;var l=function(){function e(e,t,n){this._token=n,this._endpoints={props:"props/v2",mimic:"mimic"},this._url=a.RequestBuilder.join(e,"api"),this._ajax=a.Ajax.factory(t)}return e.prototype.load=function(){return this._execute(a.RequestBuilder.get(this._url,this._endpoints.props)).then(u.of)},e.prototype.get=function(e){return this._execute(a.RequestBuilder.get(this._url,this._endpoints.props,e),a.Ajax.parseText).then(function(t){return u.of((n={},n[e]=t||null,n));var n})},e.prototype.save=function(e){return this._execute(a.RequestBuilder.post(this._url,this._endpoints.props).json(e),a.Ajax.toVoid)},e.prototype.getMimic=function(e){return this._execute(a.RequestBuilder.get(this._url,this._endpoints.mimic).cookie("gnar_containerId",e))},e.prototype.getMimicWithProps=function(e){return this._execute(a.RequestBuilder.get(this._url,this._endpoints.mimic,"withProps").cookie("gnar_containerId",e)).then(function(e){var t=e.groups,n=e.properties;return{experiments:new Set(t),properties:u.of(n)}})},e.prototype._execute=function(e,t){return this._token&&e.cookie("grauth",this._token),this._ajax(e.build(),t)},e.targetTag="dapi",e}();t.Dapi=l},548:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(18),i=n(294),o=n(43),s=n(295),a=n(5),c=function(){function e(e){if(this._delta={},!e||!e.id)throw new Error("document is undefined or doesn't have ID");this._original=Object.assign({},e,{id:String(e.id)}),this._settings=i.DoxDocumentSettings.Holder.fromJSON(e.extra_params),this._proofit=r.Option.of(e.proofit).map(s.Proofit.parseResult)}return Object.defineProperty(e.prototype,"id",{get:function(){return this._original.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this._delta.title||this._original.title||""},set:function(e){this._delta.title=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstContent",{get:function(){return this._original.first_content||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"content",{get:function(){return this._original.content||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"revision",{get:function(){return this._original.vsn||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originalFileName",{get:function(){return this._original.orig_filename||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"createdAt",{get:function(){return this._original.created_at?o.stringToDate(this._original.created_at):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updatedAt",{get:function(){return this._original.updated_at?o.stringToDate(this._original.updated_at):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errors",{get:function(){return this._delta.errors||this._original.errors||0},set:function(e){this._delta.errors=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._original.size||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"settings",{get:function(){return this._getSettingsHolder},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"genre",{get:function(){return this.settings.genre.orNull()},enumerable:!0,configurable:!0}),e.prototype.setGenre=function(e){this._deltaSettings=this._getSettingsHolder.changeGenre(e)},Object.defineProperty(e.prototype,"checks",{get:function(){return this.settings.checks.orNull()},enumerable:!0,configurable:!0}),e.prototype.setChecks=function(e){this._deltaSettings=this._getSettingsHolder.changeChecks(e)},Object.defineProperty(e.prototype,"context",{get:function(){return this.settings.context},enumerable:!0,configurable:!0}),e.prototype.setContext=function(e){this._deltaSettings=this._getSettingsHolder.changeContext(e)},Object.defineProperty(e.prototype,"proofit",{get:function(){return this._proofit.orNull()},enumerable:!0,configurable:!0}),e.prototype.resetProofit=function(){this._proofit=r.None},e.prototype._isDirty=function(){return Object.getOwnPropertyNames(this._delta||{}).length>0||void 0!==this._deltaSettings},e.prototype._popChanges=function(){var e=this._getDeltaRawDocument(this._delta,this._deltaSettings);return e.id=Number(this._original.id),e},e.prototype._getDeltaRawDocument=function(e,t){if(t){var n=t.toJSON();return a.ObjectUtils.update(e,{extra_params:n})}return Object.assign({},e)},e.prototype._applyChanges=function(e){this._original=Object.assign({},e,{id:String(e.id)}),e.extra_params&&(this._settings=i.DoxDocumentSettings.Holder.fromJSON(e.extra_params)),e.proofit&&(this._proofit=r.Option.of(e.proofit).map(s.Proofit.parseResult)),this._deltaSettings=void 0,this._delta={}},Object.defineProperty(e.prototype,"_getSettingsHolder",{get:function(){return void 0!==this._deltaSettings?this._deltaSettings:this._settings},enumerable:!0,configurable:!0}),e}();t.DoxDocument=c},549:function(e,t,n){"use strict";var r=this;Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(2),s=n(148),a=n(6),c=n(197),u=n(97);!function(e){e[e.DISCONNECTED=0]="DISCONNECTED",e[e.CONNECTING=1]="CONNECTING",e[e.INITIALIZING=2]="INITIALIZING",e[e.RECONNECT_SCHEDULED=3]="RECONNECT_SCHEDULED",e[e.CONNECTED=4]="CONNECTED",e[e.READY=5]="READY",e[e.WAIT_ACK=6]="WAIT_ACK",e[e.CLOSED=7]="CLOSED"}(i=t.States||(t.States={}));var l;!function(e){e[e.CONNECT=0]="CONNECT",e[e.CONNECTED=1]="CONNECTED",e[e.SCHEDULE_RECONNECT=2]="SCHEDULE_RECONNECT",e[e.DISCONNECT=3]="DISCONNECT",e[e.CLOSE=4]="CLOSE",e[e.INITIALIZE=5]="INITIALIZE",e[e.INITIALIZED=6]="INITIALIZED",e[e.SEND=7]="SEND",e[e.ACK=8]="ACK",e[e.RESET=9]="RESET"}(l=t.Events||(t.Events={}));var d=function(){function e(e){var t=this;this._url=e,this._log=a.Monitoring.Logging.getLogger("coreclients.remote",a.Logging.LogLevel.DEBUG),this._ws=s.WS.create().onDisconnect(function(e){return t._handleDisconnect(e)}).onMessage(function(e,n){return t._handleMessage(n)}).onError(s.errPrintln),this._fsm=new c.StateMachine(i.DISCONNECTED,i.CLOSED).from(i.DISCONNECTED).to(i.CONNECTING).on(l.CONNECT).from(i.DISCONNECTED).to(i.RECONNECT_SCHEDULED).on(l.SCHEDULE_RECONNECT).from(i.CONNECTING,i.RECONNECT_SCHEDULED).to(i.CONNECTED).on(l.CONNECTED).from(i.CONNECTED).to(i.INITIALIZING).on(l.INITIALIZE).from(i.INITIALIZING).to(i.READY).on(l.INITIALIZED).from(i.CONNECTED,i.CONNECTING,i.RECONNECT_SCHEDULED,i.INITIALIZING,i.READY).to(i.DISCONNECTED).on(l.DISCONNECT).from(i.CONNECTED,i.CONNECTING,i.RECONNECT_SCHEDULED,i.INITIALIZING,i.READY,i.DISCONNECTED).to(i.CLOSED).on(l.CLOSE).on(i.CLOSED,function(e){var n=s.CloseEventInfo.is(e.args)?e.args:void 0;t._conn&&t._conn.close(n),e.args&&e.args instanceof s.WSError&&(t._error=e.args,t._log.error("Remote connection to dox ws closed",t._error))}).on(i.CONNECTING,function(e){return t._connect()})}return Object.defineProperty(e.prototype,"url",{get:function(){return this._url},enumerable:!0,configurable:!0}),e.prototype._handleDisconnect=function(e){return o.__awaiter(this,void 0,void 0,function(){var t,n=this;return o.__generator(this,function(r){switch(r.label){case 0:return[4,this._fsm.event(l.DISCONNECT,e.reason)];case 1:if(!r.sent())return[3,7];this._log.info("Disconnected",e.reason),r.label=2;case 2:return r.trys.push([2,4,,6]),[4,this._disconnectHandler(e,e.reconnect.nextDelay,function(t){return o.__awaiter(n,void 0,void 0,function(){var n,r,s=this;return o.__generator(this,function(o){switch(o.label){case 0:return[4,this._fsm.event(l.SCHEDULE_RECONNECT)];case 1:return o.sent()?[4,e.reconnect.scheduleReconnect(t)]:[3,4];case 2:return n=o.sent(),[4,this._fsm.event(l.CONNECTED,n).catch(function(e){s._log.warn("Reconnect failed due to error",e),n.close()})];case 3:r=o.sent(),r?(this._log.info("Reconnected to DOX WS successful",{url:this._url,canFinalize:r}),this._conn=n):(this._log.info("Immediate disconnect after reconnect to DOX WS",{url:this._url,state:i[this._fsm.current]}),n.close()),o.label=4;case 4:return[2]}})})})];case 3:return r.sent(),[3,6];case 4:return t=r.sent(),this._log.warn("DisconnectHandler failed due to error",t),[4,this._fsm.event(l.CLOSE,t)];case 5:return r.sent(),[3,6];case 6:return[3,8];case 7:this._log.error("Can not enter Disconnected state",e.reason),r.label=8;case 8:return[2]}})})},e.prototype.close=function(e){var t=this;return void 0===e&&(e={}),this._fsm.event(l.CLOSE,e).then(function(e){e&&clearTimeout(t._timeout)})},e.prototype._connect=function(){return o.__awaiter(this,void 0,void 0,function(){var e,t;return o.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,this._ws.connect(this.url)];case 1:return e=n.sent(),[4,this._fsm.event(l.CONNECTED,e)];case 2:return n.sent()?[2,this._conn=e]:(e.close(),[2,void 0]);case 3:throw t=n.sent(),new u.DoxErrors.ConnectionError(this.url);case 4:return[2]}})})},e._defaultReconnect=function(e,t,n){return o.__awaiter(r,void 0,void 0,function(){var r,i,s,a;return o.__generator(this,function(o){switch(r=e.code,i=e.reason,s=e.reconnect,r){case u.DoxErrors.WsCodes.GOING_AWAY:throw new u.DoxErrors.WSGoingAway(s.url);case u.DoxErrors.WsCodes.NOT_FOUND:case u.DoxErrors.WsCodes.UNAUTHORIZED:throw new u.DoxErrors.WSDisconnectedOnInitError(r,i);case u.DoxErrors.WsCodes.TOO_BIG:throw new u.DoxErrors.WSMessageIsTooBigError;case u.DoxErrors.WsCodes.SUBMITTED_FOR_PROOFREADING:case u.DoxErrors.WsCodes.CLIENT_MALFUNCTION:throw new u.DoxErrors.WSNotRetryableError(r,i)}if((a=s.reconnectCounter)>=10)throw new u.DoxErrors.WSDisconnectedAfterMultipleRetries(a,r,i);return[2,n(t)]})})},e}();t.Remote=d},550:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(60),i=n(292),o=n(97);!function(e){var t=function(){function e(e){this._httpRequest=e}return e.text=function(t,n){var i=r.RequestBuilder.create().json();return(t||n)&&i.body({content:t,title:n}),new e(i)},e.file=function(t){var n=r.RequestBuilder.create();if(!t)throw new TypeError("File was not provided");if(!t.name)throw new TypeError("Empty filename passed to file() function");if(!t.size)throw new TypeError("File size wasn't provided");if(t.size>i.MAX_FILE_SIZE)throw new o.DoxErrors.FileSizeOutOfRangeError(i.MAX_FILE_SIZE);var s=(t.name.split("\\").pop()||"").split("/").pop();if(!s)throw new o.DoxErrors.UnsupportedFileTypeError(t.name);if(!s.match(e.supportedExtensionsRE))throw new o.DoxErrors.UnsupportedFileTypeError(s);var a=new FormData;return a.append("source_file",t),n.body(a),new e(n)},e.prototype._getHttpRequestBuilder=function(){return this._httpRequest.isBodyPresent()?this._httpRequest:this._httpRequest.body({})},e.supportedExtensions=["doc","docx","odt","rtf","txt","htm","html"],e.supportedExtensionsRE=new RegExp("\\.("+e.supportedExtensions.join("|")+")$","i"),e}();e.Create=t;var n=function(){function e(e){this._str=e}return e.contains=function(t){return new e(t)},e.all=function(){return new e("")},e.prototype.toSearchString=function(){return this._str},e}();e.Search=n}(t.DoxRequest||(t.DoxRequest={}))},551:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.free=0]="free",e[e.premium=1]="premium"}(t.UserType||(t.UserType={}))},552:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ONLINE="online"},553:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(22),o=n(8),s=n(6),a=n(38),c=n(5),u=n(53),l=n(120);t.ACCEPTED_UPLOAD_EXTENSIONS=["doc","docx","odt","rtf","htm","html","txt"].map(function(e){return"."+e}),t.ACCEPTED_UPLOAD_MIME_TYPES=["application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.oasis.opendocument.text","text/rtf","text/html","text/plain"],t.defaultState={searchText:"",wsConnection:c.Async.defaultValue(),proofitResults:{},deletedDocumentIds:[],first100:c.Async.defaultValue(),remoteSearch:c.Async.defaultValue()};var d=100,h=function(){function e(e,t){this._doxApi=e,this._state=t,this._log=s.Monitoring.Logging.getLogger("model.documents.proofit"),this._operation=null,this.results=this._state.lens("proofitResults"),this.cancelled=new i.Subject,this.wsConnection=this._state.lens("wsConnection")}return e.prototype.init=function(){var e=this;c.invariant(null===this._operation,"Expect operation to be not established"),this._operation=c.Async.OperationRetrier.create(function(){return e._connect()},this.wsConnection)},e.prototype.reset=function(){var e=this.wsConnection.get();c.Async.isOk(e)?this._terminate(e.value):this._operation&&this._operation.unsubscribe(),this._operation=null,this.wsConnection.set(t.defaultState.wsConnection)},e.prototype._connect=function(){var e=this;return this._doxApi.openDocumentsWS({metadataChangeHandler:function(t,n){n.proofit.forEach(function(n){e.results.modify(function(e){return Object.assign({},e,(r={},r[t]=n,r));var r}),n.status===u.Proofit.JobStatus.cancelled&&e.cancelled.next({id:t})})}}).then(function(e){return{unsubscribe:e.close.bind(e)}})},e.prototype._terminate=function(e){return r.__awaiter(this,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.results.set(t.defaultState.proofitResults),this.cancelled.next({id:null}),[4,e.unsubscribe()];case 1:return r.sent(),[3,3];case 2:throw n=r.sent(),this._log.error("Failed to close dox session",n),n;case 3:return[2]}})})},e}();t.DocumentListProofitModelImpl=h;var p=function(){function e(e,t,n,r,i){var a=this;this._state=e,this._doxApi=t,this._settings=n,this._connectivity=r,this._handleHttpDoxError=i,this._log=s.Monitoring.Logging.getLogger("model.documents.list"),this._isLocalSearch=o.Atom.create(!1),this._first100=this._state.lens("first100"),this._remoteSearch=this._state.lens("remoteSearch"),this._deletedDocumentIds=this._state.lens("deletedDocumentIds"),this.searchText=this._state.lens("searchText"),this._trimmedSearchText=this.searchText.view(function(e){return e.trim()}),this.isFirstTimeLoaded=this._first100.view(c.Async.isOk),this.isSearching=this._remoteSearch.view(function(e){return c.Async.isInProgress(e)||c.Async.isError(e)}),this.searchResults=o.Atom.combine(this._first100,this._remoteSearch,this._deletedDocumentIds,this._trimmedSearchText,function(e,t,n,r){return c.Async.flatMap(e,function(e){return c.Async.isTerminated(t)?c.Async.flatMap(t,function(t){return c.Async.ok(a._localSearch(e,t||[],n,r))}):c.Async.ok(a._localSearch(e,[],n,r))})}),this._retryWhen=function(e){return!(e instanceof u.HTTPError)||c.isServerErrorCode(e.code)},this._documentSubs=[],this._settings.firstCall.get()||this._first100.filter(c.Async.isOk).first().subscribe(function(){a._settings.firstCallDone()}),this._first100.filter(function(e){return c.Async.isOk(e)}).subscribe(function(e){return a._isLocalSearch.set(e.value.length<d)}),this.searchResults.filter(function(e){return c.Async.isError(e)||c.Async.isFatal(e)}).switchMap(c.Animation.rafScheduler).subscribe(function(e){c.Async.isFatal(e)?(e.error instanceof u.HTTPError?a._handleHttpDoxError(e.error,"DOX: Cannot load document list"):a._connectivity.setState({type:"dox",state:{type:c.isServerErrorCode(e.error.code)?"serverError":"unknownConnectionError"}}),a._log.error("DOX: Cannot load document list",e.error)):c.Async.isError(e)&&a._log.warn("DOX: Attempt to load document list failed",e.error,{attempt:e.attempt})})}return e.prototype.load=function(){this._reset(),this._loadDocuments()},e.prototype.reset=function(){this._documentSubs.map(function(e){return e.unsubscribe()}),this._documentSubs=[],this._reset()},e.prototype._reset=function(){this.searchText.set(t.defaultState.searchText),this._isLocalSearch.set(!1),this._remoteSearch.set(c.Async.defaultValue()),this._first100.set(c.Async.defaultValue())},e.prototype._loadDocuments=function(){var e=this,t=o.Atom.create(!1);this._documentSubs=[c.Async.OperationRetrier.create(function(){return e._doxApi.listDocuments(d,l.DoxClient.OrderBy.Updated,!e._settings.firstCall.get())},this._first100,c.Async.OperationRetrier.RetryStrategy.conditional(this._retryWhen,c.Async.OperationRetrier.RetryStrategy.linear(3,3e3))),this._trimmedSearchText.withLatestFrom(this._first100,t).filter(function(e){return!e[0]}).throttleTime(1e3).filter(function(e){var t=(e[0],e[1]),n=e[2];return c.Async.isTerminated(t)&&!n}).subscribe(function(){t.set(!0),e._doxApi.listDocuments(d,l.DoxClient.OrderBy.Updated,!1).then(function(t){return e._first100.set(c.Async.ok(t))}).catch(function(t){t instanceof u.HTTPError&&e._handleHttpDoxError(t,"Failed to refresh document list"),e._log.info("Failed to refresh document list",t)}).then(function(){t.set(!1)})}),this._isLocalSearch.switchMap(function(t){return t?i.Observable.empty():i.Observable.merge(e._trimmedSearchText.map(function(e){return c.Either.left(e)}),e._trimmedSearchText.debounceTime(500).map(function(e){return c.Either.right(e)})).switchMap(function(t){return e._remoteSearch.set(c.Async.defaultValue()),c.Either.isLeft(t)||!t.value?i.Observable.empty():i.Observable.using(function(){return c.Async.OperationRetrier.create(function(){return e._doxApi.searchDocument(l.DoxRequest.Search.contains(t.value),d)},e._remoteSearch,c.Async.OperationRetrier.RetryStrategy.conditional(e._retryWhen,c.Async.OperationRetrier.RetryStrategy.linear(3,3e3)))},function(){return e._remoteSearch.filter(c.Async.isTerminated).first()})})}).subscribe()]},e.prototype._localSearch=function(e,t,n,r){var i=new RegExp(r.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"i");return t.concat(e.filter(function(e){return!r||i.test(e.firstContent)||i.test(e.title)}).filter(function(e){return-1===t.findIndex(function(t){return t.id===e.id})})).filter(function(e){return n.indexOf(e.id)<0})},e}(),f=function(){function e(e,t,n,r,i,a,c){this._state=e,this._doxApi=t,this._alertCache=n,this._navigateToDocument=r,this._notifications=i,this.browser=a,this._handleHttpDoxError=c,this._log=s.Monitoring.Logging.getLogger("model.documents.actions"),this._deletedDocumentIds=this._state.lens("deletedDocumentIds"),this.documentUploadProgress=o.Atom.create(null)}return e.prototype.createDocument=function(e,t){return this._doxApi.createDocument(l.DoxRequest.Create.text(e,t))},e.prototype.createDocumentAndNavigate=function(e){var t=this;return this.createDocument().then(function(n){e.get()?t.navigateToDocument(n.id):t._notifications.show(t._notifications.create.newDocumentCreated(function(){return t.navigateToDocument(n.id)}))}).catch(function(e){return t.handleCreateDocumentError(e)})},e.prototype.deleteDocument=function(e){var t=this;return this._deletedDocumentIds.modify(function(t){return t.concat([e])}),this._doxApi.deleteDocumentById(e).catch(function(n){throw t._deletedDocumentIds.modify(function(t){return t.filter(function(t){return t!==e})}),n}).then(function(n){try{t._alertCache.remove(e.toString())}catch(e){t._log.debug("could not remove alert cache for deleted doc",e)}})},e.prototype.restoreDocument=function(e){var t=this;return this._deletedDocumentIds.modify(function(t){return t.filter(function(t){return t!==e})}),this._doxApi.restoreDocumentById(e).catch(function(n){throw t._deletedDocumentIds.modify(function(t){return t.concat([e])}),n instanceof u.HTTPError&&t._handleHttpDoxError(n,"Failed to restore document"),n})},e.prototype.downloadOriginal=function(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:if(this._log.info("downloadOriginal.initiated"),!a.isFetchBlobDownloadSupported)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this._doxApi.downloadOriginal(e).then(u.RawFile.saveToFS)];case 2:return n.sent(),[3,4];case 3:return t=n.sent(),this.handleDownloadDocumentError(t),[3,4];case 4:return[3,6];case 5:this._notifications.show(this._notifications.create.blobDownloadUnsupported()),n.label=6;case 6:return[2]}})})},e.prototype.downloadProofread=function(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:if(this._log.info("downloadProofread.initiated"),!a.isFetchBlobDownloadSupported)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this._doxApi.downloadProofread(e).then(u.RawFile.saveToFS)];case 2:return n.sent(),[3,4];case 3:return t=n.sent(),this.handleDownloadDocumentError(t),[3,4];case 4:return[3,6];case 5:this._notifications.show(this._notifications.create.blobDownloadUnsupported()),n.label=6;case 6:return[2]}})})},e.prototype.uploadDocument=function(e){return r.__awaiter(this,void 0,void 0,function(){var t=this;return r.__generator(this,function(n){switch(n.label){case 0:return[4,this._doxApi.createDocument(l.DoxRequest.Create.file(e)).then(function(e){return t._state.lens("first100").modify(function(t){return c.Async.isOk(t)?c.Async.ok(new Array(e).concat(t.value)):t}),e})];case 1:return[2,n.sent()]}})})},e.prototype.navigateToDocument=function(e){this._navigateToDocument(""+e)},e.prototype.handleDownloadDocumentError=function(e){this._log.error("downloadDocument failed",e);var t={unauthorized:e instanceof l.DoxErrors.UnauthorizedError,notFound:e instanceof l.DoxErrors.DocumentNotFoundError,temporary:e instanceof l.DoxErrors.TooManyRequestsError||e instanceof l.DoxErrors.ConnectionError};t.unauthorized?this._notifications.show(this._notifications.create.unauthorizedError()):t.notFound?this._notifications.show(this._notifications.create.downloadDocumentNotFoundError()):t.temporary?this._notifications.show(this._notifications.create.isTemporaryDownloadError()):this._notifications.show(this._notifications.create.error())},e.prototype.handleCreateDocumentError=function(e){e instanceof u.HTTPError?(this._handleHttpDoxError(e,"Failed to create new document"),this._log.warn("Failed to create new document",e)):c.isClientFetchError(e)?(this._log.warn("Failed to create new document",e),this._notifications.showError("Failed to create new document: "+(e&&e.message))):(this._log.error("Failed to create new document",e),this._notifications.showError("Failed to create new document: "+(e&&e.message)))},e.prototype.handleDeleteDocumentError=function(e){e instanceof u.HTTPError&&(this._handleHttpDoxError(e,"Failed to remove document"),this._log.error("Failed to remove document",e))},e}(),g=function(){function e(e,t,n,r,i,o,s,a){this._state=e,this._doxApi=t,this._settings=n,this._alertCache=r,this._browser=i,this._connectivity=o,this._notifications=s,this._navigateToDocument=a,this.proofit=new h(this._doxApi,this._state),this.list=new p(this._state,this._doxApi,this._settings,this._connectivity,this._doxHttpErrorHandler),this.actions=new f(this._state,this._doxApi,this._alertCache,this._navigateToDocument,this._notifications,this._browser,this._doxHttpErrorHandler)}return e.prototype._doxHttpErrorHandler=function(e){switch(e.code){case l.DoxErrors.HttpCodes.UNAUTHORIZED:this._connectivity.setState({type:"dox",state:{type:"unauthorized"}});break;case l.DoxErrors.HttpCodes.TOO_MANY_REQUESTS:this._notifications.show(this._notifications.create.error());break;default:this._notifications.showError(e.message)}},e}();t.DocumentsPageModelImpl=g},554:function(e,t,n){"use strict";function r(e,t){if(e<=0)return null;var n=t.filter(function(e){return e.group===s.AlertGroup.plagiarism}).reduce(function(e,t){return e+t.range.end-t.range.start},0);return Math.round(Math.min(100,n/e*100))}function i(e,t){var n=e>0?t.reduce(function(e,t){return e+(a[t.group]||0)},0)/e:null;return null!==n?Math.floor(100*(1-Math.min(1,11*n))):null}function o(e,t,n,o){var s=n.filter(function(e){return"synonym"!==e.kind}),a=n.filter(function(e){return"plagiarism"===e.kind}).length,c=s.filter(function(e){return e.isFree}).length;return{criticalAlerts:c,premiumAlerts:o-a,visiblePremiumAlerts:s.length-c-a,plagiarismPercentage:r(e,s),score:i(t,s)}}Object.defineProperty(t,"__esModule",{value:!0});var s=n(98),a=(c={},c[s.AlertGroup.contextualSpelling]=1.2,c[s.AlertGroup.grammar]=1,c[s.AlertGroup.sentenceStructure]=.9,c[s.AlertGroup.punctuation]=.7,c[s.AlertGroup.style]=.3,c[s.AlertGroup.enhancement]=0,c[s.AlertGroup.plagiarism]=0,c);t.calculateScores=o;var c},555:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(22),o=n(556),s=n(5),a=n(6),c=n(120),u=n(53),l=n(568);!function(e){e[e.documentNotFound=0]="documentNotFound",e[e.unauthorized=1]="unauthorized",e[e.changed=2]="changed",e[e.disconnected=3]="disconnected",e[e.cannotReconnect=4]="cannotReconnect"}(t.DocEventType||(t.DocEventType={})),t.defaultState={session:null};var d=function(){function e(e,t,n,r,o){this._docId=e,this._state=t,this._doxApi=n,this._doxConnectivity=r,this._preventSyncWithDox=o,this._sessionState=this._state.lens("session"),this._session=null,this._incomingChangeSubject=new i.Subject,this._changeAcceptedSubject=new i.Subject,this._changeDroppedSubject=new i.Subject}return e.prototype.startSession=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t,n,i;return r.__generator(this,function(r){switch(r.label){case 0:return[4,this._connectToDox()];case 1:return e=r.sent(),t=e.initialText,n=e.meta,i=t.endsWith("\n")?t.slice(0,-1):t,this._sessionState.set(o.createInitialState(this._docId,n.title,i,{source:"init",proofit:n.proofit.orNull(),showBanner:!1})),this._session=new o.DocumentSessionImpl(this._sessionState,e,this._incomingChangeSubject,this._changeAcceptedSubject,this._changeDroppedSubject,function(){}),[2,{documentSession:this._session,initialGenre:n.settings.genre.orNull(),initialChecks:n.settings.checks.orNull()}]}})})},e.prototype._connectToDox=function(){return r.__awaiter(this,void 0,void 0,function(){var e,t=this;return r.__generator(this,function(n){switch(n.label){case 0:return[4,this._doxApi.openDocumentById(this._docId,{changeHandler:function(e,n){if(!t._session)throw new s.InvariantError("Expect remote session to be established");t._preventSyncWithDox||t._incomingChangeSubject.next(n)},metadataChangeHandler:function(e,n){if(!t._session)throw new s.InvariantError("Expect remote session to be established");t._session.proofitState.modify(function(e){return n.proofit.fold(function(){return{source:"websocket",proofit:e.proofit,showBanner:!1}},function(t){var n=u.Proofit.isProofitEqual(e.proofit,t);return{source:"websocket",proofit:n?e.proofit:t,showBanner:!n&&l.isProofitCompleted(t.status)}})})},disconnectHandler:function(e,n,r){return e.code!==c.DoxErrors.WsCodes.NOT_FOUND&&e.code!==c.DoxErrors.WsCodes.UNAUTHORIZED||t._doxConnectivity.set({type:"error",reason:e.reason,error:new u.WSError({code:e.code,message:e.reason,status:e.reason})}),e.reconnect.reset(),c.DoxRemoteDocument._defaultReconnect(e,n,r).then(function(){t._doxConnectivity.set({type:"success"})}).catch(function(n){n.code!==c.DoxErrors.WsCodes.GOING_AWAY&&e.code!==c.DoxErrors.WsCodes.SUBMITTED_FOR_PROOFREADING&&(t._doxConnectivity.set({type:"error",reason:"Disconnected: "+e.code,error:n}),a.Monitoring.Logging.getLogger("DocumentModelImpl").info("Reconnect attempt failed, code: "+n))})}},c.DoxRemoteDocument.Queue.create({acceptedMsgHandler:function(e){return t._changeAcceptedSubject.next(e)},droppedMsgsHandler:function(e){return t._changeDroppedSubject.next(e)}}),5e3)];case 1:return e=n.sent(),this._doxConnectivity.set({type:"success"}),[2,e]}})})},e}();t.DocumentModelImpl=d},556:function(e,t,n){"use strict";function r(e,t,n,r){return{id:e,title:t,localText:n,proofitState:r}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(22),o=n(8),s=n(6),a=n(5),c=n(53),u=n(151),l=n(311),d=n(1363),h=n(43);t.createInitialState=r;var p=function(){function e(e,t,n,r,a,c){var d=this;this._state=e,this._doxInit=t,this._incomingChange=n,this._acceptedMessage=r,this._droppedMessages=a,this._onClose=c,this._log=s.Monitoring.Logging.getLogger("model.DocumentSessionImpl"),this._counter=s.Monitoring.TimeSeries.root.getCounter("dox_editor_ts"),this._sessionActive=!0,this.localTitle=this._state.lens("title"),this.localText=this._state.lens("localText"),this.proofitState=this._state.lens("proofitState"),this.proofitCompleted=this.proofitState.skip(1).map(function(e){var t=e.proofit,n=e.showBanner;return t&&n?t:null}).distinctUntilChanged(),this.id=this._state.view("id"),this.isNew=this._state.view(function(e){return!(!e.title&&!e.localText)}).scan(function(e,t){return e||t},!1),this.localChangesSaved=o.Atom.create(!0),this.textChangedByServer=new i.Subject,this._remoteText=t.initialText,this._settingsHolder=t.meta.settings,this._subs=[this._incomingChange.subscribe(function(e){if(d._log.trace("incoming change",e),u.Change.isFlush(e));else{u.Change.isDelta(e)&&h.assert(d._remoteText.length,e.prevLen,"delta should have prevlen equal to current text len");var t=u.Change.isReset(e)?e.text:u.Change.ins(0,d._remoteText).compose(e).text.getOrElse(d._remoteText),n=t.endsWith("\n")?t.slice(0,-1):t;d._remoteText=t,d.localText.set(n),d.textChangedByServer.next(n),d.localChangesSaved.set(d._doxInit.remoteDocument.inSync)}},function(e){d._log.error("incoming change fail",e)}),this._acceptedMessage.subscribe(function(e){d._log.trace("accepted message",e),l.ChangesQueue.isCmd(e)||d._incCounter(e.kind,"accepted"),d.localChangesSaved.set(d._doxInit.remoteDocument.inSync)},function(e){d._log.error("accepted message fail",e)}),this._droppedMessages.subscribe(function(e){var t=d._groupMessages(e.messages);void 0!==t.change&&d._incCounter("change","dropped",t.change),void 0!==t.meta&&d._incCounter("meta","dropped",t.meta),t.change&&d._log.warn("got dropped messages",{counts:t,reason:e.reason}),d.localChangesSaved.set(d._doxInit.remoteDocument.inSync)},function(e){d._log.error("accepted message fail",e)})]}return e.prototype._expectActiveSession=function(){a.invariant(this._sessionActive,"Expect remote session to be established")},e.prototype.setDocumentContent=function(e){this._expectActiveSession();var t=e+"\n",n=d.Diff.diffAsChanges(this._remoteText,t);this._log.trace("push delta",n),this._remoteText=t,n.isEmpty?this._log.trace("drop empty delta",n):(this.localChangesSaved.set(!1),this._doxInit.remoteDocument.pushChanges(n)),this.localText.set(e)},e.prototype.setDocumentTitle=function(e){this._expectActiveSession(),this.localTitle.set(e),this.localChangesSaved.set(!1),this._doxInit.remoteDocument.updateMetadata({title:e})},e.prototype.setDocumentGenre=function(e){this._expectActiveSession();var t=this._settingsHolder.changeGenre(e);this._updateSettings(t)},e.prototype.setDocumentAlertCount=function(e){this._expectActiveSession(),this._doxInit.remoteDocument.updateMetadata({errors:e})},e.prototype.setDocumentChecks=function(e){this._expectActiveSession();var t=this._settingsHolder.changeChecks(e);this._updateSettings(t)},e.prototype.end=function(){var e=this;return new Promise(function(t,n){e._onClose(),e._doxInit.remoteDocument.pushChanges(u.Change.flush()),e._subs.forEach(function(e){return e.unsubscribe()}),e._subs=[],e._expectActiveSession(),e._sessionActive=!1,e._doxInit.remoteDocument.close().then(function(){return t()})})},Object.defineProperty(e.prototype,"context",{get:function(){return this._doxInit.meta.settings.context.getOrElse(c.DocumentContext.empty)},enumerable:!0,configurable:!0}),e.prototype.setDocumentContext=function(e){this._expectActiveSession();var t=this._settingsHolder.changeContext(e);this._updateSettings(t)},e.prototype._updateSettings=function(e){this._incCounter("meta","sent"),this.localChangesSaved.set(!1),this._settingsHolder=e,this._doxInit.remoteDocument.updateMetadata({settings:e})},e.prototype._incCounter=function(e,t,n){void 0===n&&(n=1),this._counter.getCounter("message."+e+"."+t).increment(n)},e.prototype._groupMessages=function(e){return e.reduce(function(e,t){return void 0===e[t.kind]&&(e[t.kind]=0),e[t.kind]++,e},{})},e}();t.DocumentSessionImpl=p},557:function(e,t,n){"use strict";function r(e,t,n){void 0===e&&(e=null),void 0===t&&(t=null),void 0===n&&(n=!1);var r=h.Cookie.getCookie(g),i=c.setPlagiarism(t||c.defaultState,"true"===r),o=e||(n?"academic_general":"general");return{textStats:u.defaultState,checkingSettings:i,checkingGenre:o,editor:l.defaultState,cards:d.defaultState}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=n(53),s=n(8),a=n(6),c=n(205),u=n(298),l=n(558),d=n(297),h=n(5),p=n(1382),f=n(1383),g="isPlagiarismFunnel";t.defaultState=r(),t.createDefaultState=r;var m=function(){function e(e,t,n,r,i,o,a,c,u){this._state=e,this.documentSession=t,this.textStats=n,this._capiWsUrl=r,this._dialectSettingsModel=i,this._features=o,this._telemetry=a,this._alertCache=c,this._capiConnectivity=u,this.editorEngine=s.Atom.create(null),this.cardsModel=null,this.denaliScrollModel=new p.DenaliScrollModelImpl,this.denaliEditorViewModel=new f.DenaliEditorViewModel,this.contextState=s.Atom.create(this.documentSession.context),this._documentSyncSubs=null}return e.prototype.startEditor=function(e,t,n){var r=this;h.invariant(null===this.editorEngine.get()&&null===this._documentSyncSubs,"editor should not be started");var i=new c.CheckingSettingsModelImpl(this._state.lens("checkingGenre"),this._state.lens("checkingSettings"),this._telemetry),s=this._dialectSettingsModel.dialectOrDefault.get(),a=new l.GrammarlyEditorEngine(this._state.lens("editor"),e,"textarea",t,this.documentSession.id.get(),this.documentSession.localText.get(),this._capiWsUrl,i,this._dialectSettingsModel,function(){return r._alertCache.load(r.documentSession.id.get().toString(),s,r._features.isFree)},function(e){return r._alertCache.save(r.documentSession.id.get().toString(),s,r._features.isFree,e)},this._telemetry,this._capiConnectivity,this._features.isDesktopEditor?"desktop_editor":void 0,n,this._features.demoMode);return this.cardsModel=new d.CardsModelImpl(this._state.lens("cards"),a,this._features),a.mount(),this._documentSyncSubs=[this.documentSession.textChangedByServer.subscribe(function(e){a.setDocumentContent(e)}),a.textChangedByUser.subscribe(function(e){r.documentSession.setDocumentContent(e)}),a.scores.view(function(e){return[e.visiblePremiumAlerts,e.criticalAlerts]}).skip(1).subscribe(function(e){var t=e[0],n=e[1];r.documentSession.setDocumentAlertCount(n+(r._features.isFree?0:t))}),i.checksEnabled.skip(1).subscribe(function(e){return r.documentSession.setDocumentChecks(e)}),i.genre.skip(1).subscribe(function(e){return r.documentSession.setDocumentGenre(e)})],n&&this._documentSyncSubs.push(this.contextState.skip(1).subscribe(function(e){r.documentSession.setDocumentContext(e),i.genre.set(o.domainToGenre(e.domain))})),this.editorEngine.set(a),a},e.prototype.stopEditor=function(){var e=this.editorEngine.get();if(!e||!this._documentSyncSubs)throw new h.InvariantError("editor should be started");this._documentSyncSubs.forEach(function(e){return e.unsubscribe()}),this._documentSyncSubs=null,this.editorEngine.set(null),e.unmount()},Object.defineProperty(e.prototype,"isActive",{get:function(){return null!==this.editorEngine.get()},enumerable:!0,configurable:!0}),e.prototype.end=function(){return i.__awaiter(this,void 0,void 0,function(){var e;return i.__generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),this.isActive&&this.stopEditor(),[4,this.documentSession.end()];case 1:return t.sent(),[3,3];case 2:return e=t.sent(),a.Monitoring.Logging.getLogger("model.editor.editor_sesion").error("DOX editor session end failed",e),[3,3];case 3:return[2]}})})},e}();t.EditorSessionImpl=m},558:function(e,t,n){"use strict";function r(e){function t(e){var t=typeof e;return null!=e&&("object"===t||"function"===t)}function n(e){var n={};for(var r in e)"ts"!==r&&"renderTs"!==r&&"tracked"!==r&&("r"!==r&&"origReplacements"!==r&&"rHtml"!==r&&"examples"!==r&&"references"!==r&&"rawMatch"!==r&&(t(e[r])||"selected"===r&&!Array.isArray(e[r]))||(n[r]=e[r]));return n}return e.filter(function(e){return!e.replaced}).map(n)}function i(e,t,n,r,i,o,s,a,c,l,d,h,p,m,_){m&&(u.Capi.CLIENT_NAME=m);var v=u({silentLogs:!0,el:e,docid:parseInt(r,10),value:i,sid:0,capiUrl:o,matches:d,apps:{plagiarismActive:s},editorType:"textarea"===t?{textarea:!0,value:"textarea"}:{contenteditable:!0,value:"contenteditable"},asPlainText:!0,textareaWrapSelector:"#"+n,plagiarismCheckDelay:1e4,dialect:a.orNull(),filter:function(e){return e?e.filter(function(e){return(_||!e.rawMatch.hidden)&&("synonyms"===e.rawMatch.action||c(y.alertGroupFromString(e.rawMatch.group)))}):[]},canRemoveSynonym:function(e){return!!g.DOM.hasParentWithClassName(e,"closeSyn")||!g.DOM.hasParentWithClassName(e,"cardSyn")},extendParams:function(e){e.genre=l()},exposeRawMatch:!0,exposeSynApi:!0,getContainerId:h.getContainerId,capiIdleTimeout:24e4,textareaBottomPadding:36,removeByPIDOnIgnore:!_,synAutofix:!0,skipMousedownWhen:function(e){return g.DOM.hasParentWithClassName(e.target,b.CardBaseClassName)}});if(_)v.synonyms.disable(),v.getMatchClass=function(e){if(!e.rawMatch)return"";if("synonyms"===e.rawMatch.action)return"gr_syn_replaced";var t=f.pnameToLensProp(e.rawMatch.pname,function(e){return e.type});if(!t||e.rawMatch.hidden)return"";var n=["grAlert"+t];e.replaced&&n.push("Replaced"),e.selected&&n.push(" sel");var r=p(e.rawMatch);return r&&n.push(" "+r)," gr_"+e.rawMatch.id+" "+n.join("")};else{var w=v.getMatchClass;v.getMatchClass=function(e,t){var n=w(e,t);return e.rawMatch?((e.rawMatch.renderedOnce||"safari"===S.browser)&&(n+=" gr_disable_anim_appear"),"synonyms"===e.rawMatch.action&&(n+=" gr_syn_replaced"),e.rawMatch.renderedOnce=!0,n):n}}return v}function o(e){return e.rawMatch.group||"synonyms"===e.rawMatch.action}Object.defineProperty(t,"__esModule",{value:!0});var s=n(2),a=n(22),c=n(18),u=n(591),l=n(53),d=n(8),h=n(6),p=n(152),f=n(1384),g=n(5),m=n(38),_=n(205),y=n(98),v=n(569),b=n(308),w=n(554),E=n(1390),C=n(559);t.defaultState={pendingAlertAction:null,alertHighlights:{focused:{id:null,source:null},highlighted:null},alerts:{},premiumMatches:[],checkingStatus:b.CheckingStatus.idle};var S=m.getBrowserInfo(),x=function(){function e(e,t,n,r,i,o,u,l,p,m,v,S,x,T,k,A){var I=this;this._state=e,this._domElement=t,this._textAreaType=n,this._textAreaWrapperElementId=r,this._docId=i,this._initialText=o,this._capiWsUrl=u,this._checkingSettings=l,this._dialectSetting=p,this._getCachedMatches=m,this._cacheSerializableMatches=v,this._telemetry=S,this._capiConnectivity=x,this._capiClientName=T,this._isDenali=k,this._demoMode=A,this.synonymsViewModel=new E.SynonymsViewModelImpl(new C.SynonymsModelImpl(function(e,t){return s.__awaiter(I,void 0,void 0,function(){var n,r,i;return s.__generator(this,function(o){switch(o.label){case 0:if(!this._editor)throw new g.InvariantError("editor should be mounted");return this._editor.synonyms.requestSynonyms(e,t),[4,this._synonymAlerts.first().toPromise()];case 1:if(n=o.sent(),n.title===t){if(0!==n.meanings.length)return r=function(e){return{word:e.newText,definition:""}},i=1===n.meanings.length?c.Either.left(n.meanings[0].replacements.map(r)):c.Either.right(n.meanings.map(function(e){return{meaning:e.title,words:e.replacements.map(r)}})),[2,{originalWord:t,synonymsOrGroups:i,alert:n}];throw new Error("Wrong synonym alert for "+t+": expecting meanings to exists")}throw new Error("Wrong synonym alert: expecting "+t+", got "+n.title)}})})}),function(){if(!I._editor)throw new g.InvariantError("editor should be mounted");return I._editor.synonyms},function(e,t,n){var r=e.match;r.replaced=!0,r.replace(n,!1)}),this.pendingAlertAction=this._state.lens("pendingAlertAction"),this._undoedAction=d.Atom.create(null),this.undoedAlert=this._undoedAction.skip(1).switchMap(function(e){return e?I._visibleAlerts.view(function(t){return t[e.id]}).filter(function(e){return!!e}).take(1):a.Observable.of(null)}),this._log=h.Monitoring.Logging.getLogger("model.editor.ge_engine"),this._tsCheckingStatus=h.Monitoring.TimeSeries.root.getCounter("model.editor.ge_engine.checking_status_inprogress"),this.appliedAlertIds=new Set,this._highlights=this._state.lens("alertHighlights"),this._focusedAlert=this._highlights.lens("focused"),this._highlightedAlert=this._highlights.lens("highlighted"),this._visibleAlerts=this._state.lens("alerts"),this._synonymAlerts=new a.Subject,this._matchFilterState=d.Atom.create({typeOrCategory:null,premium:null}),this._visibleAlertsFlattened=d.Atom.combine(this._visibleAlerts,this._matchFilterState,function(e,t){return Object.keys(e).map(function(t){return e[t]}).filter(function(e){return I._isVisible(e.alert.pname,e.alert.isFree,t)})}),this._premiumMatches=this._state.lens("premiumMatches"),this._checkingStatus=this._state.lens("checkingStatus"),this._textChangedByUser=new a.Subject,this._editor=null,this._editorEventSubs=null,this.denaliScores=d.Atom.create({accuracy:0,clarity:0,effectiveness:0,score:0,rank:0}),this._editorRendered=this._unsafeEditorEvent("rendered"),this._editorAlertRemovedOnServer=this._unsafeEditorEvent("serverRemove"),this._editorAlertSelected=this._unsafeEditorEvent("selectedMatch"),this._editorAlertDeselected=this._unsafeEditorEvent("deselectedMatch"),this._editorSending=this._unsafeEditorEvent("sending"),this._capiSocketConnect=this._unsafeEditorEvent("socketConnect"),this._capiSocketStart=this._unsafeEditorEvent("socketStart"),this._capiSocketError=this._unsafeEditorEvent("socketError"),this._capiSocketDisconnect=this._unsafeEditorEvent("disconnect"),this._editorFinishedChecking=this._unsafeEditorEvent("finish"),this._pastedTextSize=new a.Subject,this.recheckingState=d.Atom.create(this._initialText.length>0),this._editorPlagiarismChecked=this._unsafeEditorEvent("plagiarismChecked"),this._editorFix=this._unsafeEditorEvent("fix"),this.alerts=this._visibleAlerts,this.checkingStatus=this._checkingStatus,this.appliedAlertsCount=d.Atom.create(0),this.hoveredAlert=a.Observable.fromEvent(this._domElement,"mousemove").throttleTime(100).map(function(e){var t=I._domElement.getBoundingClientRect();return I._getAlertByPosition({x:e.clientX-t.left,y:e.clientY-t.top})}).map(function(e){return null===e?null:!0===e.alert.hidden?null:e}).map(function(e){var t=I.pendingAlertAction.get();return t&&e?b.AppliedAlertAction.isSingle(t)?e.alert.id===t.alertId?null:e:-1!==t.alertIds.indexOf(e.alert.id)?null:e:e}),this.settings=this._checkingSettings,this.localText=d.Atom.create(this._initialText),this.approximateWordCount=d.Atom.create(g.StringUtils.wordCount(this._initialText)),this.approximateCharCount=d.Atom.create(g.StringUtils.charCount(this._initialText)),this.scores=d.Atom.combine(this.localText.view(function(e){return null!=e?e:""}),this.approximateWordCount,this._visibleAlerts,this._premiumMatches,function(e,t,n,r){return w.calculateScores(e.length,t||0,Object.keys(n).filter(function(e){return!I.appliedAlertIds.has(e)}).map(function(e){return n[e].alert}),r.length)}),this.alertsCount=this._visibleAlerts.view(function(e){var t=_.createChecksDefaultState(0);return Object.keys(e).map(function(t){return e[t].alert}).forEach(function(e){switch(e.group){case y.AlertGroup.contextualSpelling:t.contextualSpelling++;break;case y.AlertGroup.enhancement:t.enhancement++;break;case y.AlertGroup.grammar:t.grammar++;break;case y.AlertGroup.plagiarism:t.plagiarism++;break;case y.AlertGroup.punctuation:t.punctuation++;break;case y.AlertGroup.sentenceStructure:t.sentenceStructure++;break;case y.AlertGroup.style:t.style++;break;case y.AlertGroup.synonym:break;default:throw new TypeError("Unknown alert group: "+e.group)}}),t}),this.premiumAlertsCount=this.scores.view("premiumAlerts"),this.textChangedByUser=this._textChangedByUser.distinctUntilChanged().skipWhile(function(e){return e===I._initialText}),this.focusedAlert=d.Atom.combine(this._visibleAlerts,this._focusedAlert,function(e,t){return I._getSynonymAlert(e)||t}),this.highlightedAlert=this._highlightedAlert,this._matchClassAppender=function(e){var t=I._matchFilterState.get();return I._isVisible(e.pname,e.free,t)?void 0:"grAlertHidden"},this._filterByCategory=function(e,t){if(!t)return!0;switch(t.type){case"category":return f.pnameToLensProp(e,function(e){return e.key})===t.value;case"type":return f.pnameToLensProp(e,function(e){return e.type})===t.value;default:return g.assertNever(t)}},this._filterByPremium=function(e,t){if(!t)return!0;switch(t.type){case"premium":return!e;case"free":return e;default:return g.assertNever(t)}},this._isVisible=function(e,t,n){return I._filterByPremium(t,n.premium)&&I._filterByCategory(e,n.typeOrCategory)}}return e.prototype._unsafeEditorEvent=function(e){var t=this;return a.Observable.fromEventPattern(function(n){if(!t._editor)throw new g.InvariantError("editor should be mounted");t._editor.on(e,n)},function(n){if(!t._editor)throw new g.InvariantError("editor should be mounted");t._editor.off(e,n)},function(e){return e})},e.prototype.updatePastedTextSize=function(e){this._pastedTextSize.next(e)},e.prototype._mergeUndoedAlert=function(e){var t=this._undoedAction.get();if(t){var n=e.find(function(e){return e.value===t.value&&e.rawMatch.pname===t.rawMatch.pname&&e.rawMatch.begin===t.rawMatch.begin});n&&n.id!==t.id&&(this._visibleAlerts.modify(function(e){var r=e[t.id];return Object.assign({},e,(i={},i[t.id]=null,i),(o={},o[n.id]={alert:v.createAlert(n),highlightPosition:r.highlightPosition},o));var i,o}),this._focusedAlert.modify(function(e){return e.id===t.id?{id:n.id,source:"undo"}:e}),this._highlightedAlert.modify(function(e){return e&&e===t.id?n.id:e}))}},e.prototype._updateRemovedAlerts=function(e){var t=this;this._focusedAlert.modify(function(e){return e.id&&!t._unsafeGetMatchById(e.id)?{id:null,source:null}:e}),this._highlightedAlert.modify(function(e){return e&&!t._unsafeGetMatchById(e)?null:e}),this._visibleAlerts.modify(function(t){var n=e.filter(function(e){return o(e)&&void 0!==t[e.id]}),r={};return n.forEach(function(e){return r[e.id]=t[e.id]}),r}),this.pendingAlertAction.modify(function(e){return e&&b.AppliedAlertAction.isSingle(e)&&!t._unsafeGetMatchById(e.alertId)?null:e})},e.prototype._updateAddedAlerts=function(e){var t=this,n=function(){return t._domElement.getBoundingClientRect()};this._visibleAlerts.modify(function(r){var i=e.filter(o),s={};return i.map(function(e){try{return{match:e,highlightPosition:g.DOM.absToRelativeBuggy(e.getEl()&&e.getEl().getClientRects()[0],n())}}catch(e){return t._log.error(e),null}}).forEach(function(e){if(e)try{var n=v.createAlert(e.match);"synonym"===n.kind&&t._isDenali?t._synonymAlerts.next(n):s[e.match.id]={alert:r[e.match.id]?r[e.match.id].alert:n,highlightPosition:e.highlightPosition}}catch(e){t._log.error("Failed to create alert, skip it",e)}}),s})},e.prototype._updatePremiumAlertCount=function(e){this._premiumMatches.set(e.getMatches().filter(function(e){return!e.rawMatch.free&&"synonyms"!==e.rawMatch.action}))},e.prototype._getCurrentVisibleMatches=function(e){return e.getFiltered().filter(function(e){return e.getEl()})},e.prototype._subscribeToUpdateCheckingStatus=function(){var e=this;return a.Observable.merge(this._editorSending.mapTo(1),this._editorFinishedChecking.mapTo(-1),this._editorPlagiarismChecked.mapTo(-1),this._capiSocketDisconnect.mapTo(NaN)).scan(function(e,t){return Number.isNaN(t)?0:Math.max(0,e+t)},0).map(function(e){return 0===e?b.CheckingStatus.finished:b.CheckingStatus.inProgress}).subscribe(function(t){return e._checkingStatus.set(t)})},e.prototype._checkPlagiarism=function(e){var t=this;void 0===e&&(e=100),setTimeout(function(){t._editor&&t._checkingSettings.plagiarismEnabled.get()&&t._editor.checkPlagiarism()},e)},e.prototype.mount=function(){var e=this;g.invariant(null==this._editorEventSubs&&null==this._editor,"editor should not be mounted");var t,n=this._dialectSetting.dialect.get();try{t=this._getCachedMatches()}catch(e){this._log.error("could not load cached alerts",e)}if(this._editor=i(this._domElement,this._textAreaType,this._textAreaWrapperElementId,this._docId,this._initialText,this._capiWsUrl,function(){return e._checkingSettings.plagiarismEnabled.get()},n,function(t){return e._checkingSettings.isAlertGroupEnabled(t)},function(){return e._checkingSettings.genre.get()},t||[],this._telemetry,this._matchClassAppender,this._capiClientName,this._isDenali),this._editorEventSubs=[this._editorRendered.subscribe(function(){e._editor&&(e._undoedAction.get()&&e._mergeUndoedAlert(e._getCurrentVisibleMatches(e._editor)),e._updateRemovedAlerts(e._getCurrentVisibleMatches(e._editor)),e._updatePremiumAlertCount(e._editor))}),a.Observable.merge(this._editorRendered,a.Observable.fromEvent(window,"resize")).auditTime(50).subscribe(function(){e._editor&&(e._updateAddedAlerts(e._getCurrentVisibleMatches(e._editor)),e._updatePremiumAlertCount(e._editor))}),a.Observable.merge(this._editorRendered,this._checkingStatus.skip(1).filter(function(e){return e===b.CheckingStatus.finished})).auditTime(1e3).subscribe(function(){e._editor&&e._tryCacheCurrentAlerts()}),this._editorRendered.subscribe(function(){if(e._editor){var t=e._editor.getText();e.localText.set(t),e._textChangedByUser.next(e._editor.getText())}}),this.localText.audit(function(e){return a.Observable.timer(e&&e.length>1e3?1e3:100)}).startWith(this.localText.get()).subscribe(function(t){e.approximateWordCount.set(g.StringUtils.wordCount(t)),e.approximateCharCount.set(g.StringUtils.charCount(t))}),this._editorAlertRemovedOnServer.subscribe(function(t){e.appliedAlertIds.has(t.id)&&(t.cancelServerRemove=!0);var n=e._undoedAction.get();n&&n.id===t.id&&(t.cancelServerRemove=!0,e._undoedAction.set(null))}),this._editorAlertSelected.subscribe(function(t){g.invariant(null===e._focusedAlert.get().id,"alert selected without prior deselect:\n            had "+e._focusedAlert.get()+" selected,\n            selecting "+t.id),e._focusedAlert.set({id:t.id,source:"text"})}),this._editorAlertDeselected.subscribe(function(t){g.invariant(e._focusedAlert.get().id===t.id||e._highlightedAlert.get()===t.id,"other alert deselected:\n            had "+e._focusedAlert.get()+" selected,\n            deselecting "+t.id),e._focusedAlert.modify(function(e){return e.id===t.id?{id:null,source:null}:e}),e._highlightedAlert.modify(function(e){return e===t.id?null:e})}),this._subscribeToUpdateCheckingStatus(),this._checkingSettings.genre.skip(1).subscribe(function(t){e._editor&&(e.pendingAlertAction.get()&&e.commitLastAlertAction(),e._editor.hardReset(),e._checkPlagiarism(1e3))}),this._checkingSettings.checksEnabled.skip(1).subscribe(function(t){e._editor&&(e.pendingAlertAction.get()&&e.commitLastAlertAction(),e._editor.render(),e._checkPlagiarism())}),n.nonEmpty()?a.Subscription.EMPTY:this._editorFinishedChecking.map(function(e){return e&&e.dialect}).filter(function(e){return p.isDialectString(e)}).first().subscribe(function(t){return e._dialectSetting.setDialectWeak(t)}),a.Observable.merge(this._capiSocketDisconnect.filter(function(e){return 4095!==e.code&&1001!==e.code}).map(function(e){var t=e.code,n=e.reason;return{type:"disconnected",error:new l.WSError({status:n,code:t,message:"Cannot connect to CAPI"})}}),this._capiSocketStart.mapTo({type:"connected"})).distinctUntilChanged(function(e,t){return e.type===t.type}).switchMap(function(e){return"connected"===e.type?a.Observable.of(e):a.Observable.of(e).delay(5e3)}).subscribe(function(t){return e._capiConnectivity.set(t)}),this._capiSocketConnect.subscribe(function(t){var n=e.pendingAlertAction.get();if(e._editor&&n)if(e._log.debug("Pending alert action on CAPI connect: kind = "+n.kind+";\naction = "+(b.AppliedAlertAction.isSingle(n)&&n.action)),b.AppliedAlertAction.isSingle(n)){var r=e._unsafeGetMatchById(n.alertId),i=r&&!r.undoed;i||e._log.error("Alerts not in sync: pending undone alert action")}else b.AppliedAlertAction.isBatchIgnore(n)&&!n.alertIds.some(function(t){var n=e._unsafeGetMatchById(t);return n&&!n.undoed||!1})&&e._log.error("Alerts not in sync: pending undone alert action")}),this._capiSocketError.map(function(e){var t=e.code,n=e.reason;return new l.WSError({status:n,code:t,message:"CAPI socket error"})}).distinctUntilChanged(function(e,t){return e.code===t.code}).subscribe(function(t){return e._log.warn("CAPI socket error",t)}),this._editorFix.subscribe(g.Extension.notifications.sendEditorFix),this._undoedAction.subscribe(function(t){t&&t.id&&(e.setFocusedAlert(t.id,"undo"),e.setHighlightedAlert(t.id))}),a.Observable.merge(this.textChangedByUser.debounceTime(1e3).mapTo(!0),this.textChangedByUser.mapTo(!1),this._checkingSettings.genre.mapTo(!0)).distinctUntilChanged().switchMap(function(t){return t?e._checkingStatus.switchMap(function(e){return e===b.CheckingStatus.inProgress?a.Observable.timer(12e3):a.Observable.empty()}):a.Observable.empty()}).subscribe(function(){return e._tsCheckingStatus.increment()})],this._isDenali){var r=function(e,t){var n=e.slice(0,t+1).search(/\w+$/),r=e.slice(t).search(/\W/);return[n,r<0?e.length-1:r+t]},o=function(){if(!e._editor)throw new g.InvariantError("editor should be mounted");var t=e._editor.getSelection(),n=function(e){var t=e.s,n=e.text||"",i=r(n,t),o=i[0],s=i[1];return{pos:t,s:o,e:s,word:n.slice(o,s)}}(t),i=function(t){return c.Option.of(e._editor.dom.htmlDom.renderRange({s:t.s,e:t.s+1})[0]).map(function(t){var n=g.DOM.absToRelativeBuggy(t.getClientRects()[0],e._domElement.getBoundingClientRect());return t.className="denaliCarretPoint",e._editor.dom.htmlDom.removeBySelector(".denaliCarretPoint"),n})},o=i(t),s=i(n);return o.chain(function(e){return s.map(function(t){return{cursor:e,word:t}})})},s=function(){requestAnimationFrame(function(){return o().map(function(e){return{cursor:{x:e.cursor.left,y:e.cursor.top},word:{x:e.word.left,y:e.word.top}}}).map(function(t){return e.synonymsViewModel.move(t.cursor,t.word)})})};if(!this._demoMode){var u=a.Observable.merge(a.Observable.fromEvent(this._domElement,"click")).map(function(){if(!e._editor)throw new g.InvariantError("editor should be mounted");var t=e._editor.getSelection();return c.Option.of(t.s===t.e?t:null).map(function(e){var t=e.s,n=e.text||"",i=r(n,t),o=i[0],s=i[1];return{pos:t,s:o,e:s,word:n.slice(o,s)}}).filter(function(e){return e.word.length>2&&e.pos>e.s})}).share(),d=u.distinctUntilChanged(function(e,t){return e.equals(t)}).subscribe(function(t){t.fold(function(){return e.synonymsViewModel.hide()},function(t){return e.synonymsViewModel.showButton({start:t.s,word:t.word})})});this.synonymsViewModel.viewState.view(function(e){return null===e?null:e.synonymsState}).filter(function(e){return null!==e&&C.SynonymsModel.isReady(e)&&void 0!==e.synonyms}).subscribe(function(){s()}),this._editorEventSubs.push(d)}this._editorEventSubs.push(this._matchFilterState.skip(1).subscribe(function(){if(!e._editor)throw new g.InvariantError("editor should be mounted");e._getCurrentVisibleMatches(e._editor).forEach(function(t){var n=t.getEl(),r=e._editor.getMatchClass(t,"");n.className!==r&&(n.className=r)})}),this._editorFinishedChecking.subscribe(function(t){var n=t.scores,r=void 0===n?{Accuracy:0,Clarity:0,Effectiveness:0}:n,i=t.score,o=void 0===i?0:i;return e.denaliScores.set({accuracy:r.Accuracy,clarity:r.Clarity,effectiveness:r.Effectiveness,score:o,rank:Math.round(.5*r.Accuracy+.25*(r.Clarity+r.Effectiveness))})}),a.Observable.merge(this._capiSocketStart.mapTo(!0),this._pastedTextSize.filter(function(e){return e>1e3}).mapTo(!0),this._editorFinishedChecking.debounceTime(1e3).mapTo(!1)).subscribe(function(t){return e.recheckingState.set(e._initialText.length>0&&t)}))}this._editor.run(),this._checkPlagiarism()},e.prototype._unsafeGetMatchById=function(e){if(!this._editor)throw new Error("editor should be mounted");return this._editor.matches.byId(e)},e.prototype._getMatchById=function(e){var t=this._unsafeGetMatchById(e);if(!t)throw new g.InvariantError("expected non-null match #"+e);return t},e.prototype._updateHighlights=function(e,t){var n=this;[e.focused.id,e.highlighted].forEach(function(e){var t=null!==e&&n._unsafeGetMatchById(e);t&&t.deselect(!0)}),[t.focused.id,t.highlighted].forEach(function(e){try{null!==e&&n._getMatchById(e).select(!0)}catch(e){n._log.warn("Update highlights failed",e)}})},e.prototype._tryCacheCurrentAlerts=function(){if(!this._editor)throw new g.InvariantError("editor should be mounted");try{this._cacheSerializableMatches(r(this._editor.getMatches().filter(function(e){return"synonyms"!==e.rawMatch.action})))}catch(e){this._log.error("could not cache alerts",e)}},e.prototype.unmount=function(){if(!this._editor||!this._editorEventSubs)throw new g.InvariantError("editor should be mounted");this.pendingAlertAction.get()&&this.commitLastAlertAction(),this._tryCacheCurrentAlerts(),this._editorEventSubs.forEach(function(e){return e.unsubscribe()}),this._editorEventSubs=null,this._editor.exit(),this._editor=null},e.prototype.setDocumentContent=function(e){if(!this._editor)throw new g.InvariantError("editor should be mounted");this.pendingAlertAction.get()&&this.commitLastAlertAction(),this._editor.setText(e)},e.prototype.skipInputEvents=function(e){var t=(void 0===e?{turnBack:!1}:e).turnBack;if(!this._editor)throw new g.InvariantError("editor should be mounted");this._editor.inputListener.skipInputEvents(!1!==t||void 0)},e.prototype._applyAlert=function(e,t){if(!this._editor)throw new g.InvariantError("editor should be mounted");var n=this._getMatchById(e);switch(t.action){case"replace":n.replaced=!0,n.replace(t.replacementText,!1),t.isSynonym&&n.removeUnderline(),this.appliedAlertsCount.modify(function(e){return e+1});break;case"ignore":case"addToDictionary":case"acknowledge":this._isDenali?(n.replaced=!0,n.getEl().className=this._editor.getMatchClass(n,"")):n.getEl().classList.add("gr_replaced");break;default:return g.assertNever(t)}this.pendingAlertAction.set(b.AppliedAlertAction.createSingle(e,t)),this.appliedAlertIds.add(e)},e.prototype.batchIgnore=function(e){var t=this;if(!this._editor)throw new g.InvariantError("editor should be mounted");var n=this.pendingAlertAction.get();if(n&&(this.commitLastAlertAction(),b.AppliedAlertAction.isBatchIgnore(n)&&n.alertIds.length>0&&JSON.stringify(n.alertIds)===JSON.stringify(e)))throw new g.InvariantError("alert was already applied");try{e.forEach(function(e){return requestAnimationFrame(function(){t._getMatchById(e).replaced=!0,t.appliedAlertIds.add(e)})}),this.pendingAlertAction.set(b.AppliedAlertAction.createBatchIgnore(e))}catch(e){this._log.warn("Apply alert failed, action: batchIgnore",e)}this._focusedAlert.set({id:null,source:null}),this.setHighlightedAlert(null)},e.prototype.applyAlert=function(e,t){if(!this._editor)throw new g.InvariantError("editor should be mounted");var n=this.pendingAlertAction.get();if(n&&(this.commitLastAlertAction(),b.AppliedAlertAction.isSingle(n)&&n.alertId===e))throw new g.InvariantError("alert was already applied");try{this._applyAlert(e,t)}catch(e){this._log.warn("Apply alert failed, action: "+t.action,e)}this._focusedAlert.set({id:null,source:null}),this.setHighlightedAlert(null),this._undoedAction.set(null)},e.prototype.commitLastAlertAction=function(){var e=this;if(!this._editor)throw new g.InvariantError("editor should be mounted");var t=this.pendingAlertAction.get();if(!t)throw new g.InvariantError("can not commit when no action was applied");if(b.AppliedAlertAction.isBatchIgnore(t))return t.alertIds.forEach(function(t){e._getMatchById(t).ignore()}),this.appliedAlertIds.clear(),void this.pendingAlertAction.set(null);if("replace"===t.action.action&&t.action.isSynonym)return void this.pendingAlertAction.set(null);try{var n=this._getMatchById(t.alertId);switch(t.action.action){case"replace":n.remove();break;case"ignore":n.ignore();break;case"addToDictionary":this._demoMode?n.remove():n.addToDict();break;case"acknowledge":n.acknowledged();break;default:return g.assertNever(t.action)}}catch(e){this._log.warn("commitLastAlertAction failed",e)}this.appliedAlertIds.clear(),this.pendingAlertAction.set(null)},e.prototype._removeUndoStyles=function(e){this._isDenali?(e.replaced=!1,e.getEl().className=this._editor.getMatchClass(e,"")):e.getEl().classList.remove("gr_replaced")},e.prototype.undoLastAlertAction=function(){var e=this;if(!this._editor)throw new g.InvariantError("editor should be mounted");var t=this.pendingAlertAction.get();if(!t)throw new g.InvariantError("can not undo when no action was applied");if(b.AppliedAlertAction.isBatchIgnore(t))return void t.alertIds.forEach(function(t){e._removeUndoStyles(e._getMatchById(t))});var n=this._getMatchById(t.alertId);"replace"===t.action.action&&(n.undo(),this.appliedAlertIds.delete(t.alertId)),this._removeUndoStyles(n),this._undoedAction.set(this._unsafeGetMatchById(t.alertId)),this.pendingAlertAction.set(null)},e.prototype.setFocusedAlert=function(e,t){g.invariant(null!==this._editor,"editor should be mounted");var n=this._highlights.get();this._focusedAlert.set({id:e,source:t}),this._updateHighlights(n,this._highlights.get())},e.prototype.setHighlightedAlert=function(e){g.invariant(null!==this._editor,"editor should be mounted");var t=this._highlights.get();this._highlightedAlert.set(e),this._updateHighlights(t,this._highlights.get())},e.prototype.getAllAlerts=function(){return this._editor?this._editor.getMatches().filter(function(e){return y.alertGroupFromString(e.rawMatch.group)!==y.AlertGroup.plagiarism&&"synonyms"!==e.rawMatch.action}).map(v.createAlert):[]},e.prototype._getAlertByPosition=function(e){var t=e.x,n=e.y;return this._visibleAlertsFlattened.get().find(function(e){var r=e.highlightPosition;return r.left<=t&&t<=r.left+r.width&&r.top<=n&&n<=r.top+r.height})||null},e.prototype._getSynonymAlert=function(e){var t=Object.keys(e).find(function(t){return e[t].alert.group===y.AlertGroup.synonym});return t?{id:t}:null},e.prototype.isFocused=function(e){return this.focusedAlert.view(function(t){return t.id===e})},e.prototype.getCurrentSelection=function(){if(!this._editor)throw new g.InvariantError("editor should be mounted");var e=this._editor.getSelection();return e?{start:e.s,end:e.e}:null},e.prototype.setSelection=function(e){if(!this._editor)throw new g.InvariantError("editor should be mounted");this._editor.setCursor({s:e.start,e:e.end})},e.prototype.getUnderlinedHtml=function(){if(!this._editor)throw new g.InvariantError("editor should be mounted");return this._editor.dom.cloneVal.innerHTML},e.prototype.filterViewByTypeOrCategoryOnly=function(e){this._matchFilterState.set({typeOrCategory:e,premium:null})},e.prototype.filterView=function(e){this._matchFilterState.set(e)},e}();t.GrammarlyEditorEngine=x},559:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n(313),o=n(6),s=n(8);!function(e){e[e.Querying=0]="Querying",e[e.Ready=1]="Ready"}(r=t.SynonymsStateKind||(t.SynonymsStateKind={}));var a;!function(e){function t(e){return null!==e&&e.kind===r.Ready}function n(e){return null!==e&&e.kind===r.Querying}e.isReady=t,e.isQuerying=n}(a=t.SynonymsModel||(t.SynonymsModel={}));var c=function(){function e(e){this._query=e,this.state=s.Atom.create({kind:r.Ready}),this._log=o.Monitoring.Logging.getLogger("editor.SynonymsModelImpl"),this._cache=new i.LRUCache(20)}return e.prototype.query=function(e){var t=this;this._log.trace("SynonymsQuery: "+e.word),this.state.set({kind:r.Querying,query:e});var n=this._getKey(e),i=this._cache.get(n);if(void 0!==i){this._log.trace("Cache hit for "+n);var o={kind:r.Ready,query:e,synonyms:i};this._onResponse(o)}else this._query(e.start,e.word).then(function(i){var o={kind:r.Ready,query:e,synonyms:i};t._cache.put(n,i),t._onResponse(o)}).catch(function(){t.abortQuery()})},e.prototype.abortQuery=function(){a.isQuerying(this.state.get())&&this.state.set({kind:r.Ready})},e.prototype._getKey=function(e){return e.word+"#"+e.start},e.prototype._onResponse=function(e){this._log.trace("_onResponse() newState: "+e);var t=this.state.get();a.isQuerying(t)&&t.query.word===e.query.word?this.state.set(e):this._log.trace("Discarding result for "+e.query.word)},e}();t.SynonymsModelImpl=c},560:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(23),i=n(18),o=n(5);!function(e){var t;t||(t={}),e.genUuid=function(){return o.StringUtils.alphanumeric(12)},e.defaultState={visible:!1,content:i.None},e.ContextTypes={tooltip:r.object};var n=function(){function t(t){var n=this;this._state=t,this.visible=this._state.lens("visible"),this.content=this._state.lens("content"),this.hasContent=this._state.view(function(e){return e.content.nonEmpty()}),this.state=this._state.view(function(e){return e.content.filter(function(){return e.visible})}),this.show=function(){n.visible.set(!0)},this.hide=function(){n._state.set(e.defaultState)}}return t.prototype.setContent=function(e){this.content.set(i.Some(e))},t.prototype.cleanContent=function(t){this._state.modify(function(n){return n.content.exists(function(e){return e.uuid===t})?e.defaultState:n})},t}();e.Impl=n}(t.Tooltip||(t.Tooltip={}))},563:function(e,t,n){n(856),e.exports=n(1423)},564:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(1399),n(1402).initializeMonitoring();var r=n(14),i=n(567),o=n(1373);i.render(r.createElement(o.Main,null),document.getElementById("page"))},565:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(119),i=n(209);t.Notifications=i;var o=n(573),s=n(299);t.Subscription=s;var a=n(152);t.Settings=a;var c=n(121);t.Account=c;var u=n(1375),l=n(1393);t.NavigationBar=l;var d=n(1385);t.Dictionary=d;var h=n(560);t.Tooltip=h.Tooltip;var p=n(1392);t.Modal=p;var f=n(586);t.NewEditor=f;var g=n(302);t.Card=g;var m=n(98);t.Alert=m;var _=n(307);t.AlertExamples=_;var y=n(553);t.Documents=y;var v=n(581);t.Apps=v;var b=n(572);t.Banners=b;var w=n(1394);t.ProofitBanners=w;var E=n(1391);t.Extension=E;var C=n(1377);t.Connectivity=C;var S=n(1379);t.WsConnectivity=S;var x=n(1395),T=n(1378),k=n(1386);t.DocumentUpload=k;var A=n(1376),I=n(1380),O=n(202),D=n(38);t.BrowserInfo=D;var P=n(5);t.defaultState={authentication:u.defaultState,userAccount:null,notifications:i.defaultState,denaliNotifications:o.defaultState,dictionary:d.defaultState,tooltip:h.Tooltip.defaultState,modal:p.defaultState,overlay:p.defaultState,newEditorPage:f.editorPageDefaultState,banner:b.defaultState,documentsPage:y.defaultState,online:!0};var N=function(){function e(e,t,n,s,a,l,g,m,_,y,v,b,w){var k=this;this._state=e,this._authApi=t,this._institutionApi=n,this._dapi=s,this.platformInfo=a,this._dictionaryApi=l,this._irbisApi=g,this._doxApi=m,this.telemetry=_,this.gnarSpec=y,this._gaClient=v,this._appConfig=b,this._router=w,this._nullableUserAccount=this._state.lens("userAccount"),this._userAccount=this._nullableUserAccount.filter(function(e){return null!==e}).map(function(e){return e}),this.editorTsNotifications=new i.NotificationsModelImpl(this._state.lens("notifications")),this.denaliNotifications=new o.DenaliNotificationsModelImpl(this._state.lens("denaliNotifications"),this._appConfig,this._router.location),this._navigateToDocument=function(e,t){k._router.navigate(r.Router.routes.editor.href({docId:e}),t)},this.notifications=new i.ProxyShowNotificationsModel(function(){return k._router.isActive(r.Router.routes.denali_editor.href({docId:"*"})).get()?k.denaliNotifications:k.editorTsNotifications}),this.unsafeUserAccount=null,this.modal=new p.ModalDialogModelImpl(this._state.lens("modal"),this.platformInfo.os,this.notifications),this.overlay=new p.ModalOverlayModelImpl(this._state.lens("overlay")),this.authentication=new u.AuthenticationModelImpl(this._state.lens("authentication"),this._authApi,this._institutionApi,this._dapi,function(e){k._nullableUserAccount.set(e),k.unsafeUserAccount=new c.UserAccountModelImpl(k._nullableUserAccount,k._authApi,k._irbisApi,k._dapi,k._appConfig.funnel.subscribe,k._appConfig.funnel.upgrade,k.platformInfo.type,k.platformInfo.browser,k.telemetry,k._router,k._appConfig)},this._appConfig,this.telemetry,function(){return k._router.navigate(r.Router.routes.free.href({}))},this.modal,this.overlay,this.platformInfo.browser),this.dictionary=new d.DictionaryModelImpl(this._state.lens("dictionary"),this._dictionaryApi),this.tooltip=new h.Tooltip.Impl(this._state.lens("tooltip")),this._navigationBar=null,this._alertCache=new f.AlertCacheImpl(function(e){return e},function(e){return e},this._appConfig.alertCachePrefix,this._appConfig.alertCacheVersion),this._newEditorPage=null,this.connectivity=new C.ConnectivityModelImpl({network:new A.NetworkErrorHandler(this.notifications,this.overlay),wsProtocol:new A.WsProtocolErrorHandler(this.notifications,this.overlay),dox:new A.DoxErrorHandler(this.notifications,this.overlay,this.authentication,function(){return k._router.navigate(r.Router.routes.documents.href({}))}),wsDox:new A.DoxErrorHandler(this.notifications,this.overlay,this.authentication,function(){return k._router.navigate(r.Router.routes.documents.href({}))}),wsCapi:new A.CapiErrorHandler(this.notifications,this.overlay)}),this.networkState=new T.NetworkConnectivityModelImpl(this.connectivity,this._appConfig.api.onlineTestUrl),this.wsConnectivity=new S.WsConnectivityModelImpl(this.connectivity,{wsDox:new I.WsDoxErrorHandler(this.networkState,this.connectivity),wsCapi:new I.WsCapiErrorHandler(this.networkState,this.connectivity)}),this.selfUpdate=new x.SelfUpdate(this._router,this._appConfig.selfUpdate),this.extension=new E.ExtensionInstallModelImpl(this.platformInfo.browser,this._appConfig.extension.chrome.installURL,this._appConfig.extension.firefox.installURL,this._appConfig.extension.firefox.iconURL,this.notifications),this.apis={dox:this._doxApi},this._userAccount.distinctUntilChanged(function(e,t){return e.userProfile.id===t.userProfile.id}).subscribe(function(e){var t=e.userProfile,n=t.id,r=t.isTest;_.setUser(n,r),k._gaClient.setUserId(n)}),this._userAccount.filter(function(e){return!0!==e.userProfile.isTest&&P.Async.isOk(e.subscription)&&e.userProfile.groups.has(c.UserGroups.PREMIUM_CONVERSION)}).distinctUntilChanged(function(e,t){return e.userProfile.id===t.userProfile.id}).subscribe(function(e){return O.PixelTracking.doTracking(e.userProfile,e.subscription.value,k._irbisApi,k._gaClient)})}return Object.defineProperty(e.prototype,"userAccount",{get:function(){if(!this.unsafeUserAccount)throw new P.InvariantError("User should be already authenticated");return this.unsafeUserAccount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navigationBar",{get:function(){if(!this.unsafeUserAccount)throw new P.InvariantError("User should be already authenticated");return this._navigationBar=this._navigationBar||new l.NavigationBarModelImpl(this.unsafeUserAccount.features,this.platformInfo.browser,this.platformInfo.os)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"newEditorPage",{get:function(){if(!this.unsafeUserAccount)throw new P.InvariantError("User should be already authenticated");var e=this.unsafeUserAccount,t=e.settings,n=e.features;return this._newEditorPage=this._newEditorPage||new f.EditorPageModelImpl(this._state.lens("newEditorPage"),t,this._doxApi,this._appConfig.api.capiWsUrl,n,this.telemetry,this.modal,this._alertCache,this.wsConnectivity,this.connectivity,this.notifications)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documentsPage",{get:function(){if(!this.unsafeUserAccount)throw new P.InvariantError("User should be already authenticated");return this._documentsPage=this._documentsPage||new y.DocumentsPageModelImpl(this._state.lens("documentsPage"),this._doxApi,this.unsafeUserAccount.settings,this._alertCache,this.platformInfo.browser,this.connectivity,this.notifications,this._navigateToDocument)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documentUpload",{get:function(){var e=this;if(!this.unsafeUserAccount)throw new P.InvariantError("User should be already authenticated");return this._documentUpload=this._documentUpload||new k.UploadModel(function(t){return e.documentsPage.actions.uploadDocument(t)},this._navigateToDocument,this.notifications,this.telemetry)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"apps",{get:function(){if(!this.unsafeUserAccount)throw new P.InvariantError("User should be already authenticated");return new v.AppsModelImpl(this.platformInfo.browser,this.platformInfo.os,this.extension,this.unsafeUserAccount.features.desktopApps,this.telemetry)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"banners",{get:function(){if(!this.unsafeUserAccount)throw new P.InvariantError("User should be already authenticated");return new b.BannersModelImpl(this._state.lens("banner"),this.platformInfo.browser,this.platformInfo.os,this.extension,this.telemetry)},enumerable:!0,configurable:!0}),e}();t.AppModelImpl=N},566:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(543);t.CAPIClient=i.CAPIClient,t.CAPIEventHandler=i.CAPIEventHandler,t.defaultReconnect=i.defaultReconnect;var o=n(544);t.CAPIClientImpl=o.CAPIClientImpl;var s=n(1359);t.TestCAPIClientImpl=s.TestCAPIClientImpl;var a=n(545);t.ClientType=a.ClientType,r.__exportStar(n(291),t),r.__exportStar(n(1360),t);var c=n(546);t.DocumentStatistics=c.DocumentStatistics},568:function(e,t,n){"use strict";function r(e){return e===u.Proofit.JobStatus.building||e===u.Proofit.JobStatus.newJob}function i(e){return e===u.Proofit.JobStatus.completed}function o(e,t){var n=(new Date).getTime(),r={seconds:0,percentage:100};return t&&e&&t>n&&e<n?{seconds:Math.ceil((t-n)/1e3),percentage:Math.round((n-e)/(t-e)*100)}:r}Object.defineProperty(t,"__esModule",{value:!0});var s=n(14),a=n(22),c=n(8),u=n(53),l=n(99),d=n(579),h=n(932);t.isProofitInProgress=r,t.isProofitCompleted=i,t.getProofitUrl=function(e,t){return e.replace(/_docId_/,""+t)},t.DocumentProofitBadge=function(e){var t=e.proofit;if(!t)return null;switch(t.status){case u.Proofit.JobStatus.completed:return s.createElement("div",{"data-name":"proofit-completed-icon",className:h.proofitCompleted});case u.Proofit.JobStatus.cancelled:return s.createElement("div",{"data-name":"proofit-cancelled-icon",className:h.proofitCancelled});default:return null}},t.getRemainedTime=o,t.ProofitProgressBar=function(e){var t=e.remained;return s.createElement("div",{className:h.proofreading},s.createElement(c.F.div,{className:h.pgs},t.map(function(e){return s.createElement(d.ProgressBar,{key:"proofit-progressbar",remaining:e.seconds,percentage:e.percentage,countdown:"short",style:{gutter:h.gutter}})})),s.createElement("div",{className:h.pgsPlaceholder},"Proofreading..."))},t.ProofitProgress=function(e){function n(){u.set(o(r,i));var e=a.Observable.interval(1e3).subscribe(function(){u.set(o(r,i))});return{unsubscribe:function(){e.unsubscribe()}}}var r=e.submitted,i=e.due,u=c.Atom.create({seconds:0,percentage:0});return s.createElement(l.Lifecycle,{onMount:n,remountOnUpdate:!0},s.createElement(t.ProofitProgressBar,{remained:u}))}},569:function(e,t,n){"use strict";function r(e){var t=e.rawMatch;return h.invariant("synonym"!==t.action,"Do not use `getBasicAlertFields` for synonyms."),{id:t.id.toString(),title:t.title,hidden:t.hidden,category:t.category,categoryHuman:t.categoryHuman,pid:t.pid,pname:t.pname,isFree:t.free,highlightText:t.highlightText,range:{start:t.begin,end:t.end},group:p.alertGroupFromString(t.group)}}function i(e){var t=e.rawMatch,n=t.synonyms.token,r=e.value;return{id:e.id,title:n||r,hidden:!1,category:t.category,categoryHuman:t.categoryHuman,pid:t.pid,pname:t.pname,isFree:!0,highlightText:"",range:{start:e.begin,end:e.end},group:p.AlertGroup.synonym}}function o(e){var t=e.rawMatch,n=t.extra_properties||{},i=r(e);t.replacements&&t.transforms&&h.invariant(t.replacements.length===t.transforms.length,"every transform should have replacement");var o={kind:"common",details:t.details,explanation:t.explanation,examples:p.parseExamples(t.examples),todo:t.todo,replacements:(t.transforms||[]).map(function(e,n){return p.createReplacement(e,t.replacements[n])}),extraProperties:{hasAddToDictionary:!!n.add_to_dict,isDidYouMean:!!n.did_you_mean,isShowTitle:!!n.show_title,isEnhancement:!!n.enhancement,plagiarismUrl:n.url,sentence:n.sentence,priority:n.priority?parseInt(n.priority,10):0}};return Object.assign(i,o)}function s(e){var t=p.parsePlagiarism(e),n=r(e),i={kind:"plagiarism",title:t.title,description:t.description,url:t.url,reference:t.reference};return Object.assign(n,i)}function a(e){var t=e.rawMatch,n=r(e),i={details:t.details,explanation:t.explanation,examples:p.parseExamples(t.examples),todo:t.todo,kind:"enhancement",replacements:(t.replacements||[]).map(p.createSimpleReplacement),extraProperties:{isEnhancement:!0}};return Object.assign(n,i)}function c(e,t){return void 0===t&&(t=""),e&&""!==e&&""!==t&&(e.includes(t)||t.includes(e))}function u(e){var t=d.Monitoring.Logging.getLogger("grammarly_editor_alert.synonyms"),n=d.Monitoring.TimeSeries.root.getMetric("grammarly_editor_alert"),r=e.rawMatch,o=r.synonyms,s=o.token,a=o.meanings,u=e.value,l=e.badSyn,h=i(e);return l?(t.warn("Synonym error: cannot_find_synonym",{expected:e.value}),n.getCounter("synonyms.error.cannot_find_synonym").increment()):s&&s!==u?n.getCounter("synonyms.error.syn_for_wrong_token").increment():s?n.getCounter("synonyms.success").increment():n.getCounter("synonyms.error.token_missing").increment(),s&&s!==u?(t.warn(c(s,u)?"Got synonym for similar word":"Got synonym for wrong token",{expected:u,got:s}),Object.assign(h,{kind:"synonym",title:u,meanings:[],replacements:[]})):Object.assign(h,{kind:"synonym",match:e,meanings:a.map(function(e){return{title:e.meaning,replacements:e.synonyms.map(function(e){return p.createSimpleReplacement(e.derived)})}}),replacements:(r.replacements||[]).map(p.createSimpleReplacement)})}function l(e){var t=e.rawMatch;if(!t.group&&"synonyms"===t.action)return u(e);switch(p.alertGroupFromString(e.rawMatch.group)){case p.AlertGroup.plagiarism:return s(e);case p.AlertGroup.enhancement:return a(e);default:return o(e)}}Object.defineProperty(t,"__esModule",{value:!0});var d=n(6),h=n(5),p=n(98);t.getBasicAlertFields=r,t.getSynonymBasicAlertFields=i,t.isTokensSimilar=c,t.createAlert=l},572:function(e,t,n){"use strict";function r(e){switch(e){case"office-addin":return"officeAddin";case"desktop-mac":return"macApp";case"desktop-windows":return"winApp";case"chrome-extension":return"chromeExt";case"firefox-extension":return"firefoxExt";case"safari-extension":return"safariExt";case"edge-extension":return"edgeExt";case"referral":return"referral";case"no-referral":return"no-referral";case"campaign-end":return"campaignEnd";case"proofit-cancelled":return"proofitCancel";case"proofit-completed":return"proofitComplete";default:return i.assertNever(e)}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(5),o=n(199),s=n(121);t.defaultState={active:null},t.bannerToTracking=r;var a=function(){function e(e,t,n,r,i){this._state=e,this._browser=t,this._os=n,this._extension=r,this._telemetry=i,this.state=this._state.view()}return e.prototype.initialize=function(e,t,n){this._settings=n,this._banners=e;var r=e.later,i=r.filter(function(e){return Date.now()<=e.expire});i.length!==r.length&&this._updateBanners({later:i});var o=this._getActiveBanner(t);this._state.set({active:o}),o&&this._shown(o)},e.prototype._notHidden=function(e){return this._banners.dismiss.concat(this._banners.later.map(function(e){return e.type})).indexOf(e)<0},e.prototype._getExtensionBanner=function(){var e=this._browser+"-extension";return!o.isExtensionInstalled()&&this._notHidden(e)&&o.isBrowserHasExtension(this._browser)?e:null},e.prototype._getDesktopBanner=function(e){if("mac"!==this._os&&"windows"!==this._os)return null;var t="desktop-"+this._os;return!e.has(s.UserGroups.DESKTOP_EDITOR_INSTALLED)&&this._notHidden(t)?t:null},e.prototype._getOfficeAddinBanner=function(e){if("windows"!==this._os)return null;var t="office-addin",n=this._banners.shown.indexOf(t)>-1;return o.isAddinInstalled(e)||n||!this._notHidden(t)?null:t},e.prototype._getActiveBanner=function(e){var t=this._getExtensionBanner(),n=this._getDesktopBanner(e),r=this._getOfficeAddinBanner(e);return t||n||r||null},e.prototype._updateBanners=function(e){this._banners=Object.assign({},this._banners,e),this._settings&&this._settings.updateBanners(this._banners)},e.prototype._shown=function(e){var t=this._banners.shown;t.indexOf(e)>-1||(t.push(e),this._updateBanners({shown:t}))},e.prototype.remind=function(e){var t=this._banners.later;t.push({type:e,expire:Date.now()+864e5}),this._updateBanners({later:t}),this._state.set({active:null})},e.prototype.dismiss=function(e){var t=this._banners.dismiss;t.push(e),this._updateBanners({dismiss:t}),this._state.set({active:null})},e.prototype.cancel=function(e){this._state.set({active:null})},e.prototype._isExtension=function(e){return["chrome-extension","firefox-extension","safari-extension","edge-extension"].indexOf(e)>-1},e.prototype.install=function(e,t){var n=this;this._isExtension(e)?(this._telemetry.bannerActionClicked(r(e),t),this._extension.install().then(function(e){return e&&n._state.set({active:null})})):this._state.set({active:null})},e}();t.BannersModelImpl=a},573:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(22),o=n(8),s=n(6),a=n(209),c=n(18);t.defaultState={items:[],importantItems:[]};var u=function(){function e(e,t,n){var r=this;this._state=e,this._appConfig=t,this.create=new a.EditorNotificationFactory,this._queue=this._state.lens("items"),this._importantQueue=this._state.lens("importantItems"),this.items=o.Atom.combine(this._queue,this._importantQueue,function(e,t){return t.length?[t[0]]:e.slice(0,3)}),this._notificationsSubs=new Map,this._nextId=function(){var e=1;return function(){return e++}}(),this.items.pairwise().subscribe(function(e){var t=e[0],n=e[1];t.filter(function(e){return-1===n.indexOf(e)}).forEach(function(e){return r._extract(e.id)}),n.filter(function(e){return-1===t.indexOf(e)}).forEach(function(e){return r._put(e)})}),n.subscribe(function(e){return r.cleanup()})}return e.prototype.show=function(e){var t=this,n=this._nextId(),i=r.__assign({},e,{id:n}),o=i.important||"error"===i.severity?this._importantQueue:this._queue;return i.exclusiveTag&&c.Option.of(o.get().find(function(e){return e.exclusiveTag===i.exclusiveTag})).forEach(function(e){return t.hide(e.id)}),o.modify(function(e){return e.concat([i])}),n},e.prototype.showMessage=function(e){return this.show(this.create.generic(e))},e.prototype.showError=function(e){return this.show(this.create.error(e))},e.prototype.hide=function(e){var t=[],n=function(n){return n.id!==e||(t.push(n),!1)};this._queue.modify(function(e){return e.filter(n)}),this._importantQueue.modify(function(e){return e.filter(n)}),t.forEach(function(e){e.dismissedHandler&&e.dismissedHandler()})},e.prototype.expire=function(e){this.hide(e)},e.prototype.cleanup=function(){this._queue.modify(this._cleanup)},e.prototype._cleanup=function(e){return e.filter(function(e){return e.dontRemoveOnAnyAction||e.important})},e.prototype._put=function(e){var t=this;if(s.Monitoring.Logging.getLogger("notifications").log("error"===e.type?s.Logging.LogLevel.WARN:s.Logging.LogLevel.INFO,"Notification shown: "+e.type,s.EventProps.fromAny(e)),e.denaliShowTimeMs!==1/0&&!e.important){var n=this._appConfig.notificationShowTimeMs||e.denaliShowTimeMs||7e3;this._notificationsSubs.set(e.id,i.Observable.interval(n).take(1).subscribe(function(){return t.hide(e.id)}))}},e.prototype._extract=function(e){this._notificationsSubs.has(e)&&(this._notificationsSubs.get(e).unsubscribe(),this._notificationsSubs.delete(e))},e}();t.DenaliNotificationsModelImpl=u},574:function(e,t,n){"use strict";function r(e,t){return{re:new RegExp("^("+e+")([\\s\\S]*)$"),createResult:t}}function i(e){for(var t=[],n=e,r=!1,i=0,o=void 0;n.length>0;){var s=function(e){for(var t=0,n=c;t<n.length;t++){var r=n[t],i=e.match(r.re);if(null!==i)return[r.createResult(i),i[i.length-1]]}}(n);void 0===s&&(r=!0);var u=s||function(t){var n=["<span class='gr_grammar_del'>","<span class='gr_grammar_ins'>",""].map(function(e){return t.indexOf(e)});if(n.findIndex(function(e){return 0===e})>0)throw new Error("Couldn't parse transform: "+e);if(n=n.filter(function(e){return e>0}),n.length>0){var r=Math.min.apply(Math,n);return[{type:"text",text:t.substring(0,r)},t.substring(r)]}return[{type:"text",text:t},""]}(n),l=u[0],d=u[1];o&&"text"===o.type&&"text"===l.type?o.text+=l.text:(o&&"delete"===o.type&&"insert"===l.type&&(t.push({type:"arrow"}),i++),t.push(l)),"arrow"===l.type&&i++,o=t[t.length-1],n=d}return(r||0===t.length||i>1)&&a.Monitoring.Logging.getLogger("model.editor.alert_replacement").warn("Bad parsing of transform",{transformHtml:e,transformPartCount:t.length,arrowCount:i}),t}function o(e,t){return{newText:t,transform:i(e)}}function s(e){return{newText:e,transform:[{type:"insert",text:e}]}}Object.defineProperty(t,"__esModule",{value:!0});var a=n(6),c=[r("(?:\\<span class='gr_grammar_del'\\>([\\S\\s]*?)\\</span\\>)",function(e){return{type:"delete",text:e[2]}}),r("(?:\\<span class='gr_grammar_ins'\\>([\\S\\s]*?)\\</span\\>)",function(e){return{type:"insert",text:e[2]}}),r("()",function(e){return{type:"arrow"}}),r("([^<>]+)",function(e){return{type:"text",text:e[1]}})];t.parseTransformHtml=i,t.createReplacement=o,t.createSimpleReplacement=s},575:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(304),i=function(){function e(e,t,n,i,o,s,a,c){this.title=e,this.todo=t,this.replacements=n,this.isActive=i,this.isApplied=o,this.extraProperties=s,this.isVisibleQuickReplacement=a,this.onReplace=c,this.isDidYouMean=!!this.extraProperties.isDidYouMean,this.hasAddToDictionary=!!this.extraProperties.hasAddToDictionary,this.isEmptyReplacement=r.isNoReplacement(this.replacements),this.replacement=r.getReplacementModel({isDidYouMean:this.isDidYouMean,isActive:this.isActive,replacements:this.replacements,todo:this.todo,onReplace:this.onReplace}),this.isLongReplacement=this.replacement.template===r.CardReplacementTemplate.long,this.isReplacementUnderTitle=this.isLongReplacement||this.replacement.template===r.CardReplacementTemplate.didYouMean,this.isHighlightTextLabel=!this.isVisibleQuickReplacement,this.isShowTextTitle=this.isEmptyReplacement||this.extraProperties.isShowTitle||this.isReplacementUnderTitle||!this.isVisibleQuickReplacement}return e}();t.CommonHeaderModelImpl=i;var o=function(){function e(e,t,n,r){this.title=e,this.isActive=t,this.isApplied=n,this._url=r,this.plagiarism={url:this._url,urlTitle:this._url.map(function(e){return e.replace(/https?:\/\//,"")}),title:this.title}}return e}();t.PlagiarismHeaderModelImpl=o;var s=function(){function e(e,t,n,r){this.title=e,this.isActive=t,this.isApplied=n,this.isVisibleQuickReplacement=r,this.isHighlightTextLabel=!this.isVisibleQuickReplacement}return e}();t.EnhancementHeaderModelImpl=s},576:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(5),i=n(22),o=n(290);t.testTagAuth="diagnostic_test_auth",t.testTagIrbis="diagnostic_test_irbis",t.TIMEOUT=1e4,t.successResult=function(e,t){return{status:"success",result:e,time:t?Date.now()-t:void 0}},t.failedResult=function(e,t){return{status:"failed",result:e,time:t?Date.now()-t:void 0}},t.timeoutMessage="Failed by timeout",t.timeoutLimit=function(e){return r.delay(e).then(function(){throw new i.TimeoutError})},t.CLIENT_TYPE=o.ClientType.webTest,t.CLIENT_VERSION="1",t.CONTAINER_ID=Promise.resolve("ws_test")},577:function(e,t,n){"use strict";function r(e,t){if(!e||!e.parentElement)return!1;var n=e.className;return"string"==typeof n&&n.indexOf(t)>-1||r(e.parentElement,t)}function i(e,t,n){if(!e||!e.parentElement)return!1;var r=e.attributes.getNamedItem(t);return!(!r||r.value!==n)||i(e.parentElement,t,n)}function o(e,t){if(!t)return!1;for(;t.parentNode;){if(e===t.parentNode)return!0;t=t.parentNode}return!1}function s(e,t){return{top:e.top-t.top,bottom:e.bottom-t.bottom,left:e.left-t.left,right:e.right-t.right,width:e.width,height:e.height}}function a(e,t){return{top:e.top-t.top,bottom:e.bottom-t.top,left:e.left-t.left,right:e.right-t.left,width:e.width,height:e.height}}function c(e){if(!e)throw new Error("elem should not be null or undefined");var t=e.getBoundingClientRect();if(t.width||t.height){var n=e.ownerDocument,r=window,i=n.documentElement;return{top:t.top+r.pageYOffset-i.clientTop,left:t.left+r.pageXOffset-i.clientLeft,width:t.width,height:t.height}}return t}function u(e){return void 0!==e.dataset&&"true"===e.dataset.disabled}function l(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter(Boolean).join(" ")}Object.defineProperty(t,"__esModule",{value:!0}),t.hasParentWithClassName=r,t.hasParentWithAttribute=i,t.isParent=o,t.absToRelativeBuggy=s,t.absToRelative=a,t.getOffset=c;!function(e){function t(e,t){var n=t.x,r=t.y;return Math.trunc(e.top)<=Math.trunc(r)&&Math.trunc(e.bottom)>=Math.trunc(r)&&Math.trunc(e.left)<=Math.trunc(n)&&Math.trunc(e.right)>=Math.trunc(n)}e.empty={top:0,bottom:0,left:0,right:0,height:0,width:0},e.hasPoint=t}(t.Rect||(t.Rect={})),t.isDisabled=u,t.classes=l},578:function(e,t,n){"use strict";function r(e,t){return{dangerouslySetInnerHTML:{__html:u.sanitize(e,t)}}}function i(e){return function(t){t.stopPropagation(),e&&e(t)}}function o(e){return function(t){t.preventDefault(),e&&e(t)}}function s(e,t){return void 0===t&&(t="px"),{MsTransform:"translateY("+e+t+")",WebkitTransform:"translateY("+e+t+")",MozTransform:"translateY("+e+t+")",OTransform:"translateY("+e+t+")",transform:"translateY("+e+t+")"}}function a(e,t,n){return void 0===n&&(n="px"),{MsTransform:"translate("+e+n+", "+t+n+")",WebkitTransform:"translate("+e+n+", "+t+n+")",MozTransform:"translate("+e+n+", "+t+n+")",OTransform:"translate("+e+n+", "+t+n+")",transform:"translate("+e+n+", "+t+n+")"}}function c(e,t){return function(n){n.propertyName===e&&t(n)}}Object.defineProperty(t,"__esModule",{value:!0});var u=n(150);t.setInnerHTML=r,t.stopPropagation=i,t.preventDefault=o,t.translateY=s,t.translate=a,t.waitTransition=c},579:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(14),o=n(8),s=n(300),a=n(931);t.ProgressBar=function(e){var t=e.remaining,n=e.percentage,c=e.countdown,u=e.style,l=n>=100||null===t?"Coming momentarily...":s.formatTime(t,{short:"short"===c});return i.createElement("div",r.__assign({},o.classes(a.wrapper,u.wrapper||!1)),i.createElement("div",r.__assign({},o.classes(a.countdown,u.countdown||!1)),l),i.createElement("div",r.__assign({},o.classes(a.gutter,u.gutter||!1)),i.createElement("div",r.__assign({},o.classes(a.bar,u.bar||!1),{style:{width:n+"%"}}))))}},580:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.appConfig={env:"prod",logLevel:"INFO",crashLogLevel:"DEBUG",collectLogs:!0,collectCrashLogs:!0,copyLogsToConsole:!1,enableTracking:!0,alertCachePrefix:"editorTsAlertCache",alertCacheVersion:"2",userSettingsPrefix:"userSettings",userSettingsVersion:"1",defaultDialect:"american",notificationShowTimeMs:0,selfUpdate:{versionCheckInterval:72e5,latestVersionDelay:864e5,forceUpdateOnHiddenDelay:3e5,retryFailedVersionCheckInterval:3e5,retryFailedVersionCheckLimit:20,versionFilePath:"/version.json"},domains:{cookie:".grammarly.com",localServer:"denali-local.grammarly.com"},api:{authUrl:"https://auth.grammarly.com/v3",institutionUrl:"https://institution.grammarly.com",dapiUrl:"https://data.grammarly.com",doxUrl:"https://dox.grammarly.com",doxWsUrl:"wss://dox.grammarly.com",irbisUrl:"https://irbis.grammarly.com",subscriptionUrl:"https://subscription.grammarly.com/api/v1",capiWsUrl:"wss://capi.grammarly.com/freews",capiApiUrl:"https://capi.grammarly.com/api",gnarApi:{url:"https://gnar.grammarly.com"},pdfGeneratorUrl:"https://dox.grammarly.com/docproc/html2pdf",felogUrl:"https://f-log-editor.grammarly.io",sumoUrl:"https://endpoint2.collection.us2.sumologic.com/receiver/v1/http/ZaVnC4dhaV0Bxac28IqT2frgzsjX7HEotu8EZEZr07YE9RWLCzrOMGwzO9aL6c_iSiidkEplFOod2igKIxz_7s2CHlXc2u-XuLpetEBK1fV6xjfN2Sw2gA==",crashLogUrl:"https://f-log-editor.grammarly.io/crash",onlineTestUrl:"/online-test.json",wsTest:"wss://wstest.grammarly.com",diagnosticsUrl:"https://diagnostics.grammarly.com",proofitResultUrl:"https://dox.grammarly.com/documents/_docId_/proofread",redirect:"https://redirect.grammarly.com/redirect"},app:{name:"editor"},urls:{free:"/free"},funnel:{resetPassword:"https://www.grammarly.com/resetpassword",accountDeleted:"https://www.grammarly.com/account-deleted",subscribe:"https://www.grammarly.com/subscribe",upgrade:"https://www.grammarly.com/upgrade",signin:"https://www.grammarly.com/signin",socialSignin:"https://www.grammarly.com/share/signin",signup:"https://www.grammarly.com/signup",mainPage:"https://www.grammarly.com/",deleteSocialAccount:"https://www.grammarly.com/social/delete-account"},officeAddin:{installURL:"http://download-office.grammarly.com/latest/GrammarlyAddInSetup.exe",infoURL:"http://www.grammarly.com/office-addin/windows"},desktop:{windows:{installURL:"http://download-editor.grammarly.com/windows/GrammarlySetup.exe",infoURL:"https://www.grammarly.com/native/windows"},mac:{installURL:"http://download-editor.grammarly.com/osx/Grammarly.dmg",infoURL:"https://www.grammarly.com/native/mac"}},extension:{chrome:{installURL:"https://chrome.google.com/webstore/detail/kbfnbcaeplbcioakkpcpgfkobkghlhen",infoURL:"https://chrome.google.com/webstore/detail/grammarly-spell-checker-g/kbfnbcaeplbcioakkpcpgfkobkghlhen?hl=en"},firefox:{installURL:"https://addons.mozilla.org/firefox/downloads/latest/566314/addon-566314-latest.xpi",iconURL:"https://addons.cdn.mozilla.net/user-media/addon_icons/566/566314-32.png",infoURL:"https://addons.mozilla.org/en-US/firefox/addon/grammarly-1/"},safari:{installURL:"https://safari-extensions.apple.com/details/?id=com.grammarly.spellchecker.extension-W8F64X92K3"},edge:{installURL:"ms-windows-store://pdp?ProductId=9p59wxtbhzzm",infoURL:"https://www.microsoft.com/en-us/store/p/grammarly-for-microsoft-edge/9p59wxtbhzzm?rtc=1"}},edu:{adminPanelURL:"https://admin-panel.grammarly.com"},support:{login:"https://support.grammarly.com/login",email:"support@grammarly.com",mainPage:"https://support.grammarly.com/",newRequest:"https://support.grammarly.com/hc/en-us/requests/new",contact:"https://www.grammarly.com/contact",connectionTroubleshooting:"https://support.grammarly.com/hc/en-us/articles/115000090271-Network-configuration-blocks-Grammarly-services",emailExistsKBUrl:"https://support.grammarly.com/hc/en-us/articles/115000090791-Changing-your-email-to-an-email-that-already-exists",safariDownloadFilesKBUrl:"https://support.grammarly.com/hc/en-us/articles/360001105952",phoenixSupportUrl:"https://ecampus.phoenix.edu/common/contactus/reportProblem.jsp",phoenixWritingHelpUrl:"https://portal.phoenix.edu/social/community/support/writing",diagnosticTestPath:"/diagnostic-test?origin=editor",documentAcceptTrackedChanges:"https://support.office.com/en-us/article/Accept-tracked-changes-4838d24c-d5d1-4c6c-8e39-78b44bd2b4cc"},privacyPolicy:"https://www.grammarly.com/privacy-policy",termsOfServise:"https://www.grammarly.com/terms",gaTrackingId:"UA-6331378-16"},t.buildInfo={version:"1.0.0-dev"}},581:function(e,t,n){"use strict";function r(e){switch(e){case i.officeAddin:return"officeAddin";case i.desktopMac:return"macApp";case i.desktopWindows:return"winApp";case i.extensionChrome:return"chromeExt";case i.extensionFirefox:return"firefoxExt";case i.extensionSafari:return"safariExt";case i.extensionEdge:return"edgeExt";default:return o.assertNever(e)}}Object.defineProperty(t,"__esModule",{value:!0});var i,o=n(5),s=n(199),a=n(121);!function(e){e[e.officeAddin=0]="officeAddin",e[e.desktopMac=1]="desktopMac",e[e.desktopWindows=2]="desktopWindows",e[e.extensionChrome=3]="extensionChrome",e[e.extensionFirefox=4]="extensionFirefox",e[e.extensionSafari=5]="extensionSafari",e[e.extensionEdge=6]="extensionEdge"}(i=t.Apps||(t.Apps={})),t.isExtension=function(e){return[i.extensionChrome,i.extensionFirefox,i.extensionSafari,i.extensionEdge].some(function(t){return t===e})};var c=function(e,t,n,r){var c=[];if(!e.size)return c;var u;if(s.isBrowserHasExtension(n))switch(n){case"chrome":u=i.extensionChrome;break;case"firefox":u=i.extensionFirefox;break;case"safari":u=i.extensionSafari;break;case"edge":u=i.extensionEdge}else u=void 0;if(u&&c.push({app:u,installed:s.isExtensionInstalled()}),r&&("windows"===t&&c.push({app:i.officeAddin,installed:o.Extension.isAddinInstalled(e)}),"windows"===t||"mac"===t)){var l="windows"===t?i.desktopWindows:i.desktopMac;c.push({app:l,installed:e.has(a.UserGroups.DESKTOP_EDITOR_INSTALLED)})}return c},u=function(){function e(e,t,n,r,i){this._browser=e,this._os=t,this._extension=n,this._showDesktopApps=r,this._telemetry=i}return e.prototype.getAppsItems=function(e){return c(e,this._os,this._browser,this._showDesktopApps.get().enabled)},e.prototype.onInstallClicked=function(e){t.isExtension(e)&&this._extension.install(),this._telemetry.installAppClicked(r(e))},e.prototype.onMoreClicked=function(e){this._telemetry.learnMoreClicked(r(e))},e}();t.AppsModelImpl=u},582:function(e,t,n){"use strict";function r(e){return Object.keys(e).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])}).join("&")}function i(e){void 0===e&&(e=[]);var t=e.reduce(function(e,t){var n=t.group,r=t.category,i=t.categoryHuman;return e[r]?e[r].count+=1:e[r]={group:n,category:r,categoryHuman:i,count:1},e},{});return Object.keys(t).map(function(e){return t[e]})}function o(e){return c.isDesktopEditor(c.getBrowserInfo().browser)?"Desktop"+u.camelize(e):e}function s(e,t,n,s){var c=t?{page:"free",utm_medium:l,utm_source:d,utm_campaign:o(t)}:{page:"free"},u=i(n),h=u.length?{alerts:a.compressToEncodedURIComponent(JSON.stringify(u))}:{},p={app_type:"app"};return s&&(p.doc_id=s),e+"?"+r(Object.assign({},h,p,c))}Object.defineProperty(t,"__esModule",{value:!0});var a=n(584),c=n(38),u=n(150),l="internal",d="upHook";t.getUpgradeUrl=s},585:function(e,t,n){"use strict";function r(e,t){return t?Math.max(e,t+u):e}function i(e){return Object.keys(e).map(function(t){return e[t]}).sort(function(e,t){return e.alert.highlightPosition.top-t.alert.highlightPosition.top||e.alert.highlightPosition.left-t.alert.highlightPosition.left||e.alert.highlightPosition.bottom-t.alert.highlightPosition.bottom||e.alert.highlightPosition.right-t.alert.highlightPosition.right||(e.alert.alert.id<t.alert.alert.id?-1:1)}).reduce(function(t,n,i,o){var s=o[i-1]&&o[i-1].alert.alert.id,a=i>0?t[s].top:0,c=i>0?e[s].cardHeight:0;return t[n.alert.alert.id]={top:r(n.alert.highlightPosition.top,a+c),height:n.cardHeight,alert:n.alert},t},{})}function o(e,t){var n={top:e.top+1,height:e.height,left:e.left-60,width:e.width};return{left:{top:t.top,left:t.left,width:t.width,height:t.height-4},right:n}}function s(e,t){return e-t+h}function a(e,t,n,r){var i=e+t+l-(n+r),o=e-d-r;return i<=0&&o>=0?0+r:o<0?o+r:(i>o?o:i)+r}function c(e,n,r,i,o){if(!n.id)return t.emptyLayout;var c=e[n.id];if(!c)return t.emptyLayout;var u="click"===n.source,l=u?a(c.top+r,c.height,i,o):void 0,d=s(c.top,c.alert.highlightPosition.top),h=u?[d,0]:[0,-d];return{scroll:l,textShift:h[0],cardsShift:h[1]}}Object.defineProperty(t,"__esModule",{value:!0});var u=8;t.getCardsPositions=i,t.calculateGuideLayout=o;var l=35,d=20,h=18;t.emptyLayout={scroll:0,textShift:0,cardsShift:0},t.getScrollToFitCard=a,t.calculateEditorLayout=c},586:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1389);t.EditorPageModel=r.EditorPageModel,t.EditorPageModelImpl=r.EditorPageModelImpl,t.editorPageDefaultState=r.defaultState;var i=n(308);t.EditorEngine=i.EditorEngine,t.EditorEngineCheckResults=i.EditorEngineCheckResults,t.EditorEngineCheckingSettings=i.EditorEngineCheckingSettings,t.CheckingStatus=i.CheckingStatus,t.AppliedAlertAction=i.AppliedAlertAction;var o=n(558);t.GrammarlyEditorEngine=o.GrammarlyEditorEngine;var s=n(557);t.EditorSession=s.EditorSession,t.EditorSessionImpl=s.EditorSessionImpl,t.EditorSessionState=s.EditorSessionState,t.editorSessionDefaultState=s.defaultState;var a=n(554);t.CheckingScores=a.CheckingScores;var c=n(297);t.GuideLayout=c.GuideLayout;var u=n(205);t.CheckingSettingsModel=u.CheckingSettingsModel,t.CheckingSettingsState=u.CheckingSettingsState,t.ChecksType=u.ChecksType,t.GenreId=u.GenreId;var l=n(297);t.CardsModel=l.CardsModel;var d=n(555);t.DocumentModel=d.DocumentModel,t.DocumentModelState=d.DocumentModelState;var h=n(556);t.DocumentContent=h.DocumentContent,t.DocumentSession=h.DocumentSession,t.DocumentSessionState=h.DocumentSessionState,t.DocumentSessionImpl=h.DocumentSessionImpl,t.ProofitState=h.ProofitState;var p=n(298);t.TextStatsModel=p.TextStatsModel,t.TextStatsModelState=p.TextStatsModelState,t.TextStatsModelImpl=p.TextStatsModelImpl,t.textStatsModelDefaultState=p.defaultState,t.TextStatsView=p.TextStatsView;var f=n(98);t.Alert=f.Alert,t.AlertExamples=f.AlertExamples,t.AlertGroup=f.AlertGroup,t.AlertId=f.AlertId,t.AlertReplacement=f.AlertReplacement,t.AlertRange=f.AlertRange,t.AlertTransform=f.AlertTransform,t.AlertTransformPart=f.AlertTransformPart,t.AlertPlagiarism=f.AlertPlagiarism;var g=n(1387);t.AlertCache=g.AlertCache,t.AlertCacheImpl=g.AlertCacheImpl},587:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(198);!function(e){function t(){r.invariant(!n(),"FullStory snippet already loaded");var e=document.createElement("script");e.innerHTML=i,document.head.appendChild(e)}function n(){return void 0!==window.FS}var i="window['_fs_debug'] = true;\n  window['_fs_host'] = 'fullstory.com';\n  window['_fs_org'] = '76Y20';\n  window['_fs_namespace'] = 'FS';\n  (function(m,n,e,t,l,o,g,y){\n    if (e in m) {if(m.console && m.console.log) { m.console.log('FullStory namespace conflict. Please set window[\"_fs_namespace\"].');} return;}\n    g=m[e]=function(a,b){g.q?g.q.push([a,b]):g._api(a,b);};g.q=[];\n    o=n.createElement(t);o.async=1;o.src='https://'+_fs_host+'/s/fs.js';\n    y=n.getElementsByTagName(t)[0];y.parentNode.insertBefore(o,y);\n    g.identify=function(i,v){g(l,{uid:i});if(v)g(l,v)};g.setUserVars=function(v){g(l,v)};\n    g.identifyAccount=function(i,v){o='account';v=v||{};v.acctId=i;g(o,v)};\n    g.clearUserCookie=function(c,d,i){if(!c || document.cookie.match('fs_uid=[\";\"]*\"[\";\"]*\"[\";\"]*\"')){\n      d=n.domain;while(1){n.cookie='fs_uid=;domain='+d+\n      ';path=/;expires='+new Date(0).toUTCString();i=d.indexOf('.');if(i<0)break;d=d.slice(i+1)}}};\n    })(window,document,window['_fs_namespace'],'script','user');";e.enable=t,e.isEnabled=n,e.ignoreClass="fs-hide"}(t.Fullstory||(t.Fullstory={}))},60:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(645),o=n(43),s="application/json",a="application/x-www-form-urlencoded";t.HTTPMethods=["get","post","put","options","head","trace","delete","connect"];var c=function(){function e(){}return e.factory=function(t,n,r,i){return void 0===n&&(n="include"),void 0===r&&(r=e.mapToHTTPError),void 0===i&&(i={}),function(o,s,a){var c=o.url,u=o.body,l=o.method,d=o.headers;void 0===s&&(s=e.parseJSON),void 0===a&&(a=r);var h={body:u,method:l,headers:Object.assign({},i,d),mode:"cors",credentials:n};return t(c,h).then(e._checkStatus(a)).then(s)}},e._checkStatus=function(e){var t=this;return function(n){return r.__awaiter(t,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return n.ok?[2,n]:[3,1];case 1:return[4,e(n)];case 2:return[2,t.sent()]}})})}},e.mapToHTTPError=function(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return[4,e.text()];case 1:throw t=n.sent(),new u({code:e.status,status:e.statusText,url:e.url,body:t})}})})},e.assertMimeType=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){var n=t.headers.get("Content-Type")||t.headers.get("content-type");if(!n)throw new Error("get empty Content-Type, but expected: "+e);if(e.every(function(e){return-1===n.indexOf(e)}))throw new o.AssertionError(e.join(),n,"Unexpected Content-Type")}},e.parseJSON=function(t){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(n){return e.assertMimeType("application/json")(t),[2,t.json()]})})},e.parseBlobResponse=function(t){return r.__awaiter(this,void 0,void 0,function(){var n;return r.__generator(this,function(r){switch(r.label){case 0:return e.assertMimeType("text/plain","application/octet-stream","application/vnd","application/pdf")(t),n={title:i.parse(t.headers.get("Content-Disposition")||"downloadedDocument").parameters.filename},[4,t.blob()];case 1:return[2,(n.data=r.sent(),n)]}})})},e.parseText=function(e){return e.text()},e.toVoid=function(){},e}();t.Ajax=c;var u=function(e){function t(t){var n=t.code,r=t.status,i=t.url,o=t.message,s=t.body,a=e.call(this,o||r||s||"HTTPError")||this;return a.name="HTTPError",a.url=i,a.code=n,a.body=s,a.status=r,a}return r.__extends(t,e),t}(o.CustomError);t.HTTPError=u;var l=function(){function e(e,t,n,r,i){this._url=e,this._method=t,this._headers=n,this._mime=r,this._body=i}return e.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return d.get.apply(d,e).build()},e.post=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return d.post.apply(d,e).build()},e.put=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return d.put.apply(d,e).build()},e.del=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return d.del.apply(d,e).build()},e.head=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return d.head.apply(d,e).build()},Object.defineProperty(e.prototype,"url",{get:function(){return this._url},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"method",{get:function(){return this._method},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headers",{get:function(){return this._headers},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mime",{get:function(){return this._mime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"body",{get:function(){return this._body},enumerable:!0,configurable:!0}),e}();t.Request=l;var d=function(){function e(e,t,n,r,i,o,s,a){void 0===e&&(e=""),void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i={}),this._url=e,this._queryParams=t,this._formParams=n,this._cookies=r,this._headers=i,this._method=o,this._mime=s,this._body=a}return e.join=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=[].slice.call(t.filter(function(e){return e.length>0}),0).join("/");return e._normalize(r)},e._normalize=function(e){return e=e.replace(/:\//g,"://"),e=e.replace(/([^:\s])\/+/g,"$1/"),e=e.replace(/\/(\?|#)/g,"$1")},e.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.url.apply(e,t).method("get")},e.post=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.url.apply(e,t).method("post")},e.put=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.url.apply(e,t).method("put")},e.del=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.url.apply(e,t).method("delete")},e.head=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.url.apply(e,t).method("head")},e.url=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new e(e.join.apply(e,t))},e.prototype.url=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(""!==this._url)throw new Error("URL already set to "+this._url+", use join(string) to add additional parts to it");return this.join(e.join.apply(e,t))},e.create=function(){return new e},e.prototype.method=function(e){if(-1===t.HTTPMethods.indexOf(e.toLowerCase()))throw new Error("unknown method was passed as an argument: "+e);if(this._method&&this._method!==e)throw new Error("Method already set to "+this._method+", but was overwritten by "+e);return this._method=e,this},e.prototype.join=function(t){return this._url=e.join(this._url,t),this},e.prototype.pathParam=function(t){return this._url=e.join(this._url,encodeURIComponent(t)),this},e.prototype.body=function(e){if(this._body)throw new Error("Body already set to "+this._body+", but was overwritten by "+e);return this._body=e,this},e.prototype.isBodyPresent=function(){return this._body},e.prototype.formParam=function(e,t){return this._formParams.push(this._encodeParam(e,t)),this},e.prototype.header=function(e,t){return this._headers[e]=t,this},e.prototype.queryParam=function(e,t){return this._queryParams.push(this._encodeParam(e,t)),this},e.prototype.cookie=function(e,t){return this._cookies.push(e+"="+t),this},e.prototype.mime=function(e){if(this._mime&&this._mime!==e)throw new Error("MIME already set to "+this._mime+", but was overwritten by "+e);return this._mime=e,this},e.prototype.json=function(e){return e?this.body(e).mime(s):this.mime(s)},e.prototype.build=function(){if(!this._url||0===this._url.length)throw new Error("URL cannot be empty");if(this._url=this._url.replace(/\/$/,""),this._queryParams.length>0&&(this._url+="?"+this._queryParams.join("&")),this._body&&this._formParams.length>0)throw new Error("User formParam() OR body() methods to specify request content, not both");if(this._formParams.length>0){if(this._mime&&this._mime!==a)throw new Error("Only application/x-www-form-urlencoded can be used for form requests, don't specify it mandatory in mime() method");this._mime=a,this._body=this._formParams.join("&")}if(this._mime===s&&this._body&&(this._body=JSON.stringify(this._body)),!this._method)throw new Error("HTTP method was not set");if(this._method=this._method.toLocaleLowerCase(),("get"===this._method||"delete"===this._method)&&this._body)throw new Error("Body is not supported for GET, DELETE requests");if(this._mime&&(this._headers["Content-Type"]=this._mime),this._cookies.length>0){this._headers.Cookie=this._cookies.join("; ")}return new l(this._url,this._method,this._headers,this._mime||null,this._body)},e.prototype._encodeParam=function(e,t){return encodeURIComponent(e)+"="+encodeURIComponent(t)},e}();t.RequestBuilder=d},80:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1357);t.AppConfig=r.AppConfig,t.BuildInfo=r.BuildInfo,t.DialectString=r.DialectString;var i=window.Grammarly,o=i&&i.denali,s=o&&o.appConfig||n(580).appConfig,a=o&&o.buildInfo;t.appConfig=s||{},t.buildInfo=a||{}},855:function(e,t){e.exports={spinner:"_052b8d00-spinner-spinner",item:"_6f2b1cc8-spinner-item",spinner_bouncedelay:"_7de85e44-spinner-spinner_bouncedelay"}},856:function(e,t){},857:function(e,t){},858:function(e,t){},859:function(e,t){},860:function(e,t){},861:function(e,t){},875:function(e,t,n){e.exports=n.p+"files/997ea3a3690bda688b2a6d7407bb5eb9/logo.svg"},876:function(e,t,n){e.exports=n.p+"files/791af15b554bcd8bf942ef130faffe1f/robot@2x.gif"},931:function(e,t,n){n(857),e.exports=n(1424)},932:function(e,t,n){n(858),e.exports=n(1425)},933:function(e,t,n){n(859),e.exports=n(1426)},934:function(e,t,n){n(860),e.exports=n(1427)},935:function(e,t,n){n(861),e.exports=n(1428)},97:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(60),o=n(292),s=n(148);!function(e){function t(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,s;return r.__generator(this,function(r){switch(r.label){case 0:t={},n="",r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.text()];case 2:return n=r.sent(),t=JSON.parse(n),[3,4];case 3:return s=r.sent(),t={info:"unknown"},[3,4];case 4:switch(t.info){case"too_big":throw new c(o.MAX_FILE_SIZE,t.status,t.info,e.url);case"document not found":throw new u(t.status,t.info,e.url);case"user not found":throw new l(t.status,t.info,e.url);case"tracked":throw new h(t.status,t.info,e.url);case"too many requests":throw new p(t.status,t.info,e.url);default:throw new i.HTTPError({code:e.status,status:e.statusText,url:e.url,body:n})}return[2]}})})}var n;!function(e){e[e.NORMAL_CLOSURE=1e3]="NORMAL_CLOSURE",e[e.GOING_AWAY=1001]="GOING_AWAY",e[e.TOO_BIG=1009]="TOO_BIG",e[e.VIOLATED_POLICY=1008]="VIOLATED_POLICY",e[e.UNEXPECTED_CONDITION=1011]="UNEXPECTED_CONDITION",e[e.SERVICE_RESTART=1012]="SERVICE_RESTART",e[e.CLIENT_MALFUNCTION=3e3]="CLIENT_MALFUNCTION",e[e.BLOCKED_BY_CLIENT=4e3]="BLOCKED_BY_CLIENT",e[e.UNAUTHORIZED=4001]="UNAUTHORIZED",e[e.NOT_FOUND=4004]="NOT_FOUND",e[e.SUBMITTED_FOR_PROOFREADING=4012]="SUBMITTED_FOR_PROOFREADING",e[e.TOO_MANY_REQUESTS=4029]="TOO_MANY_REQUESTS",e[e.UNKNOWN_WS_ERROR=-1]="UNKNOWN_WS_ERROR"}(n=e.WsCodes||(e.WsCodes={}));var a;!function(e){e[e.NOT_FOUND=404]="NOT_FOUND",e[e.UNAUTHORIZED=401]="UNAUTHORIZED",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.TOO_MANY_REQUESTS=429]="TOO_MANY_REQUESTS"}(a=e.HttpCodes||(e.HttpCodes={})),e.CLOSED_ERROR=new s.WSError({status:"closed",message:"client was closed from client side"});var c=function(e){function t(t,n,r,i){void 0===n&&(n="too_big"),void 0===r&&(r="Document is too big");var o=e.call(this,{code:a.BAD_REQUEST,message:r,url:i,status:n})||this;return o.maxSizeLimit=t,o.name="FileSizeOutOfRangeError",o}return r.__extends(t,e),t}(i.HTTPError);e.FileSizeOutOfRangeError=c;var u=function(e){function t(t,n,r){void 0===t&&(t="not_found"),void 0===n&&(n="Document doesn't exist");var i=e.call(this,{code:a.NOT_FOUND,message:n,url:r,status:t})||this;return i.name="DocumentNotFoundError",i}return r.__extends(t,e),t}(i.HTTPError);e.DocumentNotFoundError=u;var l=function(e){function t(t,n,r){void 0===t&&(t="error"),void 0===n&&(n="user not found");var i=e.call(this,{code:a.UNAUTHORIZED,message:n,url:r,status:t})||this;return i.name="UnauthorizedError",i}return r.__extends(t,e),t}(i.HTTPError);e.UnauthorizedError=l;var d=function(e){function t(t,n,r,i){void 0===n&&(n="bad_type"),void 0===r&&(r="Unsupported file type");var o=e.call(this,{code:a.BAD_REQUEST,message:r,url:i,status:n})||this;return o.originalFileName=t,o.name="UnsupportedFileTypeError",o}return r.__extends(t,e),t}(i.HTTPError);e.UnsupportedFileTypeError=d;var h=function(e){function t(t,n,r){void 0===t&&(t="error"),void 0===n&&(n="Document with tracked changes is not supported");var i=e.call(this,{code:a.BAD_REQUEST,message:n,url:r,status:t})||this;return i.name="TrackedChangesIsUnsupported",i}return r.__extends(t,e),t}(i.HTTPError);e.TrackedChangesIsUnsupported=h;var p=function(e){function t(t,n,r){void 0===t&&(t="error"),void 0===n&&(n="Too many requests");var i=e.call(this,{code:a.TOO_MANY_REQUESTS,message:n,url:r,status:t})||this;return i.name="TooManyRequestsError",i}return r.__extends(t,e),t}(i.HTTPError);e.TooManyRequestsError=p;var f=function(e){function t(t,n,r,i){void 0===n&&(n=0),void 0===r&&(r="connect_error"),void 0===i&&(i="Cannot connect");var o=e.call(this,{code:n,message:i,url:t,status:r})||this;return o.name="ConnectionError",o}return r.__extends(t,e),t}(i.HTTPError);e.ConnectionError=f;var g=function(e){function t(t,n,r,i){void 0===n&&(n="disconnected"),void 0===r&&(r="Cannot connect to DOX");var o=e.call(this,{status:n,message:r,code:t,url:i})||this;return o.name="WSDisconnectedOnInitError",o}return r.__extends(t,e),t}(s.WSError);e.WSDisconnectedOnInitError=g;var m=function(e){function t(t,r,i){void 0===t&&(t="too_big"),void 0===r&&(r="Message is too big, server rejected it");var o=e.call(this,{status:t,message:r,code:n.TOO_BIG,url:i})||this;return o.name="WSMessageIsTooBigError",o}return r.__extends(t,e),t}(s.WSError);e.WSMessageIsTooBigError=m;var _=function(e){function t(t,n,r,i,o){void 0===i&&(i="Disconnected after multiple retries");var s=e.call(this,{status:r,message:i,code:n,url:o})||this;return s.retriesMade=t,s}return r.__extends(t,e),t}(s.WSError);e.WSDisconnectedAfterMultipleRetries=_;var y=function(e){function t(t){return e.call(this,{code:n.GOING_AWAY,status:"closed",message:"timeout",url:t})||this}return r.__extends(t,e),t}(s.WSError);e.WSGoingAway=y;var v=function(e){function t(t,n){var r=e.call(this,{status:"closed",message:n,code:t})||this;return r.name="WSNotRetryableError",r}return r.__extends(t,e),t}(s.WSError);e.WSNotRetryableError=v,e.doxErrorMapper=t}(t.DoxErrors||(t.DoxErrors={}))},98:function(e,t,n){"use strict";function r(e){var t=c[e];if(void 0===t)throw new TypeError("Unknown alert group "+e);return t}Object.defineProperty(t,"__esModule",{value:!0});var i=n(574);t.AlertReplacement=i.AlertReplacement,t.AlertTransform=i.AlertTransform,t.AlertTransformPart=i.AlertTransformPart,t.createReplacement=i.createReplacement,t.createSimpleReplacement=i.createSimpleReplacement;var o=n(307);t.AlertExamples=o.AlertExamples,t.parseExamples=o.parseExamples;var s=n(1388);t.AlertPlagiarism=s.AlertPlagiarism,t.AlertPlagiarismReferenceWeb=s.AlertPlagiarismReferenceWeb,t.AlertPlagiarismReferencePublication=s.AlertPlagiarismReferencePublication,t.parsePlagiarism=s.parsePlagiarism;var a;!function(e){e.contextualSpelling="ContextualSpelling",e.grammar="Grammar",e.sentenceStructure="SentenceStructure",e.punctuation="Punctuation",e.style="Style",e.enhancement="Enhancement",e.plagiarism="Plagiarism",e.synonym="Synonyms"}(a=t.AlertGroup||(t.AlertGroup={}));var c={Spelling:a.contextualSpelling,ContextualSpelling:a.contextualSpelling,Grammar:a.grammar,SentenceStructure:a.sentenceStructure,Punctuation:a.punctuation,Style:a.style,Enhancement:a.enhancement,Plagiarism:a.plagiarism};t.alertGroupFromString=r},99:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(196);t.RxFetch=i.RxFetch,t.FetchType=i.FetchType;var o=n(1352);t.Lifecycle=o.Lifecycle,t.Subscription=o.Subscription;var s=n(1353);t.TextResources=s.TextResources,t.getTextResources=s.getTextResources,r.__exportStar(n(1351),t)}},[1431]);